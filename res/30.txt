Cloning into 'Cifar-Prototypical'...
remote: Enumerating objects: 322, done.
remote: Counting objects: 100% (322/322), done.
remote: Compressing objects: 100% (217/217), done.
remote: Total 659 (delta 239), reused 187 (delta 105), pack-reused 337
Receiving objects: 100% (659/659), 232.34 KiB | 437.00 KiB/s, done.
Resolving deltas: 100% (478/478), done.
dataset size i: 0 , len: 2902
dataset size i: 1 , len: 2833
dataset size i: 2 , len: 2821
dataset size i: 3 , len: 2832
dataset size i: 4 , len: 2906
Incremental num : 0
=== Epoch: 0 ===
  0% 0/12 [00:00<?, ?it/s]/pytorch/aten/src/ATen/native/TensorFactories.cpp:361: UserWarning: Deprecation warning: In a future PyTorch release torch.full will no longer return tensors of floating dtype by default. Instead, a bool fill_value will return a tensor of torch.bool dtype, and an integral fill_value will return a tensor of torch.long dtype. Set the optional `dtype` or `out` arguments to suppress this warning.
100% 12/12 [00:01<00:00, 10.93it/s]
Avg Train Loss: 2.710019886493683, Avg Train Acc: 0.2571614583333333
100% 2/2 [00:00<00:00, 31.05it/s]
Avg Val Loss: 2.0371816158294678, Avg Val Acc: 0.4938616156578064 (Best)
=== Epoch: 1 ===
100% 12/12 [00:01<00:00, 11.24it/s]
Avg Train Loss: 2.5216373006502786, Avg Train Acc: 0.2932942708333333
100% 2/2 [00:00<00:00, 27.49it/s]
Avg Val Loss: 1.7521138191223145, Avg Val Acc: 0.5361049175262451 (Best)
=== Epoch: 2 ===
100% 12/12 [00:01<00:00, 11.09it/s]
Avg Train Loss: 2.464814007282257, Avg Train Acc: 0.298828125
100% 2/2 [00:00<00:00, 30.16it/s]
Avg Val Loss: 1.7351021766662598, Avg Val Acc: 0.5367187559604645 (Best)
=== Epoch: 3 ===
100% 12/12 [00:01<00:00, 11.14it/s]
Avg Train Loss: 2.4078885912895203, Avg Train Acc: 0.3216145833333333
100% 2/2 [00:00<00:00, 29.85it/s]
Avg Val Loss: 1.6289966404438019, Avg Val Acc: 0.5542968809604645 (Best)
=== Epoch: 4 ===
100% 12/12 [00:01<00:00, 11.56it/s]
Avg Train Loss: 2.3187560439109802, Avg Train Acc: 0.3580729166666667
100% 2/2 [00:00<00:00, 30.19it/s]
Avg Val Loss: 1.5472275614738464, Avg Val Acc: 0.5738281309604645 (Best)
=== Epoch: 5 ===
100% 12/12 [00:01<00:00, 11.38it/s]
Avg Train Loss: 2.26232381661733, Avg Train Acc: 0.3541666666666667
100% 2/2 [00:00<00:00, 30.40it/s]
Avg Val Loss: 1.5075277388095856, Avg Val Acc: 0.5757812559604645 (Best)
=== Epoch: 6 ===
100% 12/12 [00:01<00:00, 11.52it/s]
Avg Train Loss: 2.2141871651013694, Avg Train Acc: 0.3779296875
100% 2/2 [00:00<00:00, 31.51it/s]
Avg Val Loss: 1.4637677073478699, Avg Val Acc: 0.5751674175262451 (Best: 0.5757812559604645)
=== Epoch: 7 ===
100% 12/12 [00:01<00:00, 11.59it/s]
Avg Train Loss: 2.1768699089686074, Avg Train Acc: 0.392578125
100% 2/2 [00:00<00:00, 31.73it/s]
Avg Val Loss: 1.3508007526397705, Avg Val Acc: 0.6115513443946838 (Best)
=== Epoch: 8 ===
100% 12/12 [00:01<00:00, 11.35it/s]
Avg Train Loss: 2.16800664861997, Avg Train Acc: 0.3942057291666667
100% 2/2 [00:00<00:00, 31.48it/s]
Avg Val Loss: 1.3218585550785065, Avg Val Acc: 0.6043526828289032 (Best: 0.6115513443946838)
=== Epoch: 9 ===
100% 12/12 [00:01<00:00, 11.52it/s]
Avg Train Loss: 2.1220085819562278, Avg Train Acc: 0.4059244791666667
100% 2/2 [00:00<00:00, 31.89it/s]
Avg Val Loss: 1.2831491827964783, Avg Val Acc: 0.6381696462631226 (Best)
=== Epoch: 10 ===
100% 12/12 [00:01<00:00, 11.50it/s]
Avg Train Loss: 1.9885076383749645, Avg Train Acc: 0.4371744791666667
100% 2/2 [00:00<00:00, 31.55it/s]
Avg Val Loss: 1.2572056502103806, Avg Val Acc: 0.6187500059604645 (Best: 0.6381696462631226)
=== Epoch: 11 ===
100% 12/12 [00:01<00:00, 11.54it/s]
Avg Train Loss: 1.9595449765523274, Avg Train Acc: 0.4430338541666667
100% 2/2 [00:00<00:00, 28.01it/s]
Avg Val Loss: 1.1322907954454422, Avg Val Acc: 0.6973772346973419 (Best)
=== Epoch: 12 ===
100% 12/12 [00:01<00:00, 11.44it/s]
Avg Train Loss: 1.908186286687851, Avg Train Acc: 0.455078125
100% 2/2 [00:00<00:00, 30.36it/s]
Avg Val Loss: 1.125647097826004, Avg Val Acc: 0.6830915212631226 (Best: 0.6973772346973419)
=== Epoch: 13 ===
100% 12/12 [00:01<00:00, 11.62it/s]
Avg Train Loss: 1.9409333765506744, Avg Train Acc: 0.4417317708333333
100% 2/2 [00:00<00:00, 30.54it/s]
Avg Val Loss: 1.070356696844101, Avg Val Acc: 0.7032366096973419 (Best)
=== Epoch: 14 ===
100% 12/12 [00:01<00:00, 11.58it/s]
Avg Train Loss: 1.8949287136395772, Avg Train Acc: 0.4710286458333333
100% 2/2 [00:00<00:00, 29.75it/s]
Avg Val Loss: 1.0560618937015533, Avg Val Acc: 0.6876116096973419 (Best: 0.7032366096973419)
=== Epoch: 15 ===
100% 12/12 [00:01<00:00, 11.20it/s]
Avg Train Loss: 1.842206597328186, Avg Train Acc: 0.462890625
100% 2/2 [00:00<00:00, 28.11it/s]
Avg Val Loss: 0.9887861460447311, Avg Val Acc: 0.7247209846973419 (Best)
=== Epoch: 16 ===
100% 12/12 [00:01<00:00, 11.65it/s]
Avg Train Loss: 1.7657716075579326, Avg Train Acc: 0.494140625
100% 2/2 [00:00<00:00, 31.85it/s]
Avg Val Loss: 0.9409579932689667, Avg Val Acc: 0.7065290212631226 (Best: 0.7247209846973419)
=== Epoch: 17 ===
100% 12/12 [00:01<00:00, 11.60it/s]
Avg Train Loss: 1.7343220114707947, Avg Train Acc: 0.5074869791666666
100% 2/2 [00:00<00:00, 31.63it/s]
Avg Val Loss: 0.9880162328481674, Avg Val Acc: 0.7260602712631226 (Best)
=== Epoch: 18 ===
100% 12/12 [00:01<00:00, 11.42it/s]
Avg Train Loss: 1.6728863815466564, Avg Train Acc: 0.5198567708333334
100% 2/2 [00:00<00:00, 31.47it/s]
Avg Val Loss: 0.9267681390047073, Avg Val Acc: 0.7026227712631226 (Best: 0.7260602712631226)
=== Epoch: 19 ===
100% 12/12 [00:01<00:00, 11.35it/s]
Avg Train Loss: 1.6791360974311829, Avg Train Acc: 0.5188802083333334
100% 2/2 [00:00<00:00, 31.55it/s]
Avg Val Loss: 0.8812875002622604, Avg Val Acc: 0.7663504481315613 (Best)
=== Epoch: 20 ===
100% 12/12 [00:01<00:00, 11.38it/s]
Avg Train Loss: 1.623989035685857, Avg Train Acc: 0.5393880208333334
100% 2/2 [00:00<00:00, 29.31it/s]
Avg Val Loss: 0.7688804566860199, Avg Val Acc: 0.7540178596973419 (Best: 0.7663504481315613)
=== Epoch: 21 ===
100% 12/12 [00:01<00:00, 11.64it/s]
Avg Train Loss: 1.5450039406617482, Avg Train Acc: 0.5543619791666666
100% 2/2 [00:00<00:00, 31.67it/s]
Avg Val Loss: 0.7711050808429718, Avg Val Acc: 0.8060267865657806 (Best)
=== Epoch: 22 ===
100% 12/12 [00:01<00:00, 11.53it/s]
Avg Train Loss: 1.544113536675771, Avg Train Acc: 0.544921875
100% 2/2 [00:00<00:00, 29.90it/s]
Avg Val Loss: 0.6979001238942146, Avg Val Acc: 0.7819754481315613 (Best: 0.8060267865657806)
=== Epoch: 23 ===
100% 12/12 [00:01<00:00, 11.50it/s]
Avg Train Loss: 1.5160583555698395, Avg Train Acc: 0.5647786458333334
100% 2/2 [00:00<00:00, 30.60it/s]
Avg Val Loss: 0.6849435120820999, Avg Val Acc: 0.7982142865657806 (Best: 0.8060267865657806)
=== Epoch: 24 ===
100% 12/12 [00:01<00:00, 11.63it/s]
Avg Train Loss: 1.458896627028783, Avg Train Acc: 0.578125
100% 2/2 [00:00<00:00, 31.72it/s]
Avg Val Loss: 0.694159485399723, Avg Val Acc: 0.7962611615657806 (Best: 0.8060267865657806)
=== Epoch: 25 ===
100% 12/12 [00:01<00:00, 11.70it/s]
Avg Train Loss: 1.46084130803744, Avg Train Acc: 0.5836588541666666
100% 2/2 [00:00<00:00, 28.60it/s]
Avg Val Loss: 0.674818828701973, Avg Val Acc: 0.8060267865657806 (Best)
=== Epoch: 26 ===
100% 12/12 [00:01<00:00, 11.69it/s]
Avg Train Loss: 1.398008753856023, Avg Train Acc: 0.58984375
100% 2/2 [00:00<00:00, 31.45it/s]
Avg Val Loss: 0.6227370798587799, Avg Val Acc: 0.8079799115657806 (Best)
=== Epoch: 27 ===
100% 12/12 [00:01<00:00, 11.62it/s]
Avg Train Loss: 1.4258811076482136, Avg Train Acc: 0.5833333333333334
100% 2/2 [00:00<00:00, 31.11it/s]
Avg Val Loss: 0.5914059057831764, Avg Val Acc: 0.8112723231315613 (Best)
=== Epoch: 28 ===
100% 12/12 [00:01<00:00, 11.77it/s]
Avg Train Loss: 1.3355164329210918, Avg Train Acc: 0.6110026041666666
100% 2/2 [00:00<00:00, 31.80it/s]
Avg Val Loss: 0.5824323669075966, Avg Val Acc: 0.8392299115657806 (Best)
=== Epoch: 29 ===
100% 12/12 [00:01<00:00, 11.78it/s]
Avg Train Loss: 1.3547759751478832, Avg Train Acc: 0.6116536458333334
100% 2/2 [00:00<00:00, 31.73it/s]
Avg Val Loss: 0.5407414063811302, Avg Val Acc: 0.845703125 (Best)
=== Epoch: 30 ===
100% 12/12 [00:01<00:00, 11.77it/s]
Avg Train Loss: 1.322093774875005, Avg Train Acc: 0.6178385416666666
100% 2/2 [00:00<00:00, 32.22it/s]
Avg Val Loss: 0.5484336540102959, Avg Val Acc: 0.8151785731315613 (Best: 0.845703125)
=== Epoch: 31 ===
100% 12/12 [00:01<00:00, 10.72it/s]
Avg Train Loss: 1.3073560893535614, Avg Train Acc: 0.60546875
100% 2/2 [00:00<00:00, 30.90it/s]
Avg Val Loss: 0.5572592988610268, Avg Val Acc: 0.8366629481315613 (Best: 0.845703125)
=== Epoch: 32 ===
100% 12/12 [00:01<00:00, 11.59it/s]
Avg Train Loss: 1.2718457579612732, Avg Train Acc: 0.6194661458333334
100% 2/2 [00:00<00:00, 30.47it/s]
Avg Val Loss: 0.5120470374822617, Avg Val Acc: 0.8470424115657806 (Best)
=== Epoch: 33 ===
100% 12/12 [00:01<00:00, 11.63it/s]
Avg Train Loss: 1.2702125112215679, Avg Train Acc: 0.625
100% 2/2 [00:00<00:00, 27.76it/s]
Avg Val Loss: 0.5299972966313362, Avg Val Acc: 0.8372767865657806 (Best: 0.8470424115657806)
=== Epoch: 34 ===
100% 12/12 [00:01<00:00, 11.72it/s]
Avg Train Loss: 1.2846256295839946, Avg Train Acc: 0.6194661458333334
100% 2/2 [00:00<00:00, 32.69it/s]
Avg Val Loss: 0.48129914700984955, Avg Val Acc: 0.8568080365657806 (Best)
=== Epoch: 35 ===
100% 12/12 [00:01<00:00, 11.83it/s]
Avg Train Loss: 1.2228300472100575, Avg Train Acc: 0.6435546875
100% 2/2 [00:00<00:00, 30.62it/s]
Avg Val Loss: 0.4355681538581848, Avg Val Acc: 0.8685267865657806 (Best)
=== Epoch: 36 ===
100% 12/12 [00:01<00:00, 11.47it/s]
Avg Train Loss: 1.186530277132988, Avg Train Acc: 0.6484375
100% 2/2 [00:00<00:00, 31.10it/s]
Avg Val Loss: 0.46704109758138657, Avg Val Acc: 0.8587611615657806 (Best: 0.8685267865657806)
=== Epoch: 37 ===
100% 12/12 [00:01<00:00, 11.64it/s]
Avg Train Loss: 1.2111596465110779, Avg Train Acc: 0.640625
100% 2/2 [00:00<00:00, 30.03it/s]
Avg Val Loss: 0.3989640921354294, Avg Val Acc: 0.890625 (Best)
=== Epoch: 38 ===
100% 12/12 [00:01<00:00, 11.75it/s]
Avg Train Loss: 1.158986856540044, Avg Train Acc: 0.6484375
100% 2/2 [00:00<00:00, 31.84it/s]
Avg Val Loss: 0.45828763023018837, Avg Val Acc: 0.87890625 (Best: 0.890625)
=== Epoch: 39 ===
100% 12/12 [00:01<00:00, 11.72it/s]
Avg Train Loss: 1.1933139165242512, Avg Train Acc: 0.6516927083333334
100% 2/2 [00:00<00:00, 31.94it/s]
Avg Val Loss: 0.38705215603113174, Avg Val Acc: 0.892578125 (Best)
=== Epoch: 40 ===
100% 12/12 [00:01<00:00, 11.78it/s]
Avg Train Loss: 1.1233080526192982, Avg Train Acc: 0.66796875
100% 2/2 [00:00<00:00, 32.65it/s]
Avg Val Loss: 0.37229904159903526, Avg Val Acc: 0.880859375 (Best: 0.892578125)
=== Epoch: 41 ===
100% 12/12 [00:01<00:00, 11.47it/s]
Avg Train Loss: 1.069858764608701, Avg Train Acc: 0.6845703125
100% 2/2 [00:00<00:00, 32.49it/s]
Avg Val Loss: 0.3654223047196865, Avg Val Acc: 0.876953125 (Best: 0.892578125)
=== Epoch: 42 ===
100% 12/12 [00:01<00:00, 11.63it/s]
Avg Train Loss: 1.057497148712476, Avg Train Acc: 0.6907552083333334
100% 2/2 [00:00<00:00, 29.92it/s]
Avg Val Loss: 0.31178973987698555, Avg Val Acc: 0.904296875 (Best)
=== Epoch: 43 ===
100% 12/12 [00:01<00:00, 11.51it/s]
Avg Train Loss: 1.0017637858788173, Avg Train Acc: 0.6988932291666666
100% 2/2 [00:00<00:00, 31.85it/s]
Avg Val Loss: 0.32995979115366936, Avg Val Acc: 0.89453125 (Best: 0.904296875)
=== Epoch: 44 ===
100% 12/12 [00:01<00:00, 11.79it/s]
Avg Train Loss: 1.0170263051986694, Avg Train Acc: 0.7027994791666666
100% 2/2 [00:00<00:00, 32.05it/s]
Avg Val Loss: 0.32992105185985565, Avg Val Acc: 0.900390625 (Best: 0.904296875)
=== Epoch: 45 ===
100% 12/12 [00:01<00:00, 11.82it/s]
Avg Train Loss: 1.008415495355924, Avg Train Acc: 0.7135416666666666
100% 2/2 [00:00<00:00, 32.58it/s]
Avg Val Loss: 0.31888264790177345, Avg Val Acc: 0.912109375 (Best)
=== Epoch: 46 ===
100% 12/12 [00:01<00:00, 11.70it/s]
Avg Train Loss: 1.0076874941587448, Avg Train Acc: 0.701171875
100% 2/2 [00:00<00:00, 29.26it/s]
Avg Val Loss: 0.2998829744756222, Avg Val Acc: 0.904296875 (Best: 0.912109375)
=== Epoch: 47 ===
100% 12/12 [00:01<00:00, 11.73it/s]
Avg Train Loss: 0.9587768018245697, Avg Train Acc: 0.7132161458333334
100% 2/2 [00:00<00:00, 28.37it/s]
Avg Val Loss: 0.3140985630452633, Avg Val Acc: 0.900390625 (Best: 0.912109375)
=== Epoch: 48 ===
100% 12/12 [00:01<00:00, 11.67it/s]
Avg Train Loss: 0.9529004792372385, Avg Train Acc: 0.7216796875
100% 2/2 [00:00<00:00, 31.23it/s]
Avg Val Loss: 0.2855454385280609, Avg Val Acc: 0.916015625 (Best)
=== Epoch: 49 ===
100% 12/12 [00:01<00:00, 11.34it/s]
Avg Train Loss: 0.9508286466201147, Avg Train Acc: 0.7190755208333334
100% 2/2 [00:00<00:00, 31.68it/s]
Avg Val Loss: 0.2776581160724163, Avg Val Acc: 0.908203125 (Best: 0.916015625)
=== Epoch: 50 ===
100% 12/12 [00:01<00:00, 11.34it/s]
Avg Train Loss: 0.9526049594084421, Avg Train Acc: 0.7242838541666666
100% 2/2 [00:00<00:00, 31.11it/s]
Avg Val Loss: 0.29358337819576263, Avg Val Acc: 0.900390625 (Best: 0.916015625)
=== Epoch: 51 ===
100% 12/12 [00:01<00:00, 11.64it/s]
Avg Train Loss: 0.9154101808865865, Avg Train Acc: 0.728515625
100% 2/2 [00:00<00:00, 32.28it/s]
Avg Val Loss: 0.27424659579992294, Avg Val Acc: 0.9095424115657806 (Best: 0.916015625)
=== Epoch: 52 ===
100% 12/12 [00:01<00:00, 11.66it/s]
Avg Train Loss: 0.9258026331663132, Avg Train Acc: 0.7223307291666666
100% 2/2 [00:00<00:00, 32.21it/s]
Avg Val Loss: 0.27608050033450127, Avg Val Acc: 0.908203125 (Best: 0.916015625)
=== Epoch: 53 ===
100% 12/12 [00:01<00:00, 11.81it/s]
Avg Train Loss: 0.9271817257006963, Avg Train Acc: 0.7242838541666666
100% 2/2 [00:00<00:00, 30.87it/s]
Avg Val Loss: 0.2675929982215166, Avg Val Acc: 0.9140625 (Best: 0.916015625)
=== Epoch: 54 ===
100% 12/12 [00:01<00:00, 11.62it/s]
Compute NCM
Avg Train Loss: 0.8834547847509384, Avg Train Acc: 0.7376302083333334
100% 2/2 [00:00<00:00, 29.97it/s]
Avg Val Loss: 0.24392411671578884, Avg Val Acc: 0.91796875 (Best)
100% 12/12 [00:00<00:00, 15.17it/s]
100% 12/12 [00:00<00:00, 15.04it/s]
100% 12/12 [00:00<00:00, 15.23it/s]
torch.Size([20, 64])
Testing with last model..
100% 4/4 [00:00<00:00,  9.14it/s]
100% 4/4 [00:00<00:00,  9.72it/s]
100% 4/4 [00:00<00:00,  9.45it/s]
100% 4/4 [00:00<00:00,  9.77it/s]
100% 4/4 [00:00<00:00,  9.29it/s]
100% 4/4 [00:00<00:00,  9.78it/s]
100% 4/4 [00:00<00:00,  9.42it/s]
100% 4/4 [00:00<00:00,  9.82it/s]
100% 4/4 [00:00<00:00,  9.84it/s]
100% 4/4 [00:00<00:00,  9.51it/s]
Test Acc: 0.4744106955826283
Test Acc: [[0.4316], [0.4824], [0.4785], [0.5086]]
0 Parameter containing:
tensor([1.0000, 0.9993, 0.9998, 1.0004, 1.0008, 1.0005, 0.9987, 0.9993, 1.0006,
        1.0006, 1.0015, 0.9991, 0.9993, 1.0006, 1.0019, 0.9994, 0.9995, 0.9995,
        1.0000, 1.0005, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000], device='cuda:0', requires_grad=True) Parameter containing:
tensor([-2.2092e-04, -9.8451e-04,  4.1269e-04, -1.3563e-04,  6.1471e-04,
         3.0881e-04, -1.4083e-03, -7.3157e-04, -4.5371e-05,  4.4716e-04,
         1.5157e-03, -7.5490e-04, -1.0238e-03,  4.3555e-04,  1.2995e-03,
        -1.1382e-03, -7.6473e-04, -6.9537e-04,  7.2325e-04,  7.4075e-04,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
       device='cuda:0', requires_grad=True)
Incremental num : 1
=== Epoch: 0 ===
100% 12/12 [00:02<00:00,  5.33it/s]
Avg Train Loss: 3.201440672079722, Avg Train Acc: 0.3177083333333333
100% 2/2 [00:00<00:00, 30.39it/s]
Avg Val Loss: 1.489149659872055, Avg Val Acc: 0.6241629421710968 (Best: 0.91796875)
=== Epoch: 1 ===
100% 12/12 [00:02<00:00,  5.35it/s]
Avg Train Loss: 2.763084630171458, Avg Train Acc: 0.40234375
100% 2/2 [00:00<00:00, 30.45it/s]
Avg Val Loss: 1.3427708148956299, Avg Val Acc: 0.6358816921710968 (Best: 0.91796875)
=== Epoch: 2 ===
100% 12/12 [00:02<00:00,  5.28it/s]
Avg Train Loss: 2.657584249973297, Avg Train Acc: 0.443359375
100% 2/2 [00:00<00:00, 31.79it/s]
Avg Val Loss: 1.2370303869247437, Avg Val Acc: 0.6872209906578064 (Best: 0.91796875)
=== Epoch: 3 ===
100% 12/12 [00:02<00:00,  5.25it/s]
Avg Train Loss: 2.550170878569285, Avg Train Acc: 0.4625651041666667
100% 2/2 [00:00<00:00, 31.15it/s]
Avg Val Loss: 1.200426384806633, Avg Val Acc: 0.7028459906578064 (Best: 0.91796875)
=== Epoch: 4 ===
100% 12/12 [00:02<00:00,  5.35it/s]
Avg Train Loss: 2.467683474222819, Avg Train Acc: 0.4892578125
100% 2/2 [00:00<00:00, 29.39it/s]
Avg Val Loss: 1.1484493017196655, Avg Val Acc: 0.6788504421710968 (Best: 0.91796875)
=== Epoch: 5 ===
100% 12/12 [00:02<00:00,  5.29it/s]
Avg Train Loss: 2.418969670931498, Avg Train Acc: 0.4899088541666667
100% 2/2 [00:00<00:00, 29.63it/s]
Avg Val Loss: 1.1151087284088135, Avg Val Acc: 0.6967075765132904 (Best: 0.91796875)
=== Epoch: 6 ===
100% 12/12 [00:02<00:00,  5.39it/s]
Avg Train Loss: 2.3663211464881897, Avg Train Acc: 0.5091145833333334
100% 2/2 [00:00<00:00, 29.98it/s]
Avg Val Loss: 1.087656632065773, Avg Val Acc: 0.7223772406578064 (Best: 0.91796875)
=== Epoch: 7 ===
100% 12/12 [00:02<00:00,  5.31it/s]
Avg Train Loss: 2.360186457633972, Avg Train Acc: 0.5065104166666666
100% 2/2 [00:00<00:00, 30.84it/s]
Avg Val Loss: 1.068118691444397, Avg Val Acc: 0.7162388265132904 (Best: 0.91796875)
=== Epoch: 8 ===
100% 12/12 [00:02<00:00,  5.33it/s]
Avg Train Loss: 2.3028257489204407, Avg Train Acc: 0.517578125
100% 2/2 [00:00<00:00, 31.42it/s]
Avg Val Loss: 1.0702465921640396, Avg Val Acc: 0.7006138265132904 (Best: 0.91796875)
=== Epoch: 9 ===
100% 12/12 [00:02<00:00,  5.41it/s]
Avg Train Loss: 2.2903224329153695, Avg Train Acc: 0.5244140625
100% 2/2 [00:00<00:00, 31.40it/s]
Avg Val Loss: 1.0528503358364105, Avg Val Acc: 0.7301897406578064 (Best: 0.91796875)
=== Epoch: 10 ===
100% 12/12 [00:02<00:00,  5.38it/s]
Avg Train Loss: 2.2754273811976113, Avg Train Acc: 0.537109375
100% 2/2 [00:00<00:00, 30.38it/s]
Avg Val Loss: 1.049340397119522, Avg Val Acc: 0.7282366156578064 (Best: 0.91796875)
=== Epoch: 11 ===
100% 12/12 [00:02<00:00,  5.30it/s]
Avg Train Loss: 2.2547707160313926, Avg Train Acc: 0.53125
100% 2/2 [00:00<00:00, 30.59it/s]
Avg Val Loss: 1.0149918347597122, Avg Val Acc: 0.7497209906578064 (Best: 0.91796875)
=== Epoch: 12 ===
100% 12/12 [00:02<00:00,  5.34it/s]
Avg Train Loss: 2.2011209527651467, Avg Train Acc: 0.5416666666666666
100% 2/2 [00:00<00:00, 32.27it/s]
Avg Val Loss: 1.0045033991336823, Avg Val Acc: 0.7419084906578064 (Best: 0.91796875)
=== Epoch: 13 ===
100% 12/12 [00:02<00:00,  5.36it/s]
Avg Train Loss: 2.1862918933232627, Avg Train Acc: 0.5501302083333334
100% 2/2 [00:00<00:00, 30.43it/s]
Avg Val Loss: 0.9927433431148529, Avg Val Acc: 0.759765625 (Best: 0.91796875)
=== Epoch: 14 ===
100% 12/12 [00:02<00:00,  5.35it/s]
Avg Train Loss: 2.1794156432151794, Avg Train Acc: 0.5514322916666666
100% 2/2 [00:00<00:00, 30.03it/s]
Avg Val Loss: 0.9873310327529907, Avg Val Acc: 0.7220982015132904 (Best: 0.91796875)
=== Epoch: 15 ===
100% 12/12 [00:02<00:00,  5.34it/s]
Avg Train Loss: 2.129286835590998, Avg Train Acc: 0.5556640625
100% 2/2 [00:00<00:00, 19.74it/s]
Avg Val Loss: 0.9700486361980438, Avg Val Acc: 0.7399553656578064 (Best: 0.91796875)
=== Epoch: 16 ===
100% 12/12 [00:02<00:00,  5.46it/s]
Avg Train Loss: 2.1349218984444938, Avg Train Acc: 0.5530598958333334
100% 2/2 [00:00<00:00, 31.26it/s]
Avg Val Loss: 0.9629923552274704, Avg Val Acc: 0.767578125 (Best: 0.91796875)
=== Epoch: 17 ===
100% 12/12 [00:02<00:00,  5.33it/s]
Avg Train Loss: 2.1329049666722617, Avg Train Acc: 0.5478515625
100% 2/2 [00:00<00:00, 32.73it/s]
Avg Val Loss: 0.9245063364505768, Avg Val Acc: 0.767578125 (Best: 0.91796875)
=== Epoch: 18 ===
100% 12/12 [00:02<00:00,  5.38it/s]
Avg Train Loss: 2.125425477822622, Avg Train Acc: 0.5569661458333334
100% 2/2 [00:00<00:00, 32.30it/s]
Avg Val Loss: 0.9085185080766678, Avg Val Acc: 0.7575334906578064 (Best: 0.91796875)
=== Epoch: 19 ===
100% 12/12 [00:02<00:00,  5.40it/s]
Avg Train Loss: 2.0669698119163513, Avg Train Acc: 0.5738932291666666
100% 2/2 [00:00<00:00, 32.33it/s]
Avg Val Loss: 0.9007474258542061, Avg Val Acc: 0.775390625 (Best: 0.91796875)
=== Epoch: 20 ===
100% 12/12 [00:02<00:00,  5.36it/s]
Avg Train Loss: 2.0487748781840005, Avg Train Acc: 0.5758463541666666
100% 2/2 [00:00<00:00, 30.41it/s]
Avg Val Loss: 0.920074924826622, Avg Val Acc: 0.7734375 (Best: 0.91796875)
=== Epoch: 21 ===
100% 12/12 [00:02<00:00,  5.03it/s]
Avg Train Loss: 2.0271950165430703, Avg Train Acc: 0.5777994791666666
100% 2/2 [00:00<00:00, 25.29it/s]
Avg Val Loss: 0.9106222912669182, Avg Val Acc: 0.7536272406578064 (Best: 0.91796875)
=== Epoch: 22 ===
100% 12/12 [00:02<00:00,  5.20it/s]
Avg Train Loss: 2.032529135545095, Avg Train Acc: 0.58203125
100% 2/2 [00:00<00:00, 29.74it/s]
Avg Val Loss: 0.8743865489959717, Avg Val Acc: 0.78125 (Best: 0.91796875)
=== Epoch: 23 ===
100% 12/12 [00:02<00:00,  5.37it/s]
Avg Train Loss: 1.9911667704582214, Avg Train Acc: 0.5794270833333334
100% 2/2 [00:00<00:00, 33.19it/s]
Avg Val Loss: 0.8809998780488968, Avg Val Acc: 0.7536272406578064 (Best: 0.91796875)
=== Epoch: 24 ===
100% 12/12 [00:02<00:00,  5.36it/s]
Avg Train Loss: 1.9984906613826752, Avg Train Acc: 0.5830078125
100% 2/2 [00:00<00:00, 32.69it/s]
Avg Val Loss: 0.8751407489180565, Avg Val Acc: 0.7594866156578064 (Best: 0.91796875)
=== Epoch: 25 ===
100% 12/12 [00:02<00:00,  5.38it/s]
Avg Train Loss: 1.937214841445287, Avg Train Acc: 0.5999348958333334
100% 2/2 [00:00<00:00, 29.43it/s]
Avg Val Loss: 0.8506247997283936, Avg Val Acc: 0.78125 (Best: 0.91796875)
=== Epoch: 26 ===
100% 12/12 [00:02<00:00,  5.36it/s]
Avg Train Loss: 1.9615628619988759, Avg Train Acc: 0.6051432291666666
100% 2/2 [00:00<00:00, 30.98it/s]
Avg Val Loss: 0.856580413877964, Avg Val Acc: 0.783203125 (Best: 0.91796875)
=== Epoch: 27 ===
100% 12/12 [00:02<00:00,  5.40it/s]
Avg Train Loss: 1.9387416044871013, Avg Train Acc: 0.603515625
100% 2/2 [00:00<00:00, 30.73it/s]
Avg Val Loss: 0.842820331454277, Avg Val Acc: 0.787109375 (Best: 0.91796875)
=== Epoch: 28 ===
100% 12/12 [00:02<00:00,  5.40it/s]
Avg Train Loss: 1.9187930126984913, Avg Train Acc: 0.6031901041666666
100% 2/2 [00:00<00:00, 31.63it/s]
Avg Val Loss: 0.829837940633297, Avg Val Acc: 0.79296875 (Best: 0.91796875)
=== Epoch: 29 ===
100% 12/12 [00:02<00:00,  5.40it/s]
Avg Train Loss: 1.9589187800884247, Avg Train Acc: 0.6031901041666666
100% 2/2 [00:00<00:00, 31.32it/s]
Avg Val Loss: 0.8069027662277222, Avg Val Acc: 0.798828125 (Best: 0.91796875)
=== Epoch: 30 ===
100% 12/12 [00:02<00:00,  5.40it/s]
Avg Train Loss: 1.8948968549569447, Avg Train Acc: 0.6103515625
100% 2/2 [00:00<00:00, 31.00it/s]
Avg Val Loss: 0.8187046125531197, Avg Val Acc: 0.802734375 (Best: 0.91796875)
=== Epoch: 31 ===
100% 12/12 [00:02<00:00,  5.45it/s]
Avg Train Loss: 1.903834342956543, Avg Train Acc: 0.60546875
100% 2/2 [00:00<00:00, 31.62it/s]
Avg Val Loss: 0.8359404280781746, Avg Val Acc: 0.796875 (Best: 0.91796875)
=== Epoch: 32 ===
100% 12/12 [00:02<00:00,  5.42it/s]
Avg Train Loss: 1.8892322778701782, Avg Train Acc: 0.6188151041666666
100% 2/2 [00:00<00:00, 32.38it/s]
Avg Val Loss: 0.8237992897629738, Avg Val Acc: 0.80078125 (Best: 0.91796875)
=== Epoch: 33 ===
100% 12/12 [00:02<00:00,  5.37it/s]
Avg Train Loss: 1.895162582397461, Avg Train Acc: 0.6097005208333334
100% 2/2 [00:00<00:00, 29.27it/s]
Avg Val Loss: 0.8148513063788414, Avg Val Acc: 0.79296875 (Best: 0.91796875)
=== Epoch: 34 ===
100% 12/12 [00:02<00:00,  5.40it/s]
Avg Train Loss: 1.9325095812479656, Avg Train Acc: 0.60546875
100% 2/2 [00:00<00:00, 31.26it/s]
Avg Val Loss: 0.8184705004096031, Avg Val Acc: 0.796875 (Best: 0.91796875)
=== Epoch: 35 ===
100% 12/12 [00:02<00:00,  5.36it/s]
Avg Train Loss: 1.874355177084605, Avg Train Acc: 0.6201171875
100% 2/2 [00:00<00:00, 31.97it/s]
Avg Val Loss: 0.8365603387355804, Avg Val Acc: 0.78125 (Best: 0.91796875)
=== Epoch: 36 ===
100% 12/12 [00:02<00:00,  5.40it/s]
Avg Train Loss: 1.8912836611270905, Avg Train Acc: 0.6145833333333334
100% 2/2 [00:00<00:00, 31.66it/s]
Avg Val Loss: 0.8056533858180046, Avg Val Acc: 0.78515625 (Best: 0.91796875)
=== Epoch: 37 ===
100% 12/12 [00:02<00:00,  5.17it/s]
Avg Train Loss: 1.8640757699807484, Avg Train Acc: 0.6305338541666666
100% 2/2 [00:00<00:00, 30.80it/s]
Avg Val Loss: 0.8013894036412239, Avg Val Acc: 0.794921875 (Best: 0.91796875)
=== Epoch: 38 ===
100% 12/12 [00:02<00:00,  5.39it/s]
Avg Train Loss: 1.837064117193222, Avg Train Acc: 0.619140625
100% 2/2 [00:00<00:00, 32.10it/s]
Avg Val Loss: 0.7889688238501549, Avg Val Acc: 0.7848772406578064 (Best: 0.91796875)
=== Epoch: 39 ===
100% 12/12 [00:02<00:00,  5.46it/s]
Avg Train Loss: 1.8829263746738434, Avg Train Acc: 0.6194661458333334
100% 2/2 [00:00<00:00, 31.62it/s]
Avg Val Loss: 0.7962070256471634, Avg Val Acc: 0.7731584906578064 (Best: 0.91796875)
=== Epoch: 40 ===
100% 12/12 [00:02<00:00,  5.42it/s]
Avg Train Loss: 1.8286704123020172, Avg Train Acc: 0.6240234375
100% 2/2 [00:00<00:00, 32.14it/s]
Avg Val Loss: 0.7926252409815788, Avg Val Acc: 0.7790178656578064 (Best: 0.91796875)
=== Epoch: 41 ===
100% 12/12 [00:02<00:00,  5.37it/s]
Avg Train Loss: 1.8354465266068776, Avg Train Acc: 0.6298828125
100% 2/2 [00:00<00:00, 31.68it/s]
Avg Val Loss: 0.7878028750419617, Avg Val Acc: 0.7692522406578064 (Best: 0.91796875)
=== Epoch: 42 ===
100% 12/12 [00:02<00:00,  5.41it/s]
Avg Train Loss: 1.8319155871868134, Avg Train Acc: 0.6214192708333334
100% 2/2 [00:00<00:00, 32.06it/s]
Avg Val Loss: 0.800845667719841, Avg Val Acc: 0.7790178656578064 (Best: 0.91796875)
=== Epoch: 43 ===
100% 12/12 [00:02<00:00,  5.44it/s]
Avg Train Loss: 1.8267262975374858, Avg Train Acc: 0.634765625
100% 2/2 [00:00<00:00, 30.90it/s]
Avg Val Loss: 0.7655867338180542, Avg Val Acc: 0.7829241156578064 (Best: 0.91796875)
=== Epoch: 44 ===
100% 12/12 [00:02<00:00,  5.42it/s]
Avg Train Loss: 1.8432693084081013, Avg Train Acc: 0.6354166666666666
100% 2/2 [00:00<00:00, 31.79it/s]
Avg Val Loss: 0.7822004109621048, Avg Val Acc: 0.80078125 (Best: 0.91796875)
=== Epoch: 45 ===
100% 12/12 [00:02<00:00,  5.36it/s]
Avg Train Loss: 1.835113028685252, Avg Train Acc: 0.6302083333333334
100% 2/2 [00:00<00:00, 33.29it/s]
Avg Val Loss: 0.7950124517083168, Avg Val Acc: 0.7809709906578064 (Best: 0.91796875)
=== Epoch: 46 ===
100% 12/12 [00:02<00:00,  5.40it/s]
Avg Train Loss: 1.7516578435897827, Avg Train Acc: 0.6435546875
100% 2/2 [00:00<00:00, 32.97it/s]
Avg Val Loss: 0.7803204134106636, Avg Val Acc: 0.7770647406578064 (Best: 0.91796875)
=== Epoch: 47 ===
100% 12/12 [00:02<00:00,  5.36it/s]
Avg Train Loss: 1.8210977216561635, Avg Train Acc: 0.6295572916666666
100% 2/2 [00:00<00:00, 32.88it/s]
Avg Val Loss: 0.7678037658333778, Avg Val Acc: 0.7790178656578064 (Best: 0.91796875)
=== Epoch: 48 ===
100% 12/12 [00:02<00:00,  5.40it/s]
Avg Train Loss: 1.7897257407506306, Avg Train Acc: 0.640625
100% 2/2 [00:00<00:00, 29.21it/s]
Avg Val Loss: 0.7649325802922249, Avg Val Acc: 0.798828125 (Best: 0.91796875)
=== Epoch: 49 ===
100% 12/12 [00:02<00:00,  5.42it/s]
Avg Train Loss: 1.8109958569208782, Avg Train Acc: 0.6295572916666666
100% 2/2 [00:00<00:00, 31.56it/s]
Avg Val Loss: 0.7549882754683495, Avg Val Acc: 0.7907366156578064 (Best: 0.91796875)
=== Epoch: 50 ===
100% 12/12 [00:02<00:00,  5.32it/s]
Avg Train Loss: 1.8309029738108318, Avg Train Acc: 0.638671875
100% 2/2 [00:00<00:00, 31.83it/s]
Avg Val Loss: 0.768320269882679, Avg Val Acc: 0.7848772406578064 (Best: 0.91796875)
=== Epoch: 51 ===
100% 12/12 [00:02<00:00,  5.36it/s]
Avg Train Loss: 1.7964290579160054, Avg Train Acc: 0.64453125
100% 2/2 [00:00<00:00, 28.05it/s]
Avg Val Loss: 0.7682402655482292, Avg Val Acc: 0.7868303656578064 (Best: 0.91796875)
=== Epoch: 52 ===
100% 12/12 [00:02<00:00,  5.27it/s]
Compute NCM
Avg Train Loss: 1.7955570717652638, Avg Train Acc: 0.6324869791666666
100% 2/2 [00:00<00:00, 31.98it/s]
Avg Val Loss: 0.7283456400036812, Avg Val Acc: 0.7926897406578064 (Best: 0.91796875)
100% 12/12 [00:00<00:00, 15.03it/s]
100% 12/12 [00:00<00:00, 14.91it/s]
100% 12/12 [00:00<00:00, 15.39it/s]
torch.Size([40, 64])
Testing with last model..
100% 8/8 [00:00<00:00,  9.81it/s]
100% 8/8 [00:00<00:00,  9.86it/s]
100% 8/8 [00:00<00:00,  9.68it/s]
100% 8/8 [00:00<00:00,  9.38it/s]
100% 8/8 [00:00<00:00,  9.66it/s]
100% 8/8 [00:00<00:00,  9.01it/s]
100% 8/8 [00:00<00:00,  8.70it/s]
100% 8/8 [00:00<00:00,  9.75it/s]
100% 8/8 [00:00<00:00,  9.88it/s]
100% 8/8 [00:00<00:00,  9.71it/s]
Test Acc: 0.26029522214084866
Test Acc: [[0.2793], [0.248], [0.25], [0.2695], [0.2676], [0.2773], [0.2227], [0.2668]]
0 Parameter containing:
tensor([0.9999, 0.9994, 0.9998, 1.0003, 1.0010, 1.0009, 0.9984, 0.9995, 1.0001,
        1.0009, 1.0019, 0.9991, 0.9994, 1.0004, 1.0021, 0.9994, 0.9994, 0.9993,
        1.0004, 1.0005, 1.0000, 0.9983, 1.0006, 1.0021, 0.9991, 1.0007, 1.0002,
        1.0032, 0.9988, 0.9991, 0.9993, 1.0009, 1.0022, 0.9983, 0.9998, 1.0002,
        1.0004, 0.9982, 1.0002, 0.9971, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000], device='cuda:0', requires_grad=True) Parameter containing:
tensor([-0.0005, -0.0010,  0.0004, -0.0003,  0.0006,  0.0006, -0.0018, -0.0005,
        -0.0005,  0.0006,  0.0018, -0.0007, -0.0011,  0.0002,  0.0013, -0.0012,
        -0.0010, -0.0010,  0.0013,  0.0008, -0.0007, -0.0029,  0.0007,  0.0020,
        -0.0016,  0.0005, -0.0003,  0.0029, -0.0015, -0.0016, -0.0012,  0.0001,
         0.0020, -0.0024, -0.0005, -0.0003, -0.0011, -0.0022,  0.0005, -0.0029,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000], device='cuda:0',
       requires_grad=True)
Incremental num : 2
=== Epoch: 0 ===
100% 12/12 [00:03<00:00,  3.40it/s]
Avg Train Loss: 3.2811790903409324, Avg Train Acc: 0.3470052083333333
100% 2/2 [00:00<00:00, 30.52it/s]
Avg Val Loss: 1.7777577638626099, Avg Val Acc: 0.5461516082286835 (Best: 0.91796875)
=== Epoch: 1 ===
100% 12/12 [00:03<00:00,  3.38it/s]
Avg Train Loss: 3.148276666800181, Avg Train Acc: 0.3668619791666667
100% 2/2 [00:00<00:00, 30.35it/s]
Avg Val Loss: 1.664411723613739, Avg Val Acc: 0.6134259402751923 (Best: 0.91796875)
=== Epoch: 2 ===
100% 12/12 [00:03<00:00,  3.36it/s]
Avg Train Loss: 3.0342252254486084, Avg Train Acc: 0.3984375
100% 2/2 [00:00<00:00, 31.45it/s]
Avg Val Loss: 1.5685677826404572, Avg Val Acc: 0.6290509402751923 (Best: 0.91796875)
=== Epoch: 3 ===
100% 12/12 [00:03<00:00,  3.34it/s]
Avg Train Loss: 2.9183921019236245, Avg Train Acc: 0.4163411458333333
100% 2/2 [00:00<00:00, 30.07it/s]
Avg Val Loss: 1.504646122455597, Avg Val Acc: 0.6349103152751923 (Best: 0.91796875)
=== Epoch: 4 ===
100% 12/12 [00:03<00:00,  3.39it/s]
Avg Train Loss: 2.8483200073242188, Avg Train Acc: 0.4222005208333333
100% 2/2 [00:00<00:00, 30.41it/s]
Avg Val Loss: 1.4720242321491241, Avg Val Acc: 0.6320167779922485 (Best: 0.91796875)
=== Epoch: 5 ===
100% 12/12 [00:03<00:00,  3.43it/s]
Avg Train Loss: 2.8124992847442627, Avg Train Acc: 0.4313151041666667
100% 2/2 [00:00<00:00, 30.65it/s]
Avg Val Loss: 1.4382096529006958, Avg Val Acc: 0.6359230279922485 (Best: 0.91796875)
=== Epoch: 6 ===
100% 12/12 [00:03<00:00,  3.37it/s]
Avg Train Loss: 2.7305349906285605, Avg Train Acc: 0.4524739583333333
100% 2/2 [00:00<00:00, 30.73it/s]
Avg Val Loss: 1.3882839679718018, Avg Val Acc: 0.6563946902751923 (Best: 0.91796875)
=== Epoch: 7 ===
100% 12/12 [00:03<00:00,  3.31it/s]
Avg Train Loss: 2.657189687093099, Avg Train Acc: 0.4742838541666667
100% 2/2 [00:00<00:00, 29.85it/s]
Avg Val Loss: 1.3602603077888489, Avg Val Acc: 0.6885850727558136 (Best: 0.91796875)
=== Epoch: 8 ===
100% 12/12 [00:03<00:00,  3.36it/s]
Avg Train Loss: 2.621849318345388, Avg Train Acc: 0.4713541666666667
100% 2/2 [00:00<00:00, 28.68it/s]
Avg Val Loss: 1.330046832561493, Avg Val Acc: 0.6885850727558136 (Best: 0.91796875)
=== Epoch: 9 ===
100% 12/12 [00:03<00:00,  3.37it/s]
Avg Train Loss: 2.63783723115921, Avg Train Acc: 0.4599609375
100% 2/2 [00:00<00:00, 27.57it/s]
Avg Val Loss: 1.2987226843833923, Avg Val Acc: 0.7003038227558136 (Best: 0.91796875)
=== Epoch: 10 ===
100% 12/12 [00:03<00:00,  3.41it/s]
Avg Train Loss: 2.5655181209246316, Avg Train Acc: 0.4762369791666667
100% 2/2 [00:00<00:00, 30.44it/s]
Avg Val Loss: 1.2783183157444, Avg Val Acc: 0.7022569477558136 (Best: 0.91796875)
=== Epoch: 11 ===
100% 12/12 [00:03<00:00,  3.36it/s]
Avg Train Loss: 2.5892995794614158, Avg Train Acc: 0.4739583333333333
100% 2/2 [00:00<00:00, 31.26it/s]
Avg Val Loss: 1.2547909915447235, Avg Val Acc: 0.7042100727558136 (Best: 0.91796875)
=== Epoch: 12 ===
100% 12/12 [00:03<00:00,  3.39it/s]
Avg Train Loss: 2.5786490440368652, Avg Train Acc: 0.4856770833333333
100% 2/2 [00:00<00:00, 30.89it/s]
Avg Val Loss: 1.2292058169841766, Avg Val Acc: 0.7042100727558136 (Best: 0.91796875)
=== Epoch: 13 ===
100% 12/12 [00:03<00:00,  3.40it/s]
Avg Train Loss: 2.557278593381246, Avg Train Acc: 0.4977213541666667
100% 2/2 [00:00<00:00, 30.71it/s]
Avg Val Loss: 1.2189313173294067, Avg Val Acc: 0.6983506977558136 (Best: 0.91796875)
=== Epoch: 14 ===
100% 12/12 [00:03<00:00,  3.43it/s]
Avg Train Loss: 2.5035967429478965, Avg Train Acc: 0.4866536458333333
100% 2/2 [00:00<00:00, 28.48it/s]
Avg Val Loss: 1.2142065167427063, Avg Val Acc: 0.7042100727558136 (Best: 0.91796875)
=== Epoch: 15 ===
100% 12/12 [00:03<00:00,  3.41it/s]
Avg Train Loss: 2.518085221449534, Avg Train Acc: 0.5009765625
100% 2/2 [00:00<00:00, 31.19it/s]
Avg Val Loss: 1.2128606140613556, Avg Val Acc: 0.6983506977558136 (Best: 0.91796875)
=== Epoch: 16 ===
100% 12/12 [00:03<00:00,  3.38it/s]
Avg Train Loss: 2.492233455181122, Avg Train Acc: 0.5022786458333334
100% 2/2 [00:00<00:00, 28.10it/s]
Avg Val Loss: 1.2054327130317688, Avg Val Acc: 0.7003038227558136 (Best: 0.91796875)
=== Epoch: 17 ===
100% 12/12 [00:03<00:00,  3.38it/s]
Avg Train Loss: 2.4649548530578613, Avg Train Acc: 0.4967447916666667
100% 2/2 [00:00<00:00, 29.78it/s]
Avg Val Loss: 1.2055038064718246, Avg Val Acc: 0.7061631977558136 (Best: 0.91796875)
=== Epoch: 18 ===
100% 12/12 [00:03<00:00,  3.35it/s]
Avg Train Loss: 2.522316813468933, Avg Train Acc: 0.4921875
100% 2/2 [00:00<00:00, 29.64it/s]
Avg Val Loss: 1.185705840587616, Avg Val Acc: 0.7042100727558136 (Best: 0.91796875)
=== Epoch: 19 ===
100% 12/12 [00:03<00:00,  3.39it/s]
Avg Train Loss: 2.489212771256765, Avg Train Acc: 0.5074869791666666
100% 2/2 [00:00<00:00, 30.42it/s]
Avg Val Loss: 1.1957804262638092, Avg Val Acc: 0.7042100727558136 (Best: 0.91796875)
=== Epoch: 20 ===
100% 12/12 [00:03<00:00,  3.37it/s]
Avg Train Loss: 2.4895195166269937, Avg Train Acc: 0.501953125
100% 2/2 [00:00<00:00, 30.77it/s]
Avg Val Loss: 1.1914168149232864, Avg Val Acc: 0.7022569477558136 (Best: 0.91796875)
=== Epoch: 21 ===
100% 12/12 [00:03<00:00,  3.38it/s]
Avg Train Loss: 2.451722502708435, Avg Train Acc: 0.4996744791666667
100% 2/2 [00:00<00:00, 28.62it/s]
Avg Val Loss: 1.1864750534296036, Avg Val Acc: 0.7022569477558136 (Best: 0.91796875)
=== Epoch: 22 ===
100% 12/12 [00:03<00:00,  3.38it/s]
Avg Train Loss: 2.4337679346402488, Avg Train Acc: 0.5013020833333334
100% 2/2 [00:00<00:00, 30.78it/s]
Avg Val Loss: 1.1672181636095047, Avg Val Acc: 0.7081163227558136 (Best: 0.91796875)
=== Epoch: 23 ===
100% 12/12 [00:03<00:00,  3.37it/s]
Avg Train Loss: 2.4628965258598328, Avg Train Acc: 0.48828125
100% 2/2 [00:00<00:00, 30.06it/s]
Avg Val Loss: 1.1638431251049042, Avg Val Acc: 0.7120225727558136 (Best: 0.91796875)
=== Epoch: 24 ===
100% 12/12 [00:03<00:00,  3.42it/s]
Avg Train Loss: 2.4490119020144143, Avg Train Acc: 0.5113932291666666
100% 2/2 [00:00<00:00, 30.52it/s]
Avg Val Loss: 1.1285981684923172, Avg Val Acc: 0.7159288227558136 (Best: 0.91796875)
=== Epoch: 25 ===
100% 12/12 [00:03<00:00,  3.38it/s]
Avg Train Loss: 2.438077171643575, Avg Train Acc: 0.5152994791666666
100% 2/2 [00:00<00:00, 31.53it/s]
Avg Val Loss: 1.1305968463420868, Avg Val Acc: 0.7139756977558136 (Best: 0.91796875)
=== Epoch: 26 ===
100% 12/12 [00:03<00:00,  3.36it/s]
Avg Train Loss: 2.40506511926651, Avg Train Acc: 0.5149739583333334
100% 2/2 [00:00<00:00, 30.78it/s]
Avg Val Loss: 1.1177401840686798, Avg Val Acc: 0.7178819477558136 (Best: 0.91796875)
=== Epoch: 27 ===
100% 12/12 [00:03<00:00,  3.35it/s]
Avg Train Loss: 2.4246994455655417, Avg Train Acc: 0.5110677083333334
100% 2/2 [00:00<00:00, 31.23it/s]
Avg Val Loss: 1.1241542100906372, Avg Val Acc: 0.7100694477558136 (Best: 0.91796875)
=== Epoch: 28 ===
100% 12/12 [00:03<00:00,  3.37it/s]
Avg Train Loss: 2.3752312461535134, Avg Train Acc: 0.5139973958333334
100% 2/2 [00:00<00:00, 27.62it/s]
Avg Val Loss: 1.1331756711006165, Avg Val Acc: 0.6935040652751923 (Best: 0.91796875)
=== Epoch: 29 ===
100% 12/12 [00:03<00:00,  3.34it/s]
Avg Train Loss: 2.411772072315216, Avg Train Acc: 0.5240885416666666
100% 2/2 [00:00<00:00, 29.69it/s]
Avg Val Loss: 1.1277313232421875, Avg Val Acc: 0.6954571902751923 (Best: 0.91796875)
=== Epoch: 30 ===
100% 12/12 [00:03<00:00,  3.31it/s]
Avg Train Loss: 2.4107600251833596, Avg Train Acc: 0.5143229166666666
100% 2/2 [00:00<00:00, 29.19it/s]
Avg Val Loss: 1.1173865795135498, Avg Val Acc: 0.6954571902751923 (Best: 0.91796875)
=== Epoch: 31 ===
100% 12/12 [00:03<00:00,  3.36it/s]
Avg Train Loss: 2.36886332432429, Avg Train Acc: 0.5139973958333334
100% 2/2 [00:00<00:00, 30.12it/s]
Avg Val Loss: 1.1071723252534866, Avg Val Acc: 0.7081163227558136 (Best: 0.91796875)
=== Epoch: 32 ===
100% 12/12 [00:03<00:00,  3.36it/s]
Avg Train Loss: 2.373917539914449, Avg Train Acc: 0.5133463541666666
100% 2/2 [00:00<00:00, 29.39it/s]
Avg Val Loss: 1.111506626009941, Avg Val Acc: 0.6915509402751923 (Best: 0.91796875)
=== Epoch: 33 ===
100% 12/12 [00:03<00:00,  3.33it/s]
Avg Train Loss: 2.400266647338867, Avg Train Acc: 0.5022786458333334
100% 2/2 [00:00<00:00, 30.98it/s]
Avg Val Loss: 1.1088010966777802, Avg Val Acc: 0.6935040652751923 (Best: 0.91796875)
=== Epoch: 34 ===
100% 12/12 [00:03<00:00,  3.37it/s]
Avg Train Loss: 2.3529218435287476, Avg Train Acc: 0.5208333333333334
100% 2/2 [00:00<00:00, 30.18it/s]
Avg Val Loss: 1.1025141775608063, Avg Val Acc: 0.6915509402751923 (Best: 0.91796875)
=== Epoch: 35 ===
100% 12/12 [00:03<00:00,  3.37it/s]
Avg Train Loss: 2.3769604563713074, Avg Train Acc: 0.5188802083333334
100% 2/2 [00:00<00:00, 29.29it/s]
Avg Val Loss: 1.101906657218933, Avg Val Acc: 0.6935040652751923 (Best: 0.91796875)
=== Epoch: 36 ===
100% 12/12 [00:03<00:00,  3.36it/s]
Avg Train Loss: 2.376402576764425, Avg Train Acc: 0.5240885416666666
100% 2/2 [00:00<00:00, 28.57it/s]
Avg Val Loss: 1.0939224064350128, Avg Val Acc: 0.7100694477558136 (Best: 0.91796875)
=== Epoch: 37 ===
100% 12/12 [00:03<00:00,  3.39it/s]
Avg Train Loss: 2.3515323599179587, Avg Train Acc: 0.5237630208333334
100% 2/2 [00:00<00:00, 30.70it/s]
Avg Val Loss: 1.10214164853096, Avg Val Acc: 0.7042100727558136 (Best: 0.91796875)
=== Epoch: 38 ===
100% 12/12 [00:03<00:00,  3.38it/s]
Avg Train Loss: 2.3497175772984824, Avg Train Acc: 0.5266927083333334
100% 2/2 [00:00<00:00, 28.24it/s]
Avg Val Loss: 1.094454362988472, Avg Val Acc: 0.7100694477558136 (Best: 0.91796875)
=== Epoch: 39 ===
100% 12/12 [00:03<00:00,  3.37it/s]
Avg Train Loss: 2.3370283444722495, Avg Train Acc: 0.5335286458333334
100% 2/2 [00:00<00:00, 29.89it/s]
Avg Val Loss: 1.093985691666603, Avg Val Acc: 0.7159288227558136 (Best: 0.91796875)
=== Epoch: 40 ===
100% 12/12 [00:03<00:00,  3.41it/s]
Avg Train Loss: 2.358985881010691, Avg Train Acc: 0.5130208333333334
100% 2/2 [00:00<00:00, 30.85it/s]
Avg Val Loss: 1.1037327498197556, Avg Val Acc: 0.7061631977558136 (Best: 0.91796875)
=== Epoch: 41 ===
100% 12/12 [00:03<00:00,  3.42it/s]
Avg Train Loss: 2.377915402253469, Avg Train Acc: 0.51953125
100% 2/2 [00:00<00:00, 30.39it/s]
Avg Val Loss: 1.0998456925153732, Avg Val Acc: 0.7139756977558136 (Best: 0.91796875)
=== Epoch: 42 ===
100% 12/12 [00:03<00:00,  3.42it/s]
Avg Train Loss: 2.342016041278839, Avg Train Acc: 0.5227864583333334
100% 2/2 [00:00<00:00, 31.17it/s]
Avg Val Loss: 1.092742219567299, Avg Val Acc: 0.7100694477558136 (Best: 0.91796875)
=== Epoch: 43 ===
100% 12/12 [00:03<00:00,  3.38it/s]
Avg Train Loss: 2.344362735748291, Avg Train Acc: 0.533203125
100% 2/2 [00:00<00:00, 30.93it/s]
Avg Val Loss: 1.0944298207759857, Avg Val Acc: 0.7100694477558136 (Best: 0.91796875)
=== Epoch: 44 ===
100% 12/12 [00:03<00:00,  3.39it/s]
Avg Train Loss: 2.3663236697514853, Avg Train Acc: 0.5260416666666666
100% 2/2 [00:00<00:00, 19.92it/s]
Avg Val Loss: 1.0796391069889069, Avg Val Acc: 0.7120225727558136 (Best: 0.91796875)
=== Epoch: 45 ===
100% 12/12 [00:03<00:00,  3.44it/s]
Avg Train Loss: 2.395723263422648, Avg Train Acc: 0.5169270833333334
100% 2/2 [00:00<00:00, 29.81it/s]
Avg Val Loss: 1.0794895589351654, Avg Val Acc: 0.7198350727558136 (Best: 0.91796875)
=== Epoch: 46 ===
100% 12/12 [00:03<00:00,  3.43it/s]
Avg Train Loss: 2.364144722620646, Avg Train Acc: 0.521484375
100% 2/2 [00:00<00:00, 31.25it/s]
Avg Val Loss: 1.0909387022256851, Avg Val Acc: 0.7139756977558136 (Best: 0.91796875)
=== Epoch: 47 ===
100% 12/12 [00:03<00:00,  3.39it/s]
Avg Train Loss: 2.3414607445398965, Avg Train Acc: 0.5221354166666666
100% 2/2 [00:00<00:00, 28.03it/s]
Avg Val Loss: 1.0732334554195404, Avg Val Acc: 0.7120225727558136 (Best: 0.91796875)
=== Epoch: 48 ===
100% 12/12 [00:03<00:00,  3.40it/s]
Avg Train Loss: 2.3164322773615518, Avg Train Acc: 0.5276692708333334
100% 2/2 [00:00<00:00, 30.52it/s]
Avg Val Loss: 1.0656012296676636, Avg Val Acc: 0.7120225727558136 (Best: 0.91796875)
=== Epoch: 49 ===
100% 12/12 [00:03<00:00,  3.40it/s]
Avg Train Loss: 2.3141671419143677, Avg Train Acc: 0.5302734375
100% 2/2 [00:00<00:00, 30.46it/s]
Avg Val Loss: 1.0732875913381577, Avg Val Acc: 0.7120225727558136 (Best: 0.91796875)
=== Epoch: 50 ===
100% 12/12 [00:03<00:00,  3.38it/s]
Compute NCM
Avg Train Loss: 2.327715595563253, Avg Train Acc: 0.5240885416666666
100% 2/2 [00:00<00:00, 30.62it/s]
Avg Val Loss: 1.0444848537445068, Avg Val Acc: 0.7178819477558136 (Best: 0.91796875)
100% 12/12 [00:00<00:00, 13.93it/s]
100% 12/12 [00:00<00:00, 14.59it/s]
100% 12/12 [00:00<00:00, 14.41it/s]
torch.Size([60, 64])
Testing with last model..
100% 12/12 [00:01<00:00,  9.41it/s]
100% 12/12 [00:01<00:00,  9.47it/s]
100% 12/12 [00:01<00:00,  9.49it/s]
100% 12/12 [00:01<00:00,  9.53it/s]
100% 12/12 [00:01<00:00,  9.14it/s]
100% 12/12 [00:01<00:00,  9.05it/s]
100% 12/12 [00:01<00:00,  9.22it/s]
100% 12/12 [00:01<00:00,  9.56it/s]
100% 12/12 [00:01<00:00,  9.53it/s]
100% 12/12 [00:01<00:00,  9.32it/s]
Test Acc: 0.1909108920643727
Test Acc: [[0.2031], [0.1875], [0.1719], [0.1953], [0.2109], [0.1973], [0.2051], [0.1855], [0.1719], [0.1934], [0.168], [0.2011]]
0 Parameter containing:
tensor([0.9999, 0.9994, 0.9998, 1.0003, 1.0010, 1.0009, 0.9984, 0.9995, 1.0001,
        1.0009, 1.0019, 0.9991, 0.9994, 1.0004, 1.0021, 0.9994, 0.9994, 0.9993,
        1.0004, 1.0005, 0.9999, 0.9978, 1.0007, 1.0027, 0.9989, 1.0013, 1.0004,
        1.0040, 0.9985, 0.9990, 0.9994, 1.0010, 1.0029, 0.9978, 1.0001, 1.0001,
        1.0002, 0.9976, 1.0002, 0.9962, 0.9958, 0.9972, 0.9976, 0.9978, 0.9974,
        0.9962, 0.9970, 0.9956, 0.9952, 0.9968, 0.9957, 0.9966, 0.9981, 1.0022,
        0.9957, 0.9972, 0.9966, 0.9999, 0.9962, 1.0013, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000], device='cuda:0', requires_grad=True) Parameter containing:
tensor([-4.7684e-04, -9.9844e-04,  3.7787e-04, -3.2901e-04,  6.3977e-04,
         6.2565e-04, -1.8428e-03, -5.4105e-04, -5.4777e-04,  6.2435e-04,
         1.8518e-03, -6.6279e-04, -1.0720e-03,  1.5738e-04,  1.2804e-03,
        -1.2527e-03, -1.0104e-03, -1.0158e-03,  1.3249e-03,  8.0471e-04,
        -1.0560e-03, -3.6507e-03,  7.2471e-04,  2.7389e-03, -2.0182e-03,
         8.9401e-04, -2.9932e-04,  3.6792e-03, -2.0330e-03, -1.9440e-03,
        -1.2287e-03,  4.9189e-05,  2.6222e-03, -3.0631e-03, -2.6201e-04,
        -5.6913e-04, -1.7467e-03, -2.8881e-03,  5.1592e-04, -3.7712e-03,
        -4.3825e-03, -3.7932e-03, -3.0940e-03, -3.6595e-03, -2.9507e-03,
        -3.6267e-03, -3.6474e-03, -4.4275e-03, -5.2567e-03, -3.5290e-03,
        -4.4182e-03, -3.6773e-03, -2.8296e-03,  2.7262e-03, -4.6571e-03,
        -3.2757e-03, -4.2039e-03, -4.9558e-04, -4.4892e-03, -2.0118e-04,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
       device='cuda:0', requires_grad=True)
Incremental num : 3
=== Epoch: 0 ===
100% 13/13 [00:05<00:00,  2.44it/s]
Avg Train Loss: 4.350271114936242, Avg Train Acc: 0.26893028846153844
100% 2/2 [00:00<00:00, 31.05it/s]
Avg Val Loss: 2.009929656982422, Avg Val Acc: 0.5909598171710968 (Best: 0.91796875)
=== Epoch: 1 ===
100% 13/13 [00:05<00:00,  2.45it/s]
Avg Train Loss: 4.1915974617004395, Avg Train Acc: 0.27974759615384615
100% 2/2 [00:00<00:00, 30.54it/s]
Avg Val Loss: 1.9923917055130005, Avg Val Acc: 0.6029575765132904 (Best: 0.91796875)
=== Epoch: 2 ===
100% 13/13 [00:05<00:00,  2.44it/s]
Avg Train Loss: 4.1846403158628025, Avg Train Acc: 0.29537259615384615
100% 2/2 [00:00<00:00, 29.93it/s]
Avg Val Loss: 1.9900904297828674, Avg Val Acc: 0.5990513265132904 (Best: 0.91796875)
=== Epoch: 3 ===
100% 13/13 [00:05<00:00,  2.45it/s]
Avg Train Loss: 4.130095408512996, Avg Train Acc: 0.29837740384615385
100% 2/2 [00:00<00:00, 31.01it/s]
Avg Val Loss: 1.980749249458313, Avg Val Acc: 0.5929129421710968 (Best: 0.91796875)
=== Epoch: 4 ===
100% 13/13 [00:05<00:00,  2.41it/s]
Avg Train Loss: 4.153557538986206, Avg Train Acc: 0.3058894230769231
100% 2/2 [00:00<00:00, 29.48it/s]
Avg Val Loss: 1.9712994694709778, Avg Val Acc: 0.5909598171710968 (Best: 0.91796875)
=== Epoch: 5 ===
100% 13/13 [00:05<00:00,  2.41it/s]
Avg Train Loss: 4.07085475554833, Avg Train Acc: 0.29867788461538464
100% 2/2 [00:00<00:00, 28.05it/s]
Avg Val Loss: 1.9753218591213226, Avg Val Acc: 0.5890066921710968 (Best: 0.91796875)
=== Epoch: 6 ===
100% 13/13 [00:05<00:00,  2.44it/s]
Avg Train Loss: 4.078855771284837, Avg Train Acc: 0.3137019230769231
100% 2/2 [00:00<00:00, 30.46it/s]
Avg Val Loss: 1.966291755437851, Avg Val Acc: 0.6088169515132904 (Best: 0.91796875)
=== Epoch: 7 ===
100% 13/13 [00:05<00:00,  2.45it/s]
Avg Train Loss: 3.986874121886033, Avg Train Acc: 0.3194110576923077
100% 2/2 [00:00<00:00, 30.25it/s]
Avg Val Loss: 1.969368577003479, Avg Val Acc: 0.6088169515132904 (Best: 0.91796875)
=== Epoch: 8 ===
100% 13/13 [00:05<00:00,  2.42it/s]
Avg Train Loss: 4.008062491050134, Avg Train Acc: 0.33443509615384615
100% 2/2 [00:00<00:00, 31.06it/s]
Avg Val Loss: 1.9423211514949799, Avg Val Acc: 0.6007254421710968 (Best: 0.91796875)
=== Epoch: 9 ===
100% 13/13 [00:05<00:00,  2.43it/s]
Avg Train Loss: 3.997018043811505, Avg Train Acc: 0.3323317307692308
100% 2/2 [00:00<00:00, 30.66it/s]
Avg Val Loss: 1.9281813502311707, Avg Val Acc: 0.6185825765132904 (Best: 0.91796875)
=== Epoch: 10 ===
100% 13/13 [00:05<00:00,  2.45it/s]
Avg Train Loss: 3.916560961649968, Avg Train Acc: 0.3524639423076923
100% 2/2 [00:00<00:00, 30.49it/s]
Avg Val Loss: 1.9115756154060364, Avg Val Acc: 0.6244419515132904 (Best: 0.91796875)
=== Epoch: 11 ===
100% 13/13 [00:05<00:00,  2.44it/s]
Avg Train Loss: 3.944391030531663, Avg Train Acc: 0.3473557692307692
100% 2/2 [00:00<00:00, 29.06it/s]
Avg Val Loss: 1.9124027788639069, Avg Val Acc: 0.6224888265132904 (Best: 0.91796875)
=== Epoch: 12 ===
100% 13/13 [00:05<00:00,  2.45it/s]
Avg Train Loss: 3.894974561838003, Avg Train Acc: 0.3395432692307692
100% 2/2 [00:00<00:00, 28.89it/s]
Avg Val Loss: 1.898818850517273, Avg Val Acc: 0.6342075765132904 (Best: 0.91796875)
=== Epoch: 13 ===
100% 13/13 [00:05<00:00,  2.45it/s]
Avg Train Loss: 3.896796758358295, Avg Train Acc: 0.3605769230769231
100% 2/2 [00:00<00:00, 29.97it/s]
Avg Val Loss: 1.8750674724578857, Avg Val Acc: 0.6303013265132904 (Best: 0.91796875)
=== Epoch: 14 ===
100% 13/13 [00:05<00:00,  2.43it/s]
Avg Train Loss: 3.9143083829146166, Avg Train Acc: 0.34825721153846156
100% 2/2 [00:00<00:00, 29.79it/s]
Avg Val Loss: 1.8757840991020203, Avg Val Acc: 0.6244419515132904 (Best: 0.91796875)
=== Epoch: 15 ===
100% 13/13 [00:05<00:00,  2.45it/s]
Avg Train Loss: 3.8553938132065992, Avg Train Acc: 0.3563701923076923
100% 2/2 [00:00<00:00, 29.83it/s]
Avg Val Loss: 1.8636564910411835, Avg Val Acc: 0.6481584906578064 (Best: 0.91796875)
=== Epoch: 16 ===
100% 13/13 [00:05<00:00,  2.46it/s]
Avg Train Loss: 3.8780662279862623, Avg Train Acc: 0.3545673076923077
100% 2/2 [00:00<00:00, 30.52it/s]
Avg Val Loss: 1.8621410727500916, Avg Val Acc: 0.6400669515132904 (Best: 0.91796875)
=== Epoch: 17 ===
100% 13/13 [00:05<00:00,  2.43it/s]
Avg Train Loss: 3.808428947742169, Avg Train Acc: 0.36658653846153844
100% 2/2 [00:00<00:00, 31.63it/s]
Avg Val Loss: 1.8274948298931122, Avg Val Acc: 0.6559709906578064 (Best: 0.91796875)
=== Epoch: 18 ===
100% 13/13 [00:05<00:00,  2.45it/s]
Avg Train Loss: 3.7944501546713023, Avg Train Acc: 0.3674879807692308
100% 2/2 [00:00<00:00, 29.41it/s]
Avg Val Loss: 1.8117174804210663, Avg Val Acc: 0.671875 (Best: 0.91796875)
=== Epoch: 19 ===
100% 13/13 [00:05<00:00,  2.46it/s]
Avg Train Loss: 3.878591592495258, Avg Train Acc: 0.37650240384615385
100% 2/2 [00:00<00:00, 30.25it/s]
Avg Val Loss: 1.8054635524749756, Avg Val Acc: 0.6478794515132904 (Best: 0.91796875)
=== Epoch: 20 ===
100% 13/13 [00:05<00:00,  2.38it/s]
Avg Train Loss: 3.8378386680896464, Avg Train Acc: 0.37319711538461536
100% 2/2 [00:00<00:00, 11.96it/s]
Avg Val Loss: 1.7864007949829102, Avg Val Acc: 0.6657366156578064 (Best: 0.91796875)
=== Epoch: 21 ===
100% 13/13 [00:05<00:00,  2.38it/s]
Avg Train Loss: 3.812553570820735, Avg Train Acc: 0.3683894230769231
100% 2/2 [00:00<00:00, 26.31it/s]
Avg Val Loss: 1.7715185284614563, Avg Val Acc: 0.6696428656578064 (Best: 0.91796875)
=== Epoch: 22 ===
100% 13/13 [00:05<00:00,  2.46it/s]
Avg Train Loss: 3.821353875673734, Avg Train Acc: 0.3753004807692308
100% 2/2 [00:00<00:00, 30.57it/s]
Avg Val Loss: 1.782279759645462, Avg Val Acc: 0.6676897406578064 (Best: 0.91796875)
=== Epoch: 23 ===
100% 13/13 [00:05<00:00,  2.46it/s]
Avg Train Loss: 3.7886101465958815, Avg Train Acc: 0.37109375
100% 2/2 [00:00<00:00, 30.69it/s]
Avg Val Loss: 1.7708403766155243, Avg Val Acc: 0.6579241156578064 (Best: 0.91796875)
=== Epoch: 24 ===
100% 13/13 [00:05<00:00,  2.46it/s]
Avg Train Loss: 3.777943464425894, Avg Train Acc: 0.38431490384615385
100% 2/2 [00:00<00:00, 31.53it/s]
Avg Val Loss: 1.7711925506591797, Avg Val Acc: 0.6618303656578064 (Best: 0.91796875)
=== Epoch: 25 ===
100% 13/13 [00:05<00:00,  2.44it/s]
Avg Train Loss: 3.802588169391339, Avg Train Acc: 0.37710336538461536
100% 2/2 [00:00<00:00, 27.83it/s]
Avg Val Loss: 1.7678067684173584, Avg Val Acc: 0.6696428656578064 (Best: 0.91796875)
=== Epoch: 26 ===
100% 13/13 [00:05<00:00,  2.47it/s]
Avg Train Loss: 3.697091139279879, Avg Train Acc: 0.38040865384615385
100% 2/2 [00:00<00:00, 31.05it/s]
Avg Val Loss: 1.7607208490371704, Avg Val Acc: 0.6439732015132904 (Best: 0.91796875)
=== Epoch: 27 ===
100% 13/13 [00:05<00:00,  2.44it/s]
Avg Train Loss: 3.741674441557664, Avg Train Acc: 0.3671875
100% 2/2 [00:00<00:00, 30.17it/s]
Avg Val Loss: 1.7586702704429626, Avg Val Acc: 0.6715959906578064 (Best: 0.91796875)
=== Epoch: 28 ===
100% 13/13 [00:05<00:00,  2.46it/s]
Avg Train Loss: 3.7870929607978234, Avg Train Acc: 0.3864182692307692
100% 2/2 [00:00<00:00, 30.46it/s]
Avg Val Loss: 1.7585607767105103, Avg Val Acc: 0.6618303656578064 (Best: 0.91796875)
=== Epoch: 29 ===
100% 13/13 [00:05<00:00,  2.47it/s]
Avg Train Loss: 3.7746175069075365, Avg Train Acc: 0.37740384615384615
100% 2/2 [00:00<00:00, 31.52it/s]
Avg Val Loss: 1.7392458319664001, Avg Val Acc: 0.689453125 (Best: 0.91796875)
=== Epoch: 30 ===
100% 13/13 [00:05<00:00,  2.48it/s]
Avg Train Loss: 3.690838960500864, Avg Train Acc: 0.3870192307692308
100% 2/2 [00:00<00:00, 27.73it/s]
Avg Val Loss: 1.7434127628803253, Avg Val Acc: 0.6796875 (Best: 0.91796875)
=== Epoch: 31 ===
100% 13/13 [00:05<00:00,  2.48it/s]
Avg Train Loss: 3.7796856440030613, Avg Train Acc: 0.3828125
100% 2/2 [00:00<00:00, 29.40it/s]
Avg Val Loss: 1.738355040550232, Avg Val Acc: 0.6715959906578064 (Best: 0.91796875)
=== Epoch: 32 ===
100% 13/13 [00:05<00:00,  2.47it/s]
Avg Train Loss: 3.7066617745619554, Avg Train Acc: 0.375
100% 2/2 [00:00<00:00, 28.70it/s]
Avg Val Loss: 1.7200335264205933, Avg Val Acc: 0.69140625 (Best: 0.91796875)
=== Epoch: 33 ===
100% 13/13 [00:05<00:00,  2.48it/s]
Avg Train Loss: 3.706610918045044, Avg Train Acc: 0.3746995192307692
100% 2/2 [00:00<00:00, 27.93it/s]
Avg Val Loss: 1.7344144880771637, Avg Val Acc: 0.6517857015132904 (Best: 0.91796875)
=== Epoch: 34 ===
100% 13/13 [00:05<00:00,  2.50it/s]
Avg Train Loss: 3.692725419998169, Avg Train Acc: 0.39272836538461536
100% 2/2 [00:00<00:00, 31.55it/s]
Avg Val Loss: 1.7218433320522308, Avg Val Acc: 0.68359375 (Best: 0.91796875)
=== Epoch: 35 ===
100% 13/13 [00:05<00:00,  2.50it/s]
Avg Train Loss: 3.6881772921635556, Avg Train Acc: 0.39693509615384615
100% 2/2 [00:00<00:00, 26.97it/s]
Avg Val Loss: 1.717073142528534, Avg Val Acc: 0.685546875 (Best: 0.91796875)
=== Epoch: 36 ===
100% 13/13 [00:05<00:00,  2.46it/s]
Avg Train Loss: 3.6881623634925256, Avg Train Acc: 0.3840144230769231
100% 2/2 [00:00<00:00, 31.26it/s]
Avg Val Loss: 1.7087484896183014, Avg Val Acc: 0.6715959906578064 (Best: 0.91796875)
=== Epoch: 37 ===
100% 13/13 [00:05<00:00,  2.45it/s]
Avg Train Loss: 3.7259625654954176, Avg Train Acc: 0.3903245192307692
100% 2/2 [00:00<00:00, 31.52it/s]
Avg Val Loss: 1.712173193693161, Avg Val Acc: 0.6556919515132904 (Best: 0.91796875)
=== Epoch: 38 ===
100% 13/13 [00:05<00:00,  2.46it/s]
Avg Train Loss: 3.6535586026998668, Avg Train Acc: 0.39272836538461536
100% 2/2 [00:00<00:00, 30.50it/s]
Avg Val Loss: 1.6950272619724274, Avg Val Acc: 0.6953125 (Best: 0.91796875)
=== Epoch: 39 ===
100% 13/13 [00:05<00:00,  2.45it/s]
Avg Train Loss: 3.698819508919349, Avg Train Acc: 0.3798076923076923
100% 2/2 [00:00<00:00, 26.57it/s]
Avg Val Loss: 1.6865736544132233, Avg Val Acc: 0.6735491156578064 (Best: 0.91796875)
=== Epoch: 40 ===
100% 13/13 [00:05<00:00,  2.44it/s]
Avg Train Loss: 3.724236855140099, Avg Train Acc: 0.3993389423076923
100% 2/2 [00:00<00:00, 28.74it/s]
Avg Val Loss: 1.6784447133541107, Avg Val Acc: 0.69921875 (Best: 0.91796875)
=== Epoch: 41 ===
100% 13/13 [00:05<00:00,  2.48it/s]
Avg Train Loss: 3.709999157832219, Avg Train Acc: 0.39633413461538464
100% 2/2 [00:00<00:00, 30.47it/s]
Avg Val Loss: 1.6611014902591705, Avg Val Acc: 0.6755022406578064 (Best: 0.91796875)
=== Epoch: 42 ===
100% 13/13 [00:05<00:00,  2.47it/s]
Avg Train Loss: 3.6627924809089074, Avg Train Acc: 0.38852163461538464
100% 2/2 [00:00<00:00, 30.68it/s]
Avg Val Loss: 1.6715006232261658, Avg Val Acc: 0.6875 (Best: 0.91796875)
=== Epoch: 43 ===
100% 13/13 [00:05<00:00,  2.45it/s]
Avg Train Loss: 3.6820104672358585, Avg Train Acc: 0.3915264423076923
100% 2/2 [00:00<00:00, 29.65it/s]
Avg Val Loss: 1.6832301318645477, Avg Val Acc: 0.693359375 (Best: 0.91796875)
=== Epoch: 44 ===
100% 13/13 [00:05<00:00,  2.50it/s]
Avg Train Loss: 3.7392740066234884, Avg Train Acc: 0.3918269230769231
100% 2/2 [00:00<00:00, 31.51it/s]
Avg Val Loss: 1.6605128943920135, Avg Val Acc: 0.693359375 (Best: 0.91796875)
=== Epoch: 45 ===
100% 13/13 [00:05<00:00,  2.48it/s]
Avg Train Loss: 3.6777322108928976, Avg Train Acc: 0.3825120192307692
100% 2/2 [00:00<00:00, 31.15it/s]
Avg Val Loss: 1.6682243645191193, Avg Val Acc: 0.689453125 (Best: 0.91796875)
=== Epoch: 46 ===
100% 13/13 [00:05<00:00,  2.50it/s]
Avg Train Loss: 3.674528268667368, Avg Train Acc: 0.4020432692307692
100% 2/2 [00:00<00:00, 31.29it/s]
Avg Val Loss: 1.6775731444358826, Avg Val Acc: 0.6676897406578064 (Best: 0.91796875)
=== Epoch: 47 ===
100% 13/13 [00:05<00:00,  2.50it/s]
Avg Train Loss: 3.715834672634418, Avg Train Acc: 0.39002403846153844
100% 2/2 [00:00<00:00, 31.97it/s]
Avg Val Loss: 1.659972369670868, Avg Val Acc: 0.685546875 (Best: 0.91796875)
=== Epoch: 48 ===
100% 13/13 [00:05<00:00,  2.49it/s]
Compute NCM
Avg Train Loss: 3.7150890093583326, Avg Train Acc: 0.38671875
100% 2/2 [00:00<00:00, 29.84it/s]
Avg Val Loss: 1.6684570014476776, Avg Val Acc: 0.6696428656578064 (Best: 0.91796875)
100% 13/13 [00:00<00:00, 15.15it/s]
100% 13/13 [00:00<00:00, 14.77it/s]
100% 13/13 [00:00<00:00, 15.18it/s]
torch.Size([80, 64])
Testing with last model..
100% 16/16 [00:01<00:00,  9.39it/s]
100% 16/16 [00:01<00:00,  9.54it/s]
100% 16/16 [00:01<00:00,  9.59it/s]
100% 16/16 [00:01<00:00,  9.58it/s]
100% 16/16 [00:01<00:00,  9.58it/s]
100% 16/16 [00:01<00:00,  9.79it/s]
100% 16/16 [00:01<00:00,  9.62it/s]
100% 16/16 [00:01<00:00,  9.57it/s]
100% 16/16 [00:01<00:00,  9.53it/s]
100% 16/16 [00:01<00:00,  9.70it/s]
Test Acc: 0.1696606444194913
Test Acc: [[0.2031], [0.1777], [0.1973], [0.1895], [0.1621], [0.1797], [0.1582], [0.1777], [0.1484], [0.1348], [0.168], [0.1426], [0.1699], [0.1523], [0.1816], [0.175]]
0 Parameter containing:
tensor([0.9999, 0.9994, 0.9998, 1.0003, 1.0010, 1.0009, 0.9984, 0.9995, 1.0001,
        1.0009, 1.0019, 0.9991, 0.9994, 1.0004, 1.0021, 0.9994, 0.9994, 0.9993,
        1.0004, 1.0005, 0.9999, 0.9978, 1.0007, 1.0028, 0.9989, 1.0013, 1.0004,
        1.0041, 0.9985, 0.9990, 0.9994, 1.0010, 1.0029, 0.9978, 1.0001, 1.0001,
        1.0002, 0.9976, 1.0002, 0.9962, 0.9945, 0.9964, 0.9973, 0.9971, 0.9965,
        0.9951, 0.9960, 0.9943, 0.9936, 0.9960, 0.9948, 0.9951, 0.9976, 1.0027,
        0.9944, 0.9963, 0.9954, 0.9995, 0.9948, 1.0014, 0.9962, 0.9888, 0.9895,
        0.9915, 0.9889, 0.9917, 0.9892, 0.9885, 0.9988, 0.9919, 0.9884, 0.9932,
        0.9922, 0.9904, 0.9886, 0.9888, 0.9919, 0.9890, 0.9885, 0.9896, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000], device='cuda:0', requires_grad=True) Parameter containing:
tensor([-4.7710e-04, -9.9845e-04,  3.7784e-04, -3.2920e-04,  6.3980e-04,
         6.2598e-04, -1.8433e-03, -5.4086e-04, -5.4827e-04,  6.2453e-04,
         1.8521e-03, -6.6270e-04, -1.0721e-03,  1.5710e-04,  1.2804e-03,
        -1.2528e-03, -1.0106e-03, -1.0162e-03,  1.3255e-03,  8.0477e-04,
        -1.0667e-03, -3.6773e-03,  7.2665e-04,  2.7648e-03, -2.0314e-03,
         9.0874e-04, -2.9804e-04,  3.7063e-03, -2.0526e-03, -1.9559e-03,
        -1.2291e-03,  4.5881e-05,  2.6436e-03, -3.0853e-03, -2.5232e-04,
        -5.7864e-04, -1.7681e-03, -2.9124e-03,  5.1554e-04, -3.8027e-03,
        -5.7911e-03, -4.9846e-03, -3.6872e-03, -4.8185e-03, -3.9479e-03,
        -4.6923e-03, -4.8454e-03, -5.6365e-03, -6.9298e-03, -4.5047e-03,
        -5.4623e-03, -5.0849e-03, -3.9465e-03,  3.4542e-03, -6.0171e-03,
        -4.3512e-03, -5.6235e-03, -1.4129e-03, -6.0365e-03, -3.5568e-04,
        -6.3084e-03, -1.1973e-02, -1.1377e-02, -1.1139e-02, -1.1717e-02,
        -1.0504e-02, -1.1756e-02, -1.1936e-02, -8.2324e-03, -9.6364e-03,
        -1.2163e-02, -7.7411e-03, -9.8697e-03, -1.1011e-02, -1.2520e-02,
        -1.2112e-02, -1.0588e-02, -1.1657e-02, -1.1906e-02, -1.1402e-02,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
       device='cuda:0', requires_grad=True)
Incremental num : 4
=== Epoch: 0 ===
100% 14/14 [00:07<00:00,  1.97it/s]
Avg Train Loss: 4.4771396432604105, Avg Train Acc: 0.28627232142857145
100% 2/2 [00:00<00:00, 26.92it/s]
Avg Val Loss: 2.6442078351974487, Avg Val Acc: 0.4353794753551483 (Best: 0.91796875)
=== Epoch: 1 ===
100% 14/14 [00:06<00:00,  2.00it/s]
Avg Train Loss: 4.458105904715402, Avg Train Acc: 0.29017857142857145
100% 2/2 [00:00<00:00, 30.83it/s]
Avg Val Loss: 2.6286216974258423, Avg Val Acc: 0.42500001192092896 (Best: 0.91796875)
=== Epoch: 2 ===
100% 14/14 [00:07<00:00,  2.00it/s]
Avg Train Loss: 4.48383229119437, Avg Train Acc: 0.29185267857142855
100% 2/2 [00:00<00:00, 30.76it/s]
Avg Val Loss: 2.6094948649406433, Avg Val Acc: 0.42304688692092896 (Best: 0.91796875)
=== Epoch: 3 ===
100% 14/14 [00:07<00:00,  1.99it/s]
Avg Train Loss: 4.457075868334089, Avg Train Acc: 0.30440848214285715
100% 2/2 [00:00<00:00, 30.38it/s]
Avg Val Loss: 2.605129301548004, Avg Val Acc: 0.41914063692092896 (Best: 0.91796875)
=== Epoch: 4 ===
100% 14/14 [00:06<00:00,  2.01it/s]
Avg Train Loss: 4.397313015801566, Avg Train Acc: 0.30775669642857145
100% 2/2 [00:00<00:00, 30.86it/s]
Avg Val Loss: 2.5871809124946594, Avg Val Acc: 0.42109376192092896 (Best: 0.91796875)
=== Epoch: 5 ===
100% 14/14 [00:06<00:00,  2.02it/s]
Avg Train Loss: 4.395193951470511, Avg Train Acc: 0.30580357142857145
100% 2/2 [00:00<00:00, 30.66it/s]
Avg Val Loss: 2.574189007282257, Avg Val Acc: 0.42500001192092896 (Best: 0.91796875)
=== Epoch: 6 ===
100% 14/14 [00:06<00:00,  2.00it/s]
Avg Train Loss: 4.3649195943559915, Avg Train Acc: 0.3002232142857143
100% 2/2 [00:00<00:00, 31.07it/s]
Avg Val Loss: 2.5713197588920593, Avg Val Acc: 0.42695313692092896 (Best: 0.91796875)
=== Epoch: 7 ===
100% 14/14 [00:06<00:00,  2.01it/s]
Avg Train Loss: 4.37404499735151, Avg Train Acc: 0.314453125
100% 2/2 [00:00<00:00, 30.10it/s]
Avg Val Loss: 2.53450870513916, Avg Val Acc: 0.42890626192092896 (Best: 0.91796875)
=== Epoch: 8 ===
100% 14/14 [00:06<00:00,  2.00it/s]
Avg Train Loss: 4.375655003956386, Avg Train Acc: 0.30970982142857145
100% 2/2 [00:00<00:00, 30.34it/s]
Avg Val Loss: 2.52914035320282, Avg Val Acc: 0.43281251192092896 (Best: 0.91796875)
=== Epoch: 9 ===
100% 14/14 [00:06<00:00,  2.01it/s]
Avg Train Loss: 4.3513467993055075, Avg Train Acc: 0.30859375
100% 2/2 [00:00<00:00, 26.58it/s]
Avg Val Loss: 2.5181907415390015, Avg Val Acc: 0.43085938692092896 (Best: 0.91796875)
=== Epoch: 10 ===
100% 14/14 [00:07<00:00,  1.96it/s]
Avg Train Loss: 4.375402552740915, Avg Train Acc: 0.306640625
100% 2/2 [00:00<00:00, 30.87it/s]
Avg Val Loss: 2.489126980304718, Avg Val Acc: 0.4555245637893677 (Best: 0.91796875)
=== Epoch: 11 ===
100% 14/14 [00:06<00:00,  2.02it/s]
Avg Train Loss: 4.340840714318412, Avg Train Acc: 0.3111049107142857
100% 2/2 [00:00<00:00, 30.77it/s]
Avg Val Loss: 2.501393735408783, Avg Val Acc: 0.43281251192092896 (Best: 0.91796875)
=== Epoch: 12 ===
100% 14/14 [00:06<00:00,  2.01it/s]
Avg Train Loss: 4.320196798869541, Avg Train Acc: 0.31222098214285715
100% 2/2 [00:00<00:00, 28.74it/s]
Avg Val Loss: 2.472901463508606, Avg Val Acc: 0.4672433137893677 (Best: 0.91796875)
=== Epoch: 13 ===
100% 14/14 [00:07<00:00,  2.00it/s]
Avg Train Loss: 4.295347707612174, Avg Train Acc: 0.31724330357142855
100% 2/2 [00:00<00:00, 31.32it/s]
Avg Val Loss: 2.4828256964683533, Avg Val Acc: 0.4652901887893677 (Best: 0.91796875)
=== Epoch: 14 ===
100% 14/14 [00:07<00:00,  2.00it/s]
Avg Train Loss: 4.314812592097691, Avg Train Acc: 0.3169642857142857
100% 2/2 [00:00<00:00, 30.17it/s]
Avg Val Loss: 2.4671652913093567, Avg Val Acc: 0.4672433137893677 (Best: 0.91796875)
=== Epoch: 15 ===
100% 14/14 [00:07<00:00,  1.98it/s]
Avg Train Loss: 4.328943252563477, Avg Train Acc: 0.31808035714285715
100% 2/2 [00:00<00:00, 26.48it/s]
Avg Val Loss: 2.487901449203491, Avg Val Acc: 0.4490513503551483 (Best: 0.91796875)
=== Epoch: 16 ===
100% 14/14 [00:07<00:00,  1.98it/s]
Avg Train Loss: 4.307131017957415, Avg Train Acc: 0.32589285714285715
100% 2/2 [00:00<00:00, 31.23it/s]
Avg Val Loss: 2.449824810028076, Avg Val Acc: 0.4711495637893677 (Best: 0.91796875)
=== Epoch: 17 ===
100% 14/14 [00:06<00:00,  2.02it/s]
Avg Train Loss: 4.324904646192278, Avg Train Acc: 0.3306361607142857
100% 2/2 [00:00<00:00, 30.18it/s]
Avg Val Loss: 2.449777901172638, Avg Val Acc: 0.4652901887893677 (Best: 0.91796875)
=== Epoch: 18 ===
100% 14/14 [00:06<00:00,  2.01it/s]
Avg Train Loss: 4.296919856752668, Avg Train Acc: 0.32645089285714285
100% 2/2 [00:00<00:00, 31.09it/s]
Avg Val Loss: 2.442093014717102, Avg Val Acc: 0.4750558137893677 (Best: 0.91796875)
=== Epoch: 19 ===
100% 14/14 [00:06<00:00,  2.02it/s]
Avg Train Loss: 4.291869606290545, Avg Train Acc: 0.31752232142857145
100% 2/2 [00:00<00:00, 31.48it/s]
Avg Val Loss: 2.4321826100349426, Avg Val Acc: 0.48348215222358704 (Best: 0.91796875)
=== Epoch: 20 ===
100% 14/14 [00:06<00:00,  2.03it/s]
Avg Train Loss: 4.310486452920096, Avg Train Acc: 0.3267299107142857
100% 2/2 [00:00<00:00, 31.08it/s]
Avg Val Loss: 2.4177412390708923, Avg Val Acc: 0.49324777722358704 (Best: 0.91796875)
=== Epoch: 21 ===
100% 14/14 [00:06<00:00,  2.02it/s]
Avg Train Loss: 4.288125276565552, Avg Train Acc: 0.31640625
100% 2/2 [00:00<00:00, 27.43it/s]
Avg Val Loss: 2.413646161556244, Avg Val Acc: 0.49715402722358704 (Best: 0.91796875)
=== Epoch: 22 ===
100% 14/14 [00:06<00:00,  2.01it/s]
Avg Train Loss: 4.267169305256435, Avg Train Acc: 0.328125
100% 2/2 [00:00<00:00, 31.16it/s]
Avg Val Loss: 2.416473150253296, Avg Val Acc: 0.48738840222358704 (Best: 0.91796875)
=== Epoch: 23 ===
100% 14/14 [00:06<00:00,  2.02it/s]
Avg Train Loss: 4.288881063461304, Avg Train Acc: 0.32198660714285715
100% 2/2 [00:00<00:00, 30.69it/s]
Avg Val Loss: 2.422415018081665, Avg Val Acc: 0.4705357253551483 (Best: 0.91796875)
=== Epoch: 24 ===
100% 14/14 [00:07<00:00,  1.99it/s]
Avg Train Loss: 4.276245730263846, Avg Train Acc: 0.3228236607142857
100% 2/2 [00:00<00:00, 30.76it/s]
Avg Val Loss: 2.413011610507965, Avg Val Acc: 0.49324777722358704 (Best: 0.91796875)
=== Epoch: 25 ===
100% 14/14 [00:06<00:00,  2.02it/s]
Avg Train Loss: 4.252835886819022, Avg Train Acc: 0.3306361607142857
100% 2/2 [00:00<00:00, 30.28it/s]
Avg Val Loss: 2.3803245425224304, Avg Val Acc: 0.5257254540920258 (Best: 0.91796875)
=== Epoch: 26 ===
100% 14/14 [00:06<00:00,  2.02it/s]
Avg Train Loss: 4.2598393985203336, Avg Train Acc: 0.32449776785714285
100% 2/2 [00:00<00:00, 30.84it/s]
Avg Val Loss: 2.3895976543426514, Avg Val Acc: 0.49910715222358704 (Best: 0.91796875)
=== Epoch: 27 ===
100% 14/14 [00:07<00:00,  1.99it/s]
Avg Train Loss: 4.249075855527606, Avg Train Acc: 0.322265625
100% 2/2 [00:00<00:00, 30.30it/s]
Avg Val Loss: 2.366277039051056, Avg Val Acc: 0.5133928656578064 (Best: 0.91796875)
=== Epoch: 28 ===
100% 14/14 [00:06<00:00,  2.02it/s]
Avg Train Loss: 4.249300684247698, Avg Train Acc: 0.3158482142857143
100% 2/2 [00:00<00:00, 31.33it/s]
Avg Val Loss: 2.3876399993896484, Avg Val Acc: 0.49910715222358704 (Best: 0.91796875)
=== Epoch: 29 ===
100% 14/14 [00:06<00:00,  2.01it/s]
Avg Train Loss: 4.229924133845738, Avg Train Acc: 0.32393973214285715
100% 2/2 [00:00<00:00, 30.84it/s]
Avg Val Loss: 2.355446457862854, Avg Val Acc: 0.5296317040920258 (Best: 0.91796875)
=== Epoch: 30 ===
100% 14/14 [00:06<00:00,  2.01it/s]
Avg Train Loss: 4.253420625414167, Avg Train Acc: 0.3306361607142857
100% 2/2 [00:00<00:00, 30.99it/s]
Avg Val Loss: 2.3526803851127625, Avg Val Acc: 0.5218192040920258 (Best: 0.91796875)
=== Epoch: 31 ===
100% 14/14 [00:06<00:00,  2.01it/s]
Avg Train Loss: 4.276988165719168, Avg Train Acc: 0.33510044642857145
100% 2/2 [00:00<00:00, 29.94it/s]
Avg Val Loss: 2.3696922063827515, Avg Val Acc: 0.504966527223587 (Best: 0.91796875)
=== Epoch: 32 ===
100% 14/14 [00:06<00:00,  2.00it/s]
Avg Train Loss: 4.230056524276733, Avg Train Acc: 0.3295200892857143
100% 2/2 [00:00<00:00, 29.42it/s]
Avg Val Loss: 2.348581552505493, Avg Val Acc: 0.49910715222358704 (Best: 0.91796875)
=== Epoch: 33 ===
100% 14/14 [00:07<00:00,  1.99it/s]
Avg Train Loss: 4.255439077104841, Avg Train Acc: 0.3295200892857143
100% 2/2 [00:00<00:00, 30.53it/s]
Avg Val Loss: 2.3690661191940308, Avg Val Acc: 0.49715402722358704 (Best: 0.91796875)
=== Epoch: 34 ===
100% 14/14 [00:07<00:00,  1.98it/s]
Avg Train Loss: 4.246473108019147, Avg Train Acc: 0.32924107142857145
100% 2/2 [00:00<00:00, 31.10it/s]
Avg Val Loss: 2.3220136165618896, Avg Val Acc: 0.5374442040920258 (Best: 0.91796875)
=== Epoch: 35 ===
100% 14/14 [00:07<00:00,  1.98it/s]
Avg Train Loss: 4.235187292098999, Avg Train Acc: 0.33119419642857145
100% 2/2 [00:00<00:00, 31.28it/s]
Avg Val Loss: 2.3711525201797485, Avg Val Acc: 0.501060277223587 (Best: 0.91796875)
=== Epoch: 36 ===
100% 14/14 [00:06<00:00,  2.02it/s]
Avg Train Loss: 4.261363540376935, Avg Train Acc: 0.3334263392857143
100% 2/2 [00:00<00:00, 31.25it/s]
Avg Val Loss: 2.330931067466736, Avg Val Acc: 0.501060277223587 (Best: 0.91796875)
=== Epoch: 37 ===
100% 14/14 [00:06<00:00,  2.03it/s]
Avg Train Loss: 4.2167819908687045, Avg Train Acc: 0.341796875
100% 2/2 [00:00<00:00, 30.05it/s]
Avg Val Loss: 2.3469932675361633, Avg Val Acc: 0.503013402223587 (Best: 0.91796875)
=== Epoch: 38 ===
100% 14/14 [00:07<00:00,  2.00it/s]
Avg Train Loss: 4.23169435773577, Avg Train Acc: 0.34207589285714285
100% 2/2 [00:00<00:00, 30.87it/s]
Avg Val Loss: 2.3059364557266235, Avg Val Acc: 0.5536830425262451 (Best: 0.91796875)
=== Epoch: 39 ===
100% 14/14 [00:06<00:00,  2.02it/s]
Avg Train Loss: 4.198502608707973, Avg Train Acc: 0.34095982142857145
100% 2/2 [00:00<00:00, 31.17it/s]
Avg Val Loss: 2.34359073638916, Avg Val Acc: 0.5296317040920258 (Best: 0.91796875)
=== Epoch: 40 ===
100% 14/14 [00:06<00:00,  2.03it/s]
Avg Train Loss: 4.218198367527553, Avg Train Acc: 0.3384486607142857
100% 2/2 [00:00<00:00, 31.56it/s]
Avg Val Loss: 2.339763045310974, Avg Val Acc: 0.504966527223587 (Best: 0.91796875)
=== Epoch: 41 ===
100% 14/14 [00:06<00:00,  2.03it/s]
Avg Train Loss: 4.225561141967773, Avg Train Acc: 0.32924107142857145
100% 2/2 [00:00<00:00, 27.85it/s]
Avg Val Loss: 2.344354033470154, Avg Val Acc: 0.5114397406578064 (Best: 0.91796875)
=== Epoch: 42 ===
100% 14/14 [00:06<00:00,  2.02it/s]
Avg Train Loss: 4.239196062088013, Avg Train Acc: 0.32589285714285715
100% 2/2 [00:00<00:00, 27.83it/s]
Avg Val Loss: 2.3407430052757263, Avg Val Acc: 0.503013402223587 (Best: 0.91796875)
=== Epoch: 43 ===
100% 14/14 [00:07<00:00,  1.99it/s]
Avg Train Loss: 4.194407905851092, Avg Train Acc: 0.33761160714285715
100% 2/2 [00:00<00:00, 30.67it/s]
Avg Val Loss: 2.311224937438965, Avg Val Acc: 0.5315848290920258 (Best: 0.91796875)
=== Epoch: 44 ===
100% 14/14 [00:06<00:00,  2.01it/s]
Avg Train Loss: 4.230822052274432, Avg Train Acc: 0.32979910714285715
100% 2/2 [00:00<00:00, 27.37it/s]
Avg Val Loss: 2.2944472432136536, Avg Val Acc: 0.5497767925262451 (Best: 0.91796875)
=== Epoch: 45 ===
100% 14/14 [00:06<00:00,  2.01it/s]
Avg Train Loss: 4.233162505286081, Avg Train Acc: 0.33816964285714285
100% 2/2 [00:00<00:00, 28.79it/s]
Avg Val Loss: 2.3372676372528076, Avg Val Acc: 0.49715402722358704 (Best: 0.91796875)
=== Epoch: 46 ===
100% 14/14 [00:06<00:00,  2.01it/s]
Compute NCM
Avg Train Loss: 4.254557166780744, Avg Train Acc: 0.337890625
100% 2/2 [00:00<00:00, 28.84it/s]
Avg Val Loss: 2.301341235637665, Avg Val Acc: 0.5172991156578064 (Best: 0.91796875)
100% 14/14 [00:00<00:00, 14.75it/s]
100% 14/14 [00:00<00:00, 14.81it/s]
100% 14/14 [00:00<00:00, 14.41it/s]
torch.Size([100, 64])
Testing with last model..
100% 20/20 [00:02<00:00,  9.42it/s]
100% 20/20 [00:02<00:00,  9.29it/s]
100% 20/20 [00:02<00:00,  9.42it/s]
100% 20/20 [00:02<00:00,  9.38it/s]
100% 20/20 [00:02<00:00,  9.35it/s]
100% 20/20 [00:02<00:00,  9.28it/s]
100% 20/20 [00:02<00:00,  9.10it/s]
100% 20/20 [00:02<00:00,  9.31it/s]
100% 20/20 [00:02<00:00,  9.00it/s]
100% 20/20 [00:02<00:00,  9.28it/s]
Test Acc: 0.15075539983808994
Test Acc: [[0.1387], [0.1328], [0.1621], [0.1758], [0.1426], [0.1504], [0.1426], [0.1387], [0.1445], [0.1387], [0.1445], [0.1582], [0.1699], [0.1562], [0.1367], [0.166], [0.1797], [0.1309], [0.1504], [0.1618]]
0 Parameter containing:
tensor([0.9999, 0.9994, 0.9998, 1.0003, 1.0010, 1.0009, 0.9984, 0.9995, 1.0001,
        1.0009, 1.0019, 0.9991, 0.9994, 1.0004, 1.0021, 0.9994, 0.9994, 0.9993,
        1.0004, 1.0005, 0.9999, 0.9978, 1.0007, 1.0028, 0.9989, 1.0013, 1.0004,
        1.0041, 0.9985, 0.9990, 0.9994, 1.0010, 1.0029, 0.9978, 1.0001, 1.0001,
        1.0002, 0.9976, 1.0002, 0.9962, 0.9945, 0.9964, 0.9973, 0.9971, 0.9965,
        0.9951, 0.9960, 0.9942, 0.9935, 0.9960, 0.9947, 0.9951, 0.9976, 1.0028,
        0.9944, 0.9963, 0.9953, 0.9994, 0.9947, 1.0014, 0.9947, 0.9863, 0.9870,
        0.9887, 0.9859, 0.9895, 0.9862, 0.9855, 0.9989, 0.9898, 0.9853, 0.9917,
        0.9903, 0.9882, 0.9857, 0.9860, 0.9900, 0.9860, 0.9854, 0.9874, 0.9846,
        0.9828, 0.9830, 0.9823, 0.9843, 0.9840, 0.9829, 0.9856, 0.9828, 0.9821,
        0.9840, 0.9852, 0.9820, 0.9842, 0.9828, 0.9836, 0.9828, 0.9836, 0.9826,
        0.9835], device='cuda:0', requires_grad=True) Parameter containing:
tensor([-4.7710e-04, -9.9845e-04,  3.7784e-04, -3.2921e-04,  6.3980e-04,
         6.2599e-04, -1.8433e-03, -5.4085e-04, -5.4829e-04,  6.2454e-04,
         1.8521e-03, -6.6270e-04, -1.0721e-03,  1.5709e-04,  1.2804e-03,
        -1.2528e-03, -1.0106e-03, -1.0162e-03,  1.3255e-03,  8.0478e-04,
        -1.0670e-03, -3.6781e-03,  7.2671e-04,  2.7656e-03, -2.0318e-03,
         9.0919e-04, -2.9800e-04,  3.7071e-03, -2.0532e-03, -1.9563e-03,
        -1.2292e-03,  4.5779e-05,  2.6442e-03, -3.0860e-03, -2.5202e-04,
        -5.7893e-04, -1.7688e-03, -2.9132e-03,  5.1553e-04, -3.8036e-03,
        -5.8343e-03, -5.0211e-03, -3.7054e-03, -4.8541e-03, -3.9785e-03,
        -4.7250e-03, -4.8821e-03, -5.6736e-03, -6.9811e-03, -4.5347e-03,
        -5.4944e-03, -5.1281e-03, -3.9808e-03,  3.4765e-03, -6.0588e-03,
        -4.3842e-03, -5.6671e-03, -1.4410e-03, -6.0839e-03, -3.6042e-04,
        -8.2712e-03, -1.4895e-02, -1.4218e-02, -1.4295e-02, -1.4865e-02,
        -1.3437e-02, -1.4872e-02, -1.4993e-02, -9.9740e-03, -1.2144e-02,
        -1.5396e-02, -9.2701e-03, -1.2364e-02, -1.3652e-02, -1.5731e-02,
        -1.5077e-02, -1.3199e-02, -1.4780e-02, -1.4931e-02, -1.4067e-02,
        -1.7597e-02, -1.8068e-02, -1.7558e-02, -1.8376e-02, -1.6526e-02,
        -1.7126e-02, -1.7910e-02, -1.6131e-02, -1.7619e-02, -1.8363e-02,
        -1.7125e-02, -1.7073e-02, -1.8404e-02, -1.7301e-02, -1.7716e-02,
        -1.7340e-02, -1.8084e-02, -1.7244e-02, -1.8101e-02, -1.7183e-02],
       device='cuda:0', requires_grad=True)
----------train finished----------