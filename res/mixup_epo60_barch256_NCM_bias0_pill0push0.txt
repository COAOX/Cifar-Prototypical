dataset size i: 0 , len: 3436
dataset size i: 1 , len: 3342
dataset size i: 2 , len: 3419
dataset size i: 3 , len: 3369
dataset size i: 4 , len: 3430
Incremental num : 0
=== Epoch: 0 ===
  0% 0/14 [00:00<?, ?it/s]/pytorch/aten/src/ATen/native/TensorFactories.cpp:361: UserWarning: Deprecation warning: In a future PyTorch release torch.full will no longer return tensors of floating dtype by default. Instead, a bool fill_value will return a tensor of torch.bool dtype, and an integral fill_value will return a tensor of torch.long dtype. Set the optional `dtype` or `out` arguments to suppress this warning.
100% 14/14 [00:01<00:00, 10.58it/s]
Avg Train Loss: 2.7326535837990895, Avg Train Acc: 0.25279017857142855
100% 2/2 [00:00<00:00, 26.64it/s]
Avg Val Loss: 2.365348219871521, Avg Val Acc: 0.34108664095401764 (Best)
=== Epoch: 1 ===
100% 14/14 [00:01<00:00, 11.05it/s]
Avg Train Loss: 2.576782328741891, Avg Train Acc: 0.28487723214285715
100% 2/2 [00:00<00:00, 24.60it/s]
Avg Val Loss: 2.111674189567566, Avg Val Acc: 0.34907670319080353 (Best)
=== Epoch: 2 ===
100% 14/14 [00:01<00:00, 11.03it/s]
Avg Train Loss: 2.4643561158861433, Avg Train Acc: 0.31138392857142855
100% 2/2 [00:00<00:00, 26.04it/s]
Avg Val Loss: 2.037489950656891, Avg Val Acc: 0.4312855005264282 (Best)
=== Epoch: 3 ===
100% 14/14 [00:01<00:00, 10.90it/s]
Avg Train Loss: 2.333917737007141, Avg Train Acc: 0.337890625
100% 2/2 [00:00<00:00, 26.03it/s]
Avg Val Loss: 1.9093112349510193, Avg Val Acc: 0.44140625 (Best)
=== Epoch: 4 ===
100% 14/14 [00:01<00:00, 10.88it/s]
Avg Train Loss: 2.2688137803758894, Avg Train Acc: 0.37611607142857145
100% 2/2 [00:00<00:00, 25.24it/s]
Avg Val Loss: 1.8897258043289185, Avg Val Acc: 0.46750709414482117 (Best)
=== Epoch: 5 ===
100% 14/14 [00:01<00:00, 10.92it/s]
Avg Train Loss: 2.2547274998256137, Avg Train Acc: 0.37025669642857145
100% 2/2 [00:00<00:00, 26.58it/s]
Avg Val Loss: 1.7405068278312683, Avg Val Acc: 0.4964488744735718 (Best)
=== Epoch: 6 ===
100% 14/14 [00:01<00:00, 10.97it/s]
Avg Train Loss: 2.2041039637156894, Avg Train Acc: 0.38755580357142855
100% 2/2 [00:00<00:00, 25.10it/s]
Avg Val Loss: 1.6935858726501465, Avg Val Acc: 0.4786931872367859 (Best: 0.4964488744735718)
=== Epoch: 7 ===
100% 14/14 [00:01<00:00, 10.91it/s]
Avg Train Loss: 2.1786834001541138, Avg Train Acc: 0.3822544642857143
100% 2/2 [00:00<00:00, 24.08it/s]
Avg Val Loss: 1.6537333130836487, Avg Val Acc: 0.521484375 (Best)
=== Epoch: 8 ===
100% 14/14 [00:01<00:00, 10.67it/s]
Avg Train Loss: 2.0642648254122054, Avg Train Acc: 0.42215401785714285
100% 2/2 [00:00<00:00, 26.31it/s]
Avg Val Loss: 1.614124059677124, Avg Val Acc: 0.5193536877632141 (Best: 0.521484375)
=== Epoch: 9 ===
100% 14/14 [00:01<00:00, 10.86it/s]
Avg Train Loss: 2.0337811963898793, Avg Train Acc: 0.43470982142857145
100% 2/2 [00:00<00:00, 26.49it/s]
Avg Val Loss: 1.3663045763969421, Avg Val Acc: 0.6019176244735718 (Best)
=== Epoch: 10 ===
100% 14/14 [00:01<00:00, 11.10it/s]
Avg Train Loss: 2.029979373727526, Avg Train Acc: 0.4296875
100% 2/2 [00:00<00:00, 26.97it/s]
Avg Val Loss: 1.4337146878242493, Avg Val Acc: 0.5676491558551788 (Best: 0.6019176244735718)
=== Epoch: 11 ===
100% 14/14 [00:01<00:00, 11.31it/s]
Avg Train Loss: 1.9642648186002458, Avg Train Acc: 0.44308035714285715
100% 2/2 [00:00<00:00, 25.02it/s]
Avg Val Loss: 1.3851627707481384, Avg Val Acc: 0.6020951569080353 (Best)
=== Epoch: 12 ===
100% 14/14 [00:01<00:00, 10.89it/s]
Avg Train Loss: 1.9004908118929182, Avg Train Acc: 0.4693080357142857
100% 2/2 [00:00<00:00, 27.27it/s]
Avg Val Loss: 1.4109255075454712, Avg Val Acc: 0.5930397808551788 (Best: 0.6020951569080353)
=== Epoch: 13 ===
100% 14/14 [00:01<00:00, 11.14it/s]
Avg Train Loss: 1.8686411380767822, Avg Train Acc: 0.47544642857142855
100% 2/2 [00:00<00:00, 26.44it/s]
Avg Val Loss: 1.2288063764572144, Avg Val Acc: 0.6468394994735718 (Best)
=== Epoch: 14 ===
100% 14/14 [00:01<00:00, 11.22it/s]
Avg Train Loss: 1.822910521711622, Avg Train Acc: 0.4790736607142857
100% 2/2 [00:00<00:00, 25.01it/s]
Avg Val Loss: 1.258537471294403, Avg Val Acc: 0.6214488744735718 (Best: 0.6468394994735718)
=== Epoch: 15 ===
100% 14/14 [00:01<00:00, 10.48it/s]
Avg Train Loss: 1.7564374123300825, Avg Train Acc: 0.5111607142857143
100% 2/2 [00:00<00:00, 26.16it/s]
Avg Val Loss: 1.113749235868454, Avg Val Acc: 0.6848366558551788 (Best)
=== Epoch: 16 ===
100% 14/14 [00:01<00:00, 11.03it/s]
Avg Train Loss: 1.7371874962534224, Avg Train Acc: 0.5008370535714286
100% 2/2 [00:00<00:00, 25.87it/s]
Avg Val Loss: 1.1731466352939606, Avg Val Acc: 0.66015625 (Best: 0.6848366558551788)
=== Epoch: 17 ===
100% 14/14 [00:01<00:00, 11.23it/s]
Avg Train Loss: 1.6956818444388253, Avg Train Acc: 0.5139508928571429
100% 2/2 [00:00<00:00, 26.35it/s]
Avg Val Loss: 0.9943312108516693, Avg Val Acc: 0.6889204680919647 (Best)
=== Epoch: 18 ===
100% 14/14 [00:01<00:00, 10.83it/s]
Avg Train Loss: 1.630913930279868, Avg Train Acc: 0.5290178571428571
100% 2/2 [00:00<00:00, 26.78it/s]
Avg Val Loss: 1.0112966299057007, Avg Val Acc: 0.6988636255264282 (Best)
=== Epoch: 19 ===
100% 14/14 [00:01<00:00, 11.15it/s]
Avg Train Loss: 1.6174186979021346, Avg Train Acc: 0.5323660714285714
100% 2/2 [00:00<00:00, 25.10it/s]
Avg Val Loss: 0.9195765852928162, Avg Val Acc: 0.7217684686183929 (Best)
=== Epoch: 20 ===
100% 14/14 [00:01<00:00, 11.25it/s]
Avg Train Loss: 1.5259509682655334, Avg Train Acc: 0.5616629464285714
100% 2/2 [00:00<00:00, 26.86it/s]
Avg Val Loss: 0.8278452754020691, Avg Val Acc: 0.7560369372367859 (Best)
=== Epoch: 21 ===
100% 14/14 [00:01<00:00, 11.07it/s]
Avg Train Loss: 1.5061524510383606, Avg Train Acc: 0.5711495535714286
100% 2/2 [00:00<00:00, 25.50it/s]
Avg Val Loss: 0.7656200528144836, Avg Val Acc: 0.7546164691448212 (Best: 0.7560369372367859)
=== Epoch: 22 ===
100% 14/14 [00:01<00:00, 11.16it/s]
Avg Train Loss: 1.4645527260644096, Avg Train Acc: 0.5823102678571429
100% 2/2 [00:00<00:00, 26.44it/s]
Avg Val Loss: 0.7258370667695999, Avg Val Acc: 0.771484375 (Best)
=== Epoch: 23 ===
100% 14/14 [00:01<00:00, 11.13it/s]
Avg Train Loss: 1.4137216806411743, Avg Train Acc: 0.5970982142857143
100% 2/2 [00:00<00:00, 25.73it/s]
Avg Val Loss: 0.7201056629419327, Avg Val Acc: 0.7485795319080353 (Best: 0.771484375)
=== Epoch: 24 ===
100% 14/14 [00:01<00:00, 10.96it/s]
Avg Train Loss: 1.4079781515257699, Avg Train Acc: 0.5962611607142857
100% 2/2 [00:00<00:00, 25.93it/s]
Avg Val Loss: 0.6726634502410889, Avg Val Acc: 0.7814275622367859 (Best)
=== Epoch: 25 ===
100% 14/14 [00:01<00:00, 11.05it/s]
Avg Train Loss: 1.3815622414861406, Avg Train Acc: 0.6037946428571429
100% 2/2 [00:00<00:00, 26.77it/s]
Avg Val Loss: 0.69783616065979, Avg Val Acc: 0.7778764069080353 (Best: 0.7814275622367859)
=== Epoch: 26 ===
100% 14/14 [00:01<00:00, 10.96it/s]
Avg Train Loss: 1.350866666861943, Avg Train Acc: 0.6096540178571429
100% 2/2 [00:00<00:00, 26.48it/s]
Avg Val Loss: 0.6204791963100433, Avg Val Acc: 0.8064630627632141 (Best)
=== Epoch: 27 ===
100% 14/14 [00:01<00:00, 11.00it/s]
Avg Train Loss: 1.3275972775050573, Avg Train Acc: 0.6071428571428571
100% 2/2 [00:00<00:00, 24.72it/s]
Avg Val Loss: 0.6749876886606216, Avg Val Acc: 0.7950994372367859 (Best: 0.8064630627632141)
=== Epoch: 28 ===
100% 14/14 [00:01<00:00, 10.85it/s]
Avg Train Loss: 1.3202173369271415, Avg Train Acc: 0.6169084821428571
100% 2/2 [00:00<00:00, 26.52it/s]
Avg Val Loss: 0.5999315232038498, Avg Val Acc: 0.8052201569080353 (Best: 0.8064630627632141)
=== Epoch: 29 ===
100% 14/14 [00:01<00:00, 10.89it/s]
Avg Train Loss: 1.3140946626663208, Avg Train Acc: 0.6177455357142857
100% 2/2 [00:00<00:00, 25.59it/s]
Avg Val Loss: 0.5671914517879486, Avg Val Acc: 0.8107244372367859 (Best)
=== Epoch: 30 ===
100% 14/14 [00:01<00:00, 10.60it/s]
Avg Train Loss: 1.2929347668375288, Avg Train Acc: 0.6213727678571429
100% 2/2 [00:00<00:00, 25.39it/s]
Avg Val Loss: 0.5884480178356171, Avg Val Acc: 0.8142755627632141 (Best)
=== Epoch: 31 ===
100% 14/14 [00:01<00:00, 11.29it/s]
Avg Train Loss: 1.2749592321259635, Avg Train Acc: 0.6319754464285714
100% 2/2 [00:00<00:00, 26.69it/s]
Avg Val Loss: 0.5671281218528748, Avg Val Acc: 0.8258167505264282 (Best)
=== Epoch: 32 ===
100% 14/14 [00:01<00:00, 10.98it/s]
Avg Train Loss: 1.2293271933283125, Avg Train Acc: 0.6364397321428571
100% 2/2 [00:00<00:00, 25.76it/s]
Avg Val Loss: 0.5893760621547699, Avg Val Acc: 0.818359375 (Best: 0.8258167505264282)
=== Epoch: 33 ===
100% 14/14 [00:01<00:00, 11.05it/s]
Avg Train Loss: 1.2253297780241286, Avg Train Acc: 0.6434151785714286
100% 2/2 [00:00<00:00, 24.94it/s]
Avg Val Loss: 0.49227534234523773, Avg Val Acc: 0.8510298430919647 (Best)
=== Epoch: 34 ===
100% 14/14 [00:01<00:00, 10.74it/s]
Avg Train Loss: 1.1852599126952035, Avg Train Acc: 0.65625
100% 2/2 [00:00<00:00, 26.66it/s]
Avg Val Loss: 0.5460153818130493, Avg Val Acc: 0.8199573755264282 (Best: 0.8510298430919647)
=== Epoch: 35 ===
100% 14/14 [00:01<00:00, 11.10it/s]
Avg Train Loss: 1.1804765973772322, Avg Train Acc: 0.6568080357142857
100% 2/2 [00:00<00:00, 28.01it/s]
Avg Val Loss: 0.4554196447134018, Avg Val Acc: 0.8584872186183929 (Best)
=== Epoch: 36 ===
100% 14/14 [00:01<00:00, 11.32it/s]
Avg Train Loss: 1.1629485658236913, Avg Train Acc: 0.6615513392857143
100% 2/2 [00:00<00:00, 25.96it/s]
Avg Val Loss: 0.4237155467271805, Avg Val Acc: 0.8647017180919647 (Best)
=== Epoch: 37 ===
100% 14/14 [00:01<00:00, 11.10it/s]
Avg Train Loss: 1.1338964530399867, Avg Train Acc: 0.6743861607142857
100% 2/2 [00:00<00:00, 27.81it/s]
Avg Val Loss: 0.47382277250289917, Avg Val Acc: 0.8394886255264282 (Best: 0.8647017180919647)
=== Epoch: 38 ===
100% 14/14 [00:01<00:00, 11.33it/s]
Avg Train Loss: 1.138454360621316, Avg Train Acc: 0.6727120535714286
100% 2/2 [00:00<00:00, 25.23it/s]
Avg Val Loss: 0.4749455153942108, Avg Val Acc: 0.8377130627632141 (Best: 0.8647017180919647)
=== Epoch: 39 ===
100% 14/14 [00:01<00:00, 11.26it/s]
Avg Train Loss: 1.1475980239255088, Avg Train Acc: 0.6702008928571429
100% 2/2 [00:00<00:00, 28.10it/s]
Avg Val Loss: 0.42099571228027344, Avg Val Acc: 0.8778409063816071 (Best)
=== Epoch: 40 ===
100% 14/14 [00:01<00:00, 11.07it/s]
Avg Train Loss: 1.072564606155668, Avg Train Acc: 0.6833147321428571
100% 2/2 [00:00<00:00, 26.98it/s]
Avg Val Loss: 0.38897696137428284, Avg Val Acc: 0.8741122186183929 (Best: 0.8778409063816071)
=== Epoch: 41 ===
100% 14/14 [00:01<00:00, 11.44it/s]
Avg Train Loss: 1.0483015988554274, Avg Train Acc: 0.6944754464285714
100% 2/2 [00:00<00:00, 25.71it/s]
Avg Val Loss: 0.3571155518293381, Avg Val Acc: 0.8858309686183929 (Best)
=== Epoch: 42 ===
100% 14/14 [00:01<00:00, 11.47it/s]
Avg Train Loss: 1.0180341771670751, Avg Train Acc: 0.7022879464285714
100% 2/2 [00:00<00:00, 26.78it/s]
Avg Val Loss: 0.34225865453481674, Avg Val Acc: 0.8799715936183929 (Best: 0.8858309686183929)
=== Epoch: 43 ===
100% 14/14 [00:01<00:00, 11.09it/s]
Avg Train Loss: 0.9864344469138554, Avg Train Acc: 0.705078125
100% 2/2 [00:00<00:00, 25.27it/s]
Avg Val Loss: 0.33680863678455353, Avg Val Acc: 0.8916903436183929 (Best)
=== Epoch: 44 ===
100% 14/14 [00:01<00:00, 11.28it/s]
Avg Train Loss: 0.9742362669536045, Avg Train Acc: 0.7170758928571429
100% 2/2 [00:00<00:00, 26.94it/s]
Avg Val Loss: 0.31452324241399765, Avg Val Acc: 0.8954190313816071 (Best)
=== Epoch: 45 ===
100% 14/14 [00:01<00:00, 11.12it/s]
Avg Train Loss: 0.9737206186567035, Avg Train Acc: 0.7095424107142857
100% 2/2 [00:00<00:00, 26.26it/s]
Avg Val Loss: 0.3048204779624939, Avg Val Acc: 0.8954190313816071 (Best)
=== Epoch: 46 ===
100% 14/14 [00:01<00:00, 11.07it/s]
Avg Train Loss: 0.949151337146759, Avg Train Acc: 0.7195870535714286
100% 2/2 [00:00<00:00, 23.90it/s]
Avg Val Loss: 0.26231200248003006, Avg Val Acc: 0.9222301244735718 (Best)
=== Epoch: 47 ===
100% 14/14 [00:01<00:00, 11.12it/s]
Avg Train Loss: 0.9353675586836678, Avg Train Acc: 0.7276785714285714
100% 2/2 [00:00<00:00, 26.55it/s]
Avg Val Loss: 0.30416204035282135, Avg Val Acc: 0.9011008441448212 (Best: 0.9222301244735718)
=== Epoch: 48 ===
100% 14/14 [00:01<00:00, 11.08it/s]
Avg Train Loss: 0.9132812576634544, Avg Train Acc: 0.7313058035714286
100% 2/2 [00:00<00:00, 27.14it/s]
Avg Val Loss: 0.27046049386262894, Avg Val Acc: 0.9169034063816071 (Best: 0.9222301244735718)
=== Epoch: 49 ===
100% 14/14 [00:01<00:00, 11.09it/s]
Avg Train Loss: 0.90662311230387, Avg Train Acc: 0.7410714285714286
100% 2/2 [00:00<00:00, 26.52it/s]
Avg Val Loss: 0.2984280437231064, Avg Val Acc: 0.8858309686183929 (Best: 0.9222301244735718)
=== Epoch: 50 ===
100% 14/14 [00:01<00:00, 10.98it/s]
Avg Train Loss: 0.8775071672030857, Avg Train Acc: 0.736328125
100% 2/2 [00:00<00:00, 26.60it/s]
Avg Val Loss: 0.24820773303508759, Avg Val Acc: 0.9206320941448212 (Best: 0.9222301244735718)
=== Epoch: 51 ===
100% 14/14 [00:01<00:00, 11.19it/s]
Avg Train Loss: 0.8788146248885563, Avg Train Acc: 0.7413504464285714
100% 2/2 [00:00<00:00, 26.65it/s]
Avg Val Loss: 0.22680582851171494, Avg Val Acc: 0.9284445941448212 (Best)
=== Epoch: 52 ===
100% 14/14 [00:01<00:00, 11.22it/s]
Avg Train Loss: 0.8807925581932068, Avg Train Acc: 0.7354910714285714
100% 2/2 [00:00<00:00, 27.35it/s]
Avg Val Loss: 0.2712492421269417, Avg Val Acc: 0.9128195941448212 (Best: 0.9284445941448212)
=== Epoch: 53 ===
100% 14/14 [00:01<00:00, 11.24it/s]
Avg Train Loss: 0.9137215869767326, Avg Train Acc: 0.7265625
100% 2/2 [00:00<00:00, 17.48it/s]
Avg Val Loss: 0.25406796485185623, Avg Val Acc: 0.9108664691448212 (Best: 0.9284445941448212)
=== Epoch: 54 ===
100% 14/14 [00:01<00:00, 11.10it/s]
Avg Train Loss: 0.8617578446865082, Avg Train Acc: 0.7385602678571429
100% 2/2 [00:00<00:00, 27.55it/s]
Avg Val Loss: 0.24563656747341156, Avg Val Acc: 0.9167258441448212 (Best: 0.9284445941448212)
=== Epoch: 55 ===
100% 14/14 [00:01<00:00, 11.36it/s]
Avg Train Loss: 0.8804188285555158, Avg Train Acc: 0.7399553571428571
100% 2/2 [00:00<00:00, 25.75it/s]
Avg Val Loss: 0.2798449993133545, Avg Val Acc: 0.9071377813816071 (Best: 0.9284445941448212)
=== Epoch: 56 ===
100% 14/14 [00:01<00:00, 11.04it/s]
Avg Train Loss: 0.855942577123642, Avg Train Acc: 0.7486049107142857
100% 2/2 [00:00<00:00, 24.55it/s]
Avg Val Loss: 0.2457806020975113, Avg Val Acc: 0.9113991558551788 (Best: 0.9284445941448212)
=== Epoch: 57 ===
100% 14/14 [00:01<00:00, 10.78it/s]
Avg Train Loss: 0.8597217202186584, Avg Train Acc: 0.7502790178571429
100% 2/2 [00:00<00:00, 25.78it/s]
Avg Val Loss: 0.24153777956962585, Avg Val Acc: 0.9167258441448212 (Best: 0.9284445941448212)
=== Epoch: 58 ===
100% 14/14 [00:01<00:00, 11.19it/s]
Avg Train Loss: 0.8361689959253583, Avg Train Acc: 0.7550223214285714
100% 2/2 [00:00<00:00, 27.34it/s]
Avg Val Loss: 0.21006527543067932, Avg Val Acc: 0.9323508441448212 (Best)
=== Epoch: 59 ===
100% 14/14 [00:01<00:00, 11.18it/s]
Compute NCM
Avg Train Loss: 0.8262757999556405, Avg Train Acc: 0.7550223214285714
100% 2/2 [00:00<00:00, 27.22it/s]
Avg Val Loss: 0.21201739460229874, Avg Val Acc: 0.9186789691448212 (Best: 0.9323508441448212)
torch.Size([20, 64])
Testing with last model..
100% 4/4 [00:00<00:00,  9.63it/s]
100% 4/4 [00:00<00:00,  9.64it/s]
100% 4/4 [00:00<00:00,  9.72it/s]
100% 4/4 [00:00<00:00,  9.82it/s]
100% 4/4 [00:00<00:00,  9.74it/s]
100% 4/4 [00:00<00:00,  9.80it/s]
100% 4/4 [00:00<00:00,  9.84it/s]
100% 4/4 [00:00<00:00,  9.67it/s]
100% 4/4 [00:00<00:00,  9.42it/s]
100% 4/4 [00:00<00:00,  9.59it/s]
Test Acc: 0.5016971990466118
Test Acc: [[0.5059], [0.5273], [0.5], [0.4698]]
0 Parameter containing:
tensor([[1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]], device='cuda:0',
       requires_grad=True) Parameter containing:
tensor([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0.]], device='cuda:0', requires_grad=True)
Incremental num : 1
=== Epoch: 0 ===
100% 14/14 [00:02<00:00,  5.08it/s]
Avg Train Loss: 7.41873642376491, Avg Train Acc: 0.33286830357142855
100% 2/2 [00:00<00:00, 25.95it/s]
Avg Val Loss: 1.6909540295600891, Avg Val Acc: 0.48449862003326416 (Best: 0.9323508441448212)
=== Epoch: 1 ===
100% 14/14 [00:02<00:00,  5.20it/s]
Avg Train Loss: 6.724846226828439, Avg Train Acc: 0.43136160714285715
100% 2/2 [00:00<00:00, 25.08it/s]
Avg Val Loss: 1.7226277589797974, Avg Val Acc: 0.4625445008277893 (Best: 0.9323508441448212)
=== Epoch: 2 ===
100% 14/14 [00:02<00:00,  5.09it/s]
Avg Train Loss: 6.405050754547119, Avg Train Acc: 0.43917410714285715
100% 2/2 [00:00<00:00, 25.77it/s]
Avg Val Loss: 1.6819025874137878, Avg Val Acc: 0.5073921978473663 (Best: 0.9323508441448212)
=== Epoch: 3 ===
100% 14/14 [00:02<00:00,  5.19it/s]
Avg Train Loss: 6.233134984970093, Avg Train Acc: 0.462890625
100% 2/2 [00:00<00:00, 27.38it/s]
Avg Val Loss: 1.641234040260315, Avg Val Acc: 0.5137213170528412 (Best: 0.9323508441448212)
=== Epoch: 4 ===
100% 14/14 [00:02<00:00,  5.32it/s]
Avg Train Loss: 6.152889592306955, Avg Train Acc: 0.48325892857142855
100% 2/2 [00:00<00:00, 23.73it/s]
Avg Val Loss: 1.5582299828529358, Avg Val Acc: 0.5531793832778931 (Best: 0.9323508441448212)
=== Epoch: 5 ===
100% 14/14 [00:02<00:00,  5.23it/s]
Avg Train Loss: 6.133566924503872, Avg Train Acc: 0.48856026785714285
100% 2/2 [00:00<00:00, 27.87it/s]
Avg Val Loss: 1.5342358946800232, Avg Val Acc: 0.5609918832778931 (Best: 0.9323508441448212)
=== Epoch: 6 ===
100% 14/14 [00:02<00:00,  5.26it/s]
Avg Train Loss: 5.888732433319092, Avg Train Acc: 0.4877232142857143
100% 2/2 [00:00<00:00, 28.14it/s]
Avg Val Loss: 1.5529614686965942, Avg Val Acc: 0.5463805496692657 (Best: 0.9323508441448212)
=== Epoch: 7 ===
100% 14/14 [00:02<00:00,  5.29it/s]
Avg Train Loss: 5.850119045802525, Avg Train Acc: 0.5055803571428571
100% 2/2 [00:00<00:00, 23.94it/s]
Avg Val Loss: 1.5638066530227661, Avg Val Acc: 0.5688043832778931 (Best: 0.9323508441448212)
=== Epoch: 8 ===
100% 14/14 [00:02<00:00,  5.30it/s]
Avg Train Loss: 5.8065341881343295, Avg Train Acc: 0.49693080357142855
100% 2/2 [00:00<00:00, 26.49it/s]
Avg Val Loss: 1.5195542573928833, Avg Val Acc: 0.5449713170528412 (Best: 0.9323508441448212)
=== Epoch: 9 ===
100% 14/14 [00:02<00:00,  5.19it/s]
Avg Train Loss: 5.646476643426078, Avg Train Acc: 0.5209263392857143
100% 2/2 [00:00<00:00, 26.87it/s]
Avg Val Loss: 1.479441523551941, Avg Val Acc: 0.545441061258316 (Best: 0.9323508441448212)
=== Epoch: 10 ===
100% 14/14 [00:02<00:00,  5.25it/s]
Avg Train Loss: 5.451364653451102, Avg Train Acc: 0.5226004464285714
100% 2/2 [00:00<00:00, 25.64it/s]
Avg Val Loss: 1.4716063737869263, Avg Val Acc: 0.5916979908943176 (Best: 0.9323508441448212)
=== Epoch: 11 ===
100% 14/14 [00:02<00:00,  5.26it/s]
Avg Train Loss: 5.60534269469125, Avg Train Acc: 0.5153459821428571
100% 2/2 [00:00<00:00, 26.20it/s]
Avg Val Loss: 1.4700338244438171, Avg Val Acc: 0.5761471390724182 (Best: 0.9323508441448212)
=== Epoch: 12 ===
100% 14/14 [00:02<00:00,  5.19it/s]
Avg Train Loss: 5.52658748626709, Avg Train Acc: 0.5228794642857143
100% 2/2 [00:00<00:00, 24.79it/s]
Avg Val Loss: 1.4395185112953186, Avg Val Acc: 0.5848991274833679 (Best: 0.9323508441448212)
=== Epoch: 13 ===
100% 14/14 [00:02<00:00,  5.23it/s]
Avg Train Loss: 5.527426549366543, Avg Train Acc: 0.5295758928571429
100% 2/2 [00:00<00:00, 27.20it/s]
Avg Val Loss: 1.4069241881370544, Avg Val Acc: 0.5732545554637909 (Best: 0.9323508441448212)
=== Epoch: 14 ===
100% 14/14 [00:02<00:00,  5.33it/s]
Avg Train Loss: 5.358394145965576, Avg Train Acc: 0.5301339285714286
100% 2/2 [00:00<00:00, 25.04it/s]
Avg Val Loss: 1.4075025916099548, Avg Val Acc: 0.5888053774833679 (Best: 0.9323508441448212)
=== Epoch: 15 ===
100% 14/14 [00:02<00:00,  5.28it/s]
Avg Train Loss: 5.346493789127895, Avg Train Acc: 0.54296875
100% 2/2 [00:00<00:00, 26.46it/s]
Avg Val Loss: 1.3615480661392212, Avg Val Acc: 0.6166188716888428 (Best: 0.9323508441448212)
=== Epoch: 16 ===
100% 14/14 [00:02<00:00,  5.25it/s]
Avg Train Loss: 5.094016109194074, Avg Train Acc: 0.5345982142857143
100% 2/2 [00:00<00:00, 27.52it/s]
Avg Val Loss: 1.3972771763801575, Avg Val Acc: 0.5922418832778931 (Best: 0.9323508441448212)
=== Epoch: 17 ===
100% 14/14 [00:02<00:00,  5.30it/s]
Avg Train Loss: 5.140737397330148, Avg Train Acc: 0.5471540178571429
100% 2/2 [00:00<00:00, 26.15it/s]
Avg Val Loss: 1.338771015405655, Avg Val Acc: 0.6166188716888428 (Best: 0.9323508441448212)
=== Epoch: 18 ===
100% 14/14 [00:02<00:00,  5.31it/s]
Avg Train Loss: 5.097965921674456, Avg Train Acc: 0.5426897321428571
100% 2/2 [00:00<00:00, 26.65it/s]
Avg Val Loss: 1.367734432220459, Avg Val Acc: 0.6053698658943176 (Best: 0.9323508441448212)
=== Epoch: 19 ===
100% 14/14 [00:02<00:00,  5.29it/s]
Avg Train Loss: 5.016532284872873, Avg Train Acc: 0.5465959821428571
100% 2/2 [00:00<00:00, 24.87it/s]
Avg Val Loss: 1.3413233160972595, Avg Val Acc: 0.6214646100997925 (Best: 0.9323508441448212)
=== Epoch: 20 ===
100% 14/14 [00:02<00:00,  5.25it/s]
Avg Train Loss: 5.233410494668143, Avg Train Acc: 0.560546875
100% 2/2 [00:00<00:00, 27.66it/s]
Avg Val Loss: 1.3389536440372467, Avg Val Acc: 0.6380290687084198 (Best: 0.9323508441448212)
=== Epoch: 21 ===
100% 14/14 [00:02<00:00,  5.25it/s]
Avg Train Loss: 5.040747846875872, Avg Train Acc: 0.5535714285714286
100% 2/2 [00:00<00:00, 27.28it/s]
Avg Val Loss: 1.314469963312149, Avg Val Acc: 0.621934324502945 (Best: 0.9323508441448212)
=== Epoch: 22 ===
100% 14/14 [00:02<00:00,  5.27it/s]
Avg Train Loss: 4.917151927947998, Avg Train Acc: 0.5538504464285714
100% 2/2 [00:00<00:00, 27.32it/s]
Avg Val Loss: 1.3156923651695251, Avg Val Acc: 0.6351364850997925 (Best: 0.9323508441448212)
=== Epoch: 23 ===
100% 14/14 [00:02<00:00,  5.30it/s]
Avg Train Loss: 4.910065957478115, Avg Train Acc: 0.5686383928571429
100% 2/2 [00:00<00:00, 27.13it/s]
Avg Val Loss: 1.2985894680023193, Avg Val Acc: 0.641465574502945 (Best: 0.9323508441448212)
=== Epoch: 24 ===
100% 14/14 [00:02<00:00,  5.21it/s]
Avg Train Loss: 5.078290598733084, Avg Train Acc: 0.5530133928571429
100% 2/2 [00:00<00:00, 25.16it/s]
Avg Val Loss: 1.293425977230072, Avg Val Acc: 0.6380290687084198 (Best: 0.9323508441448212)
=== Epoch: 25 ===
100% 14/14 [00:02<00:00,  5.29it/s]
Avg Train Loss: 4.910290718078613, Avg Train Acc: 0.5655691964285714
100% 2/2 [00:00<00:00, 28.31it/s]
Avg Val Loss: 1.303430587053299, Avg Val Acc: 0.6351364850997925 (Best: 0.9323508441448212)
=== Epoch: 26 ===
100% 14/14 [00:02<00:00,  5.32it/s]
Avg Train Loss: 4.929828609739031, Avg Train Acc: 0.5728236607142857
100% 2/2 [00:00<00:00, 27.87it/s]
Avg Val Loss: 1.2941306829452515, Avg Val Acc: 0.637559324502945 (Best: 0.9323508441448212)
=== Epoch: 27 ===
100% 14/14 [00:02<00:00,  5.34it/s]
Avg Train Loss: 4.8434790543147495, Avg Train Acc: 0.5633370535714286
100% 2/2 [00:00<00:00, 28.21it/s]
Avg Val Loss: 1.261005938053131, Avg Val Acc: 0.649278074502945 (Best: 0.9323508441448212)
=== Epoch: 28 ===
100% 14/14 [00:02<00:00,  5.31it/s]
Avg Train Loss: 4.834509543010166, Avg Train Acc: 0.5616629464285714
100% 2/2 [00:00<00:00, 28.39it/s]
Avg Val Loss: 1.260948896408081, Avg Val Acc: 0.6536540687084198 (Best: 0.9323508441448212)
=== Epoch: 29 ===
100% 14/14 [00:02<00:00,  5.33it/s]
Avg Train Loss: 5.1561981950487406, Avg Train Acc: 0.5619419642857143
100% 2/2 [00:00<00:00, 24.02it/s]
Avg Val Loss: 1.2630418539047241, Avg Val Acc: 0.6390427350997925 (Best: 0.9323508441448212)
=== Epoch: 30 ===
100% 14/14 [00:02<00:00,  5.31it/s]
Avg Train Loss: 4.83927491733006, Avg Train Acc: 0.564453125
100% 2/2 [00:00<00:00, 26.88it/s]
Avg Val Loss: 1.280866026878357, Avg Val Acc: 0.649278074502945 (Best: 0.9323508441448212)
=== Epoch: 31 ===
100% 14/14 [00:02<00:00,  5.34it/s]
Avg Train Loss: 4.768398829868862, Avg Train Acc: 0.5811941964285714
100% 2/2 [00:00<00:00, 23.15it/s]
Avg Val Loss: 1.292395293712616, Avg Val Acc: 0.6351364850997925 (Best: 0.9323508441448212)
=== Epoch: 32 ===
100% 14/14 [00:02<00:00,  5.35it/s]
Avg Train Loss: 4.71826662336077, Avg Train Acc: 0.5823102678571429
100% 2/2 [00:00<00:00, 26.48it/s]
Avg Val Loss: 1.29099503159523, Avg Val Acc: 0.6380290687084198 (Best: 0.9323508441448212)
=== Epoch: 33 ===
100% 14/14 [00:02<00:00,  5.20it/s]
Avg Train Loss: 4.8523223059518, Avg Train Acc: 0.5650111607142857
100% 2/2 [00:00<00:00, 25.00it/s]
Avg Val Loss: 1.2810110449790955, Avg Val Acc: 0.6497478187084198 (Best: 0.9323508441448212)
=== Epoch: 34 ===
100% 14/14 [00:02<00:00,  5.23it/s]
Avg Train Loss: 4.832837717873709, Avg Train Acc: 0.5705915178571429
100% 2/2 [00:00<00:00, 26.75it/s]
Avg Val Loss: 1.270343393087387, Avg Val Acc: 0.6449021100997925 (Best: 0.9323508441448212)
=== Epoch: 35 ===
100% 14/14 [00:02<00:00,  5.27it/s]
Avg Train Loss: 4.984350885663714, Avg Train Acc: 0.5666852678571429
100% 2/2 [00:00<00:00, 26.21it/s]
Avg Val Loss: 1.26974418759346, Avg Val Acc: 0.6575603187084198 (Best: 0.9323508441448212)
=== Epoch: 36 ===
100% 14/14 [00:02<00:00,  5.24it/s]
Avg Train Loss: 4.620501824787685, Avg Train Acc: 0.5708705357142857
100% 2/2 [00:00<00:00, 27.03it/s]
Avg Val Loss: 1.2836854457855225, Avg Val Acc: 0.6351364850997925 (Best: 0.9323508441448212)
=== Epoch: 37 ===
100% 14/14 [00:02<00:00,  5.35it/s]
Avg Train Loss: 4.9650139808654785, Avg Train Acc: 0.5789620535714286
100% 2/2 [00:00<00:00, 25.88it/s]
Avg Val Loss: 1.2744037210941315, Avg Val Acc: 0.6370896100997925 (Best: 0.9323508441448212)
=== Epoch: 38 ===
100% 14/14 [00:02<00:00,  5.32it/s]
Avg Train Loss: 4.727782930646624, Avg Train Acc: 0.5714285714285714
100% 2/2 [00:00<00:00, 27.38it/s]
Avg Val Loss: 1.253818392753601, Avg Val Acc: 0.639512449502945 (Best: 0.9323508441448212)
=== Epoch: 39 ===
100% 14/14 [00:02<00:00,  5.22it/s]
Avg Train Loss: 4.685450758252825, Avg Train Acc: 0.5756138392857143
100% 2/2 [00:00<00:00, 24.81it/s]
Avg Val Loss: 1.258355289697647, Avg Val Acc: 0.643418699502945 (Best: 0.9323508441448212)
=== Epoch: 40 ===
100% 14/14 [00:02<00:00,  5.29it/s]
Avg Train Loss: 4.578652688435146, Avg Train Acc: 0.5853794642857143
100% 2/2 [00:00<00:00, 24.64it/s]
Avg Val Loss: 1.2721806764602661, Avg Val Acc: 0.6331833600997925 (Best: 0.9323508441448212)
=== Epoch: 41 ===
100% 14/14 [00:02<00:00,  5.28it/s]
Avg Train Loss: 4.728583046368191, Avg Train Acc: 0.5867745535714286
100% 2/2 [00:00<00:00, 26.28it/s]
Avg Val Loss: 1.2650228142738342, Avg Val Acc: 0.6468552350997925 (Best: 0.9323508441448212)
=== Epoch: 42 ===
100% 14/14 [00:02<00:00,  5.33it/s]
Avg Train Loss: 4.579645497458322, Avg Train Acc: 0.5837053571428571
100% 2/2 [00:00<00:00, 26.18it/s]
Avg Val Loss: 1.2276013791561127, Avg Val Acc: 0.6677956879138947 (Best: 0.9323508441448212)
=== Epoch: 43 ===
100% 14/14 [00:02<00:00,  5.33it/s]
Avg Train Loss: 4.572405099868774, Avg Train Acc: 0.5851004464285714
100% 2/2 [00:00<00:00, 27.73it/s]
Avg Val Loss: 1.2471254765987396, Avg Val Acc: 0.647324949502945 (Best: 0.9323508441448212)
=== Epoch: 44 ===
100% 14/14 [00:02<00:00,  5.31it/s]
Avg Train Loss: 4.706129789352417, Avg Train Acc: 0.5915178571428571
100% 2/2 [00:00<00:00, 28.23it/s]
Avg Val Loss: 1.249106764793396, Avg Val Acc: 0.647324949502945 (Best: 0.9323508441448212)
=== Epoch: 45 ===
100% 14/14 [00:02<00:00,  5.19it/s]
Avg Train Loss: 4.642984560557774, Avg Train Acc: 0.5845424107142857
100% 2/2 [00:00<00:00, 25.68it/s]
Avg Val Loss: 1.2442247569561005, Avg Val Acc: 0.6517009437084198 (Best: 0.9323508441448212)
=== Epoch: 46 ===
100% 14/14 [00:02<00:00,  5.26it/s]
Avg Train Loss: 4.426246915544782, Avg Train Acc: 0.5828683035714286
100% 2/2 [00:00<00:00, 28.17it/s]
Avg Val Loss: 1.2488254308700562, Avg Val Acc: 0.643418699502945 (Best: 0.9323508441448212)
=== Epoch: 47 ===
100% 14/14 [00:02<00:00,  5.22it/s]
Avg Train Loss: 4.559100491659982, Avg Train Acc: 0.5867745535714286
100% 2/2 [00:00<00:00, 26.52it/s]
Avg Val Loss: 1.242299199104309, Avg Val Acc: 0.6497478187084198 (Best: 0.9323508441448212)
=== Epoch: 48 ===
100% 14/14 [00:02<00:00,  5.30it/s]
Avg Train Loss: 4.675549711499896, Avg Train Acc: 0.6023995535714286
100% 2/2 [00:00<00:00, 27.51it/s]
Avg Val Loss: 1.2143871784210205, Avg Val Acc: 0.6575603187084198 (Best: 0.9323508441448212)
=== Epoch: 49 ===
100% 14/14 [00:02<00:00,  5.23it/s]
Avg Train Loss: 4.701096977506365, Avg Train Acc: 0.5998883928571429
100% 2/2 [00:00<00:00, 26.61it/s]
Avg Val Loss: 1.2135137915611267, Avg Val Acc: 0.6575603187084198 (Best: 0.9323508441448212)
=== Epoch: 50 ===
100% 14/14 [00:02<00:00,  5.32it/s]
Avg Train Loss: 4.874284097126552, Avg Train Acc: 0.5892857142857143
100% 2/2 [00:00<00:00, 21.69it/s]
Avg Val Loss: 1.2133134603500366, Avg Val Acc: 0.651231199502945 (Best: 0.9323508441448212)
=== Epoch: 51 ===
100% 14/14 [00:02<00:00,  5.32it/s]
Avg Train Loss: 4.602753707340786, Avg Train Acc: 0.5853794642857143
100% 2/2 [00:00<00:00, 27.44it/s]
Avg Val Loss: 1.2110515832901, Avg Val Acc: 0.6599831879138947 (Best: 0.9323508441448212)
=== Epoch: 52 ===
100% 14/14 [00:02<00:00,  5.29it/s]
Avg Train Loss: 4.655962569372995, Avg Train Acc: 0.5823102678571429
100% 2/2 [00:00<00:00, 25.24it/s]
Avg Val Loss: 1.2044842541217804, Avg Val Acc: 0.6653728187084198 (Best: 0.9323508441448212)
=== Epoch: 53 ===
100% 14/14 [00:02<00:00,  5.29it/s]
Avg Train Loss: 4.989756720406668, Avg Train Acc: 0.5912388392857143
100% 2/2 [00:00<00:00, 28.22it/s]
Avg Val Loss: 1.2055765986442566, Avg Val Acc: 0.6468552350997925 (Best: 0.9323508441448212)
=== Epoch: 54 ===
100% 14/14 [00:02<00:00,  5.28it/s]
Compute NCM
Avg Train Loss: 4.517750603812082, Avg Train Acc: 0.5965401785714286
100% 2/2 [00:00<00:00, 26.44it/s]
Avg Val Loss: 1.1429079473018646, Avg Val Acc: 0.6838904321193695 (Best: 0.9323508441448212)
torch.Size([40, 64])
Testing with last model..
100% 8/8 [00:00<00:00,  9.63it/s]
100% 8/8 [00:00<00:00,  9.40it/s]
100% 8/8 [00:00<00:00,  9.42it/s]
100% 8/8 [00:00<00:00,  9.68it/s]
100% 8/8 [00:00<00:00,  9.39it/s]
100% 8/8 [00:00<00:00,  9.59it/s]
100% 8/8 [00:00<00:00,  9.13it/s]
100% 8/8 [00:00<00:00,  8.62it/s]
100% 8/8 [00:00<00:00,  8.97it/s]
100% 8/8 [00:00<00:00,  9.45it/s]
Test Acc: 0.24564678501337767
Test Acc: [[0.2695], [0.248], [0.2559], [0.2461], [0.2168], [0.2266], [0.2461], [0.2596]]
0 Parameter containing:
tensor([[1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]], device='cuda:0',
       requires_grad=True) Parameter containing:
tensor([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0.]], device='cuda:0', requires_grad=True)
Incremental num : 2
=== Epoch: 0 ===
100% 14/14 [00:04<00:00,  3.33it/s]
Avg Train Loss: 6.781302077429635, Avg Train Acc: 0.3671875
100% 2/2 [00:00<00:00, 24.60it/s]
Avg Val Loss: 2.3356218934059143, Avg Val Acc: 0.3907158374786377 (Best: 0.9323508441448212)
=== Epoch: 1 ===
100% 14/14 [00:04<00:00,  3.38it/s]
Avg Train Loss: 6.460558618818011, Avg Train Acc: 0.37723214285714285
100% 2/2 [00:00<00:00, 24.49it/s]
Avg Val Loss: 2.2391592860221863, Avg Val Acc: 0.3985283374786377 (Best: 0.9323508441448212)
=== Epoch: 2 ===
100% 14/14 [00:04<00:00,  3.38it/s]
Avg Train Loss: 6.577565908432007, Avg Train Acc: 0.40736607142857145
100% 2/2 [00:00<00:00, 26.02it/s]
Avg Val Loss: 2.121069014072418, Avg Val Acc: 0.43736374378204346 (Best: 0.9323508441448212)
=== Epoch: 3 ===
100% 14/14 [00:04<00:00,  3.35it/s]
Avg Train Loss: 6.446039881025042, Avg Train Acc: 0.41573660714285715
100% 2/2 [00:00<00:00, 26.99it/s]
Avg Val Loss: 2.0523491501808167, Avg Val Acc: 0.47424599528312683 (Best: 0.9323508441448212)
=== Epoch: 4 ===
100% 14/14 [00:04<00:00,  3.39it/s]
Avg Train Loss: 6.439144679478237, Avg Train Acc: 0.42745535714285715
100% 2/2 [00:00<00:00, 25.23it/s]
Avg Val Loss: 2.0149424076080322, Avg Val Acc: 0.46071040630340576 (Best: 0.9323508441448212)
=== Epoch: 5 ===
100% 14/14 [00:04<00:00,  3.36it/s]
Avg Train Loss: 6.161482027598789, Avg Train Acc: 0.44029017857142855
100% 2/2 [00:00<00:00, 26.63it/s]
Avg Val Loss: 1.9954243898391724, Avg Val Acc: 0.4723837077617645 (Best: 0.9323508441448212)
=== Epoch: 6 ===
100% 14/14 [00:04<00:00,  3.37it/s]
Avg Train Loss: 6.292741571153913, Avg Train Acc: 0.4428013392857143
100% 2/2 [00:00<00:00, 25.60it/s]
Avg Val Loss: 1.9840829372406006, Avg Val Acc: 0.4723837077617645 (Best: 0.9323508441448212)
=== Epoch: 7 ===
100% 14/14 [00:04<00:00,  3.30it/s]
Avg Train Loss: 6.21122019631522, Avg Train Acc: 0.4388950892857143
100% 2/2 [00:00<00:00, 25.78it/s]
Avg Val Loss: 1.982664942741394, Avg Val Acc: 0.4723837077617645 (Best: 0.9323508441448212)
=== Epoch: 8 ===
100% 14/14 [00:04<00:00,  3.29it/s]
Avg Train Loss: 6.18977553503854, Avg Train Acc: 0.44503348214285715
100% 2/2 [00:00<00:00, 26.95it/s]
Avg Val Loss: 1.9725265502929688, Avg Val Acc: 0.4821493327617645 (Best: 0.9323508441448212)
=== Epoch: 9 ===
100% 14/14 [00:04<00:00,  3.38it/s]
Avg Train Loss: 6.14929553440639, Avg Train Acc: 0.443359375
100% 2/2 [00:00<00:00, 26.90it/s]
Avg Val Loss: 1.9539024233818054, Avg Val Acc: 0.48596474528312683 (Best: 0.9323508441448212)
=== Epoch: 10 ===
100% 14/14 [00:04<00:00,  3.37it/s]
Avg Train Loss: 6.011390720094953, Avg Train Acc: 0.45926339285714285
100% 2/2 [00:00<00:00, 24.39it/s]
Avg Val Loss: 1.959675669670105, Avg Val Acc: 0.4840570390224457 (Best: 0.9323508441448212)
=== Epoch: 11 ===
100% 14/14 [00:04<00:00,  3.30it/s]
Avg Train Loss: 6.119572162628174, Avg Train Acc: 0.4497767857142857
100% 2/2 [00:00<00:00, 26.62it/s]
Avg Val Loss: 1.9575291872024536, Avg Val Acc: 0.48596474528312683 (Best: 0.9323508441448212)
=== Epoch: 12 ===
100% 14/14 [00:04<00:00,  3.37it/s]
Avg Train Loss: 6.12921278817313, Avg Train Acc: 0.458984375
100% 2/2 [00:00<00:00, 26.86it/s]
Avg Val Loss: 1.9487558603286743, Avg Val Acc: 0.489825576543808 (Best: 0.9323508441448212)
=== Epoch: 13 ===
100% 14/14 [00:04<00:00,  3.37it/s]
Avg Train Loss: 5.996751614979336, Avg Train Acc: 0.4564732142857143
100% 2/2 [00:00<00:00, 26.04it/s]
Avg Val Loss: 1.9319800734519958, Avg Val Acc: 0.5054051578044891 (Best: 0.9323508441448212)
=== Epoch: 14 ===
100% 14/14 [00:04<00:00,  3.33it/s]
Avg Train Loss: 6.0549408708299906, Avg Train Acc: 0.45703125
100% 2/2 [00:00<00:00, 25.37it/s]
Avg Val Loss: 1.9202175736427307, Avg Val Acc: 0.5189861953258514 (Best: 0.9323508441448212)
=== Epoch: 15 ===
100% 14/14 [00:04<00:00,  3.31it/s]
Avg Train Loss: 6.234650714056833, Avg Train Acc: 0.4642857142857143
100% 2/2 [00:00<00:00, 24.52it/s]
Avg Val Loss: 1.9348297119140625, Avg Val Acc: 0.5170784890651703 (Best: 0.9323508441448212)
=== Epoch: 16 ===
100% 14/14 [00:04<00:00,  3.33it/s]
Avg Train Loss: 6.028122935976301, Avg Train Acc: 0.46707589285714285
100% 2/2 [00:00<00:00, 26.64it/s]
Avg Val Loss: 1.922789216041565, Avg Val Acc: 0.5306595265865326 (Best: 0.9323508441448212)
=== Epoch: 17 ===
100% 14/14 [00:04<00:00,  3.36it/s]
Avg Train Loss: 6.1412506103515625, Avg Train Acc: 0.4673549107142857
100% 2/2 [00:00<00:00, 25.82it/s]
Avg Val Loss: 1.9232437014579773, Avg Val Acc: 0.5346111953258514 (Best: 0.9323508441448212)
=== Epoch: 18 ===
100% 14/14 [00:04<00:00,  3.31it/s]
Avg Train Loss: 6.004461867468698, Avg Train Acc: 0.46902901785714285
100% 2/2 [00:00<00:00, 26.48it/s]
Avg Val Loss: 1.914067566394806, Avg Val Acc: 0.5346111953258514 (Best: 0.9323508441448212)
=== Epoch: 19 ===
100% 14/14 [00:04<00:00,  3.37it/s]
Avg Train Loss: 5.933327777045114, Avg Train Acc: 0.4720982142857143
100% 2/2 [00:00<00:00, 27.17it/s]
Avg Val Loss: 1.907953143119812, Avg Val Acc: 0.5384720265865326 (Best: 0.9323508441448212)
=== Epoch: 20 ===
100% 14/14 [00:04<00:00,  3.39it/s]
Avg Train Loss: 5.858941384724209, Avg Train Acc: 0.46791294642857145
100% 2/2 [00:00<00:00, 25.64it/s]
Avg Val Loss: 1.9082170128822327, Avg Val Acc: 0.5268441140651703 (Best: 0.9323508441448212)
=== Epoch: 21 ===
100% 14/14 [00:04<00:00,  3.35it/s]
Avg Train Loss: 6.053087370736258, Avg Train Acc: 0.4693080357142857
100% 2/2 [00:00<00:00, 26.06it/s]
Avg Val Loss: 1.8968754410743713, Avg Val Acc: 0.5346111953258514 (Best: 0.9323508441448212)
=== Epoch: 22 ===
100% 14/14 [00:04<00:00,  3.31it/s]
Avg Train Loss: 5.87924177306039, Avg Train Acc: 0.47544642857142855
100% 2/2 [00:00<00:00, 25.59it/s]
Avg Val Loss: 1.8987287878990173, Avg Val Acc: 0.513263076543808 (Best: 0.9323508441448212)
=== Epoch: 23 ===
100% 14/14 [00:04<00:00,  3.35it/s]
Avg Train Loss: 5.972730466297695, Avg Train Acc: 0.48325892857142855
100% 2/2 [00:00<00:00, 23.90it/s]
Avg Val Loss: 1.898604691028595, Avg Val Acc: 0.5326580703258514 (Best: 0.9323508441448212)
=== Epoch: 24 ===
100% 14/14 [00:04<00:00,  3.36it/s]
Avg Train Loss: 6.05741582598005, Avg Train Acc: 0.4681919642857143
100% 2/2 [00:00<00:00, 26.23it/s]
Avg Val Loss: 1.8789164423942566, Avg Val Acc: 0.5229378640651703 (Best: 0.9323508441448212)
=== Epoch: 25 ===
100% 14/14 [00:04<00:00,  3.37it/s]
Avg Train Loss: 5.718776907239642, Avg Train Acc: 0.48911830357142855
100% 2/2 [00:00<00:00, 25.00it/s]
Avg Val Loss: 1.8891085386276245, Avg Val Acc: 0.5248909890651703 (Best: 0.9323508441448212)
=== Epoch: 26 ===
100% 14/14 [00:04<00:00,  3.31it/s]
Avg Train Loss: 5.910960095269339, Avg Train Acc: 0.47237723214285715
100% 2/2 [00:00<00:00, 27.12it/s]
Avg Val Loss: 1.8823147416114807, Avg Val Acc: 0.5307503640651703 (Best: 0.9323508441448212)
=== Epoch: 27 ===
100% 14/14 [00:04<00:00,  3.30it/s]
Avg Train Loss: 5.871841192245483, Avg Train Acc: 0.482421875
100% 2/2 [00:00<00:00, 25.21it/s]
Avg Val Loss: 1.889640986919403, Avg Val Acc: 0.5229832828044891 (Best: 0.9323508441448212)
=== Epoch: 28 ===
100% 14/14 [00:04<00:00,  3.40it/s]
Avg Train Loss: 5.841306550162179, Avg Train Acc: 0.49190848214285715
100% 2/2 [00:00<00:00, 25.58it/s]
Avg Val Loss: 1.890760898590088, Avg Val Acc: 0.5229832828044891 (Best: 0.9323508441448212)
=== Epoch: 29 ===
100% 14/14 [00:04<00:00,  3.36it/s]
Avg Train Loss: 5.9794493062155585, Avg Train Acc: 0.47935267857142855
100% 2/2 [00:00<00:00, 21.57it/s]
Avg Val Loss: 1.885952353477478, Avg Val Acc: 0.517169326543808 (Best: 0.9323508441448212)
=== Epoch: 30 ===
100% 14/14 [00:04<00:00,  3.37it/s]
Avg Train Loss: 5.846905197416033, Avg Train Acc: 0.484375
100% 2/2 [00:00<00:00, 25.06it/s]
Avg Val Loss: 1.87449449300766, Avg Val Acc: 0.5268895328044891 (Best: 0.9323508441448212)
=== Epoch: 31 ===
100% 14/14 [00:04<00:00,  3.32it/s]
Avg Train Loss: 5.93916038104466, Avg Train Acc: 0.47879464285714285
100% 2/2 [00:00<00:00, 26.22it/s]
Avg Val Loss: 1.8679159879684448, Avg Val Acc: 0.5268441140651703 (Best: 0.9323508441448212)
=== Epoch: 32 ===
100% 14/14 [00:04<00:00,  3.35it/s]
Avg Train Loss: 5.928842748914446, Avg Train Acc: 0.4927455357142857
100% 2/2 [00:00<00:00, 25.88it/s]
Avg Val Loss: 1.870653748512268, Avg Val Acc: 0.5249364078044891 (Best: 0.9323508441448212)
=== Epoch: 33 ===
100% 14/14 [00:04<00:00,  3.37it/s]
Avg Train Loss: 5.859202487128122, Avg Train Acc: 0.490234375
100% 2/2 [00:00<00:00, 24.14it/s]
Avg Val Loss: 1.8655771613121033, Avg Val Acc: 0.523028701543808 (Best: 0.9323508441448212)
=== Epoch: 34 ===
100% 14/14 [00:04<00:00,  3.35it/s]
Avg Train Loss: 5.9344105039324075, Avg Train Acc: 0.49525669642857145
100% 2/2 [00:00<00:00, 27.32it/s]
Avg Val Loss: 1.8670575618743896, Avg Val Acc: 0.519122451543808 (Best: 0.9323508441448212)
=== Epoch: 35 ===
100% 14/14 [00:04<00:00,  3.30it/s]
Avg Train Loss: 5.832937138421195, Avg Train Acc: 0.4810267857142857
100% 2/2 [00:00<00:00, 25.09it/s]
Avg Val Loss: 1.8612780570983887, Avg Val Acc: 0.523028701543808 (Best: 0.9323508441448212)
=== Epoch: 36 ===
100% 14/14 [00:04<00:00,  3.30it/s]
Avg Train Loss: 5.884509972163609, Avg Train Acc: 0.48465401785714285
100% 2/2 [00:00<00:00, 24.90it/s]
Avg Val Loss: 1.8669951558113098, Avg Val Acc: 0.523028701543808 (Best: 0.9323508441448212)
=== Epoch: 37 ===
100% 14/14 [00:04<00:00,  3.29it/s]
Avg Train Loss: 5.655946935926165, Avg Train Acc: 0.4818638392857143
100% 2/2 [00:00<00:00, 25.41it/s]
Avg Val Loss: 1.8677901029586792, Avg Val Acc: 0.5211209952831268 (Best: 0.9323508441448212)
=== Epoch: 38 ===
100% 14/14 [00:04<00:00,  3.30it/s]
Avg Train Loss: 5.761786494936262, Avg Train Acc: 0.48604910714285715
100% 2/2 [00:00<00:00, 24.61it/s]
Avg Val Loss: 1.859999656677246, Avg Val Acc: 0.5172147452831268 (Best: 0.9323508441448212)
=== Epoch: 39 ===
100% 14/14 [00:04<00:00,  3.39it/s]
Avg Train Loss: 6.012672083718436, Avg Train Acc: 0.49386160714285715
100% 2/2 [00:00<00:00, 16.84it/s]
Avg Val Loss: 1.8719930052757263, Avg Val Acc: 0.524981826543808 (Best: 0.9323508441448212)
=== Epoch: 40 ===
100% 14/14 [00:04<00:00,  3.33it/s]
Avg Train Loss: 5.831849302564349, Avg Train Acc: 0.4790736607142857
100% 2/2 [00:00<00:00, 26.34it/s]
Avg Val Loss: 1.8525737524032593, Avg Val Acc: 0.523028701543808 (Best: 0.9323508441448212)
=== Epoch: 41 ===
100% 14/14 [00:04<00:00,  3.37it/s]
Avg Train Loss: 5.9773162092481344, Avg Train Acc: 0.482421875
100% 2/2 [00:00<00:00, 25.61it/s]
Avg Val Loss: 1.8634689450263977, Avg Val Acc: 0.521075576543808 (Best: 0.9323508441448212)
=== Epoch: 42 ===
100% 14/14 [00:04<00:00,  3.37it/s]
Avg Train Loss: 5.754651001521519, Avg Train Acc: 0.4994419642857143
100% 2/2 [00:00<00:00, 24.65it/s]
Avg Val Loss: 1.868753969669342, Avg Val Acc: 0.524981826543808 (Best: 0.9323508441448212)
=== Epoch: 43 ===
100% 14/14 [00:04<00:00,  3.36it/s]
Avg Train Loss: 5.787662097385952, Avg Train Acc: 0.4974888392857143
100% 2/2 [00:00<00:00, 24.34it/s]
Avg Val Loss: 1.872770369052887, Avg Val Acc: 0.517169326543808 (Best: 0.9323508441448212)
=== Epoch: 44 ===
100% 14/14 [00:04<00:00,  3.30it/s]
Avg Train Loss: 5.742544344493321, Avg Train Acc: 0.4955357142857143
100% 2/2 [00:00<00:00, 24.70it/s]
Avg Val Loss: 1.854133665561676, Avg Val Acc: 0.519122451543808 (Best: 0.9323508441448212)
=== Epoch: 45 ===
100% 14/14 [00:04<00:00,  3.34it/s]
Avg Train Loss: 5.640379973820278, Avg Train Acc: 0.48409598214285715
100% 2/2 [00:00<00:00, 23.69it/s]
Avg Val Loss: 1.860861361026764, Avg Val Acc: 0.526934951543808 (Best: 0.9323508441448212)
=== Epoch: 46 ===
100% 14/14 [00:04<00:00,  3.34it/s]
Avg Train Loss: 5.771489313670567, Avg Train Acc: 0.4994419642857143
100% 2/2 [00:00<00:00, 25.09it/s]
Avg Val Loss: 1.8563621640205383, Avg Val Acc: 0.521075576543808 (Best: 0.9323508441448212)
=== Epoch: 47 ===
100% 14/14 [00:04<00:00,  3.38it/s]
Avg Train Loss: 5.903769765581403, Avg Train Acc: 0.494140625
100% 2/2 [00:00<00:00, 26.42it/s]
Avg Val Loss: 1.8606708645820618, Avg Val Acc: 0.523028701543808 (Best: 0.9323508441448212)
=== Epoch: 48 ===
100% 14/14 [00:04<00:00,  3.36it/s]
Avg Train Loss: 5.726254735674177, Avg Train Acc: 0.48744419642857145
100% 2/2 [00:00<00:00, 26.72it/s]
Avg Val Loss: 1.8522926568984985, Avg Val Acc: 0.519122451543808 (Best: 0.9323508441448212)
=== Epoch: 49 ===
100% 14/14 [00:04<00:00,  3.38it/s]
Compute NCM
Avg Train Loss: 5.7173249040331156, Avg Train Acc: 0.49609375
100% 2/2 [00:00<00:00, 26.46it/s]
Avg Val Loss: 1.8277487754821777, Avg Val Acc: 0.5114007890224457 (Best: 0.9323508441448212)
torch.Size([60, 64])
Testing with last model..
100% 12/12 [00:01<00:00,  9.35it/s]
100% 12/12 [00:01<00:00,  9.21it/s]
100% 12/12 [00:01<00:00,  8.80it/s]
100% 12/12 [00:01<00:00,  9.24it/s]
100% 12/12 [00:01<00:00,  9.17it/s]
100% 12/12 [00:01<00:00,  9.01it/s]
100% 12/12 [00:01<00:00,  9.05it/s]
100% 12/12 [00:01<00:00,  9.01it/s]
100% 12/12 [00:01<00:00,  9.01it/s]
100% 12/12 [00:01<00:00,  9.05it/s]
Test Acc: 0.19522899699707827
Test Acc: [[0.1914], [0.2012], [0.1816], [0.1855], [0.1953], [0.2109], [0.1934], [0.1914], [0.1973], [0.1953], [0.2109], [0.1848]]
0 Parameter containing:
tensor([[1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]], device='cuda:0',
       requires_grad=True) Parameter containing:
tensor([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0.]], device='cuda:0', requires_grad=True)
Incremental num : 3
=== Epoch: 0 ===
100% 14/14 [00:05<00:00,  2.38it/s]
Avg Train Loss: 11.730144228254046, Avg Train Acc: 0.32700892857142855
100% 2/2 [00:00<00:00, 25.67it/s]
Avg Val Loss: 2.5665513277053833, Avg Val Acc: 0.4223090410232544 (Best: 0.9323508441448212)
=== Epoch: 1 ===
100% 14/14 [00:05<00:00,  2.41it/s]
Avg Train Loss: 11.722123146057129, Avg Train Acc: 0.3462611607142857
100% 2/2 [00:00<00:00, 26.79it/s]
Avg Val Loss: 2.543286919593811, Avg Val Acc: 0.4122299253940582 (Best: 0.9323508441448212)
=== Epoch: 2 ===
100% 14/14 [00:05<00:00,  2.42it/s]
Avg Train Loss: 11.593032905033656, Avg Train Acc: 0.33286830357142855
100% 2/2 [00:00<00:00, 26.07it/s]
Avg Val Loss: 2.5608577728271484, Avg Val Acc: 0.4402006268501282 (Best: 0.9323508441448212)
=== Epoch: 3 ===
100% 14/14 [00:05<00:00,  2.41it/s]
Avg Train Loss: 11.419607434953962, Avg Train Acc: 0.34402901785714285
100% 2/2 [00:00<00:00, 26.79it/s]
Avg Val Loss: 2.551701307296753, Avg Val Acc: 0.44864004850387573 (Best: 0.9323508441448212)
=== Epoch: 4 ===
100% 14/14 [00:05<00:00,  2.40it/s]
Avg Train Loss: 11.648958001817975, Avg Train Acc: 0.3540736607142857
100% 2/2 [00:00<00:00, 23.78it/s]
Avg Val Loss: 2.5269534587860107, Avg Val Acc: 0.44668692350387573 (Best: 0.9323508441448212)
=== Epoch: 5 ===
100% 14/14 [00:05<00:00,  2.38it/s]
Avg Train Loss: 11.472057615007673, Avg Train Acc: 0.3412388392857143
100% 2/2 [00:00<00:00, 26.55it/s]
Avg Val Loss: 2.5211819410324097, Avg Val Acc: 0.4626253843307495 (Best: 0.9323508441448212)
=== Epoch: 6 ===
100% 14/14 [00:05<00:00,  2.38it/s]
Avg Train Loss: 11.4177291733878, Avg Train Acc: 0.35072544642857145
100% 2/2 [00:00<00:00, 26.33it/s]
Avg Val Loss: 2.5049312114715576, Avg Val Acc: 0.46911168098449707 (Best: 0.9323508441448212)
=== Epoch: 7 ===
100% 14/14 [00:05<00:00,  2.40it/s]
Avg Train Loss: 11.511882986341204, Avg Train Acc: 0.35435267857142855
100% 2/2 [00:00<00:00, 26.04it/s]
Avg Val Loss: 2.4929927587509155, Avg Val Acc: 0.4548128843307495 (Best: 0.9323508441448212)
=== Epoch: 8 ===
100% 14/14 [00:05<00:00,  2.38it/s]
Avg Train Loss: 11.55687768118722, Avg Train Acc: 0.36802455357142855
100% 2/2 [00:00<00:00, 24.05it/s]
Avg Val Loss: 2.4666695594787598, Avg Val Acc: 0.4668450951576233 (Best: 0.9323508441448212)
=== Epoch: 9 ===
100% 14/14 [00:05<00:00,  2.39it/s]
Avg Train Loss: 11.087742601122175, Avg Train Acc: 0.3646763392857143
100% 2/2 [00:00<00:00, 26.25it/s]
Avg Val Loss: 2.4622949361801147, Avg Val Acc: 0.47497105598449707 (Best: 0.9323508441448212)
=== Epoch: 10 ===
100% 14/14 [00:05<00:00,  2.39it/s]
Avg Train Loss: 11.435450962611608, Avg Train Acc: 0.3671875
100% 2/2 [00:00<00:00, 25.03it/s]
Avg Val Loss: 2.461414098739624, Avg Val Acc: 0.4629388451576233 (Best: 0.9323508441448212)
=== Epoch: 11 ===
100% 14/14 [00:05<00:00,  2.40it/s]
Avg Train Loss: 11.378898075648717, Avg Train Acc: 0.373046875
100% 2/2 [00:00<00:00, 24.07it/s]
Avg Val Loss: 2.444799065589905, Avg Val Acc: 0.4626253843307495 (Best: 0.9323508441448212)
=== Epoch: 12 ===
100% 14/14 [00:05<00:00,  2.40it/s]
Avg Train Loss: 11.608655180249896, Avg Train Acc: 0.3744419642857143
100% 2/2 [00:00<00:00, 26.16it/s]
Avg Val Loss: 2.4459521770477295, Avg Val Acc: 0.4626253843307495 (Best: 0.9323508441448212)
=== Epoch: 13 ===
100% 14/14 [00:05<00:00,  2.39it/s]
Avg Train Loss: 11.464309828622001, Avg Train Acc: 0.3763950892857143
100% 2/2 [00:00<00:00, 24.83it/s]
Avg Val Loss: 2.4278348684310913, Avg Val Acc: 0.491223007440567 (Best: 0.9323508441448212)
=== Epoch: 14 ===
100% 14/14 [00:05<00:00,  2.38it/s]
Avg Train Loss: 11.056864125388008, Avg Train Acc: 0.3744419642857143
100% 2/2 [00:00<00:00, 24.66it/s]
Avg Val Loss: 2.4171411395072937, Avg Val Acc: 0.47887730598449707 (Best: 0.9323508441448212)
=== Epoch: 15 ===
100% 14/14 [00:05<00:00,  2.38it/s]
Avg Train Loss: 11.120329175676618, Avg Train Acc: 0.3803013392857143
100% 2/2 [00:00<00:00, 25.65it/s]
Avg Val Loss: 2.3981239795684814, Avg Val Acc: 0.47919076681137085 (Best: 0.9323508441448212)
=== Epoch: 16 ===
100% 14/14 [00:05<00:00,  2.40it/s]
Avg Train Loss: 11.213757106236049, Avg Train Acc: 0.38588169642857145
100% 2/2 [00:00<00:00, 26.65it/s]
Avg Val Loss: 2.3954524993896484, Avg Val Acc: 0.48895639181137085 (Best: 0.9323508441448212)
=== Epoch: 17 ===
100% 14/14 [00:05<00:00,  2.38it/s]
Avg Train Loss: 11.183996336800712, Avg Train Acc: 0.37220982142857145
100% 2/2 [00:00<00:00, 25.93it/s]
Avg Val Loss: 2.382108449935913, Avg Val Acc: 0.49090951681137085 (Best: 0.9323508441448212)
=== Epoch: 18 ===
100% 14/14 [00:05<00:00,  2.40it/s]
Avg Train Loss: 10.980013915470668, Avg Train Acc: 0.38783482142857145
100% 2/2 [00:00<00:00, 26.22it/s]
Avg Val Loss: 2.4052494764328003, Avg Val Acc: 0.495129257440567 (Best: 0.9323508441448212)
=== Epoch: 19 ===
100% 14/14 [00:05<00:00,  2.36it/s]
Avg Train Loss: 11.257237774985176, Avg Train Acc: 0.38169642857142855
100% 2/2 [00:00<00:00, 26.52it/s]
Avg Val Loss: 2.391265034675598, Avg Val Acc: 0.48083043098449707 (Best: 0.9323508441448212)
=== Epoch: 20 ===
100% 14/14 [00:05<00:00,  2.35it/s]
Avg Train Loss: 11.312520095280238, Avg Train Acc: 0.37583705357142855
100% 2/2 [00:00<00:00, 25.41it/s]
Avg Val Loss: 2.3924789428710938, Avg Val Acc: 0.4785638451576233 (Best: 0.9323508441448212)
=== Epoch: 21 ===
100% 14/14 [00:05<00:00,  2.36it/s]
Avg Train Loss: 11.423255920410156, Avg Train Acc: 0.3861607142857143
100% 2/2 [00:00<00:00, 24.04it/s]
Avg Val Loss: 2.377707839012146, Avg Val Acc: 0.493176132440567 (Best: 0.9323508441448212)
=== Epoch: 22 ===
100% 14/14 [00:05<00:00,  2.38it/s]
Avg Train Loss: 11.174729755946569, Avg Train Acc: 0.380859375
100% 2/2 [00:00<00:00, 23.89it/s]
Avg Val Loss: 2.3746965527534485, Avg Val Acc: 0.49090951681137085 (Best: 0.9323508441448212)
=== Epoch: 23 ===
100% 14/14 [00:05<00:00,  2.40it/s]
Avg Train Loss: 11.17325987134661, Avg Train Acc: 0.384765625
100% 2/2 [00:00<00:00, 25.60it/s]
Avg Val Loss: 2.377123534679413, Avg Val Acc: 0.48278355598449707 (Best: 0.9323508441448212)
=== Epoch: 24 ===
100% 14/14 [00:05<00:00,  2.38it/s]
Avg Train Loss: 11.38165249143328, Avg Train Acc: 0.3950892857142857
100% 2/2 [00:00<00:00, 25.66it/s]
Avg Val Loss: 2.367538094520569, Avg Val Acc: 0.48700326681137085 (Best: 0.9323508441448212)
=== Epoch: 25 ===
100% 14/14 [00:05<00:00,  2.37it/s]
Avg Train Loss: 10.965167113712855, Avg Train Acc: 0.4029017857142857
100% 2/2 [00:00<00:00, 25.47it/s]
Avg Val Loss: 2.3415725231170654, Avg Val Acc: 0.48700326681137085 (Best: 0.9323508441448212)
=== Epoch: 26 ===
100% 14/14 [00:05<00:00,  2.37it/s]
Avg Train Loss: 11.26201581954956, Avg Train Acc: 0.40066964285714285
100% 2/2 [00:00<00:00, 25.59it/s]
Avg Val Loss: 2.3724048137664795, Avg Val Acc: 0.5097415149211884 (Best: 0.9323508441448212)
=== Epoch: 27 ===
100% 14/14 [00:05<00:00,  2.39it/s]
Avg Train Loss: 11.182482038225446, Avg Train Acc: 0.39453125
100% 2/2 [00:00<00:00, 25.31it/s]
Avg Val Loss: 2.3391226530075073, Avg Val Acc: 0.497082382440567 (Best: 0.9323508441448212)
=== Epoch: 28 ===
100% 14/14 [00:06<00:00,  2.33it/s]
Avg Train Loss: 11.209710734231132, Avg Train Acc: 0.4115513392857143
100% 2/2 [00:00<00:00, 26.10it/s]
Avg Val Loss: 2.3588350415229797, Avg Val Acc: 0.49286264181137085 (Best: 0.9323508441448212)
=== Epoch: 29 ===
100% 14/14 [00:05<00:00,  2.39it/s]
Avg Train Loss: 10.900867325919014, Avg Train Acc: 0.39732142857142855
100% 2/2 [00:00<00:00, 24.52it/s]
Avg Val Loss: 2.3384968042373657, Avg Val Acc: 0.49090951681137085 (Best: 0.9323508441448212)
=== Epoch: 30 ===
100% 14/14 [00:05<00:00,  2.39it/s]
Avg Train Loss: 11.251128196716309, Avg Train Acc: 0.39481026785714285
100% 2/2 [00:00<00:00, 25.86it/s]
Avg Val Loss: 2.3253456354141235, Avg Val Acc: 0.495129257440567 (Best: 0.9323508441448212)
=== Epoch: 31 ===
100% 14/14 [00:05<00:00,  2.40it/s]
Avg Train Loss: 11.439550127301898, Avg Train Acc: 0.404296875
100% 2/2 [00:00<00:00, 26.15it/s]
Avg Val Loss: 2.2986727952957153, Avg Val Acc: 0.48668980598449707 (Best: 0.9323508441448212)
=== Epoch: 32 ===
100% 14/14 [00:05<00:00,  2.41it/s]
Avg Train Loss: 11.061167785099574, Avg Train Acc: 0.40122767857142855
100% 2/2 [00:00<00:00, 17.55it/s]
Avg Val Loss: 2.3146418929100037, Avg Val Acc: 0.500988632440567 (Best: 0.9323508441448212)
=== Epoch: 33 ===
100% 14/14 [00:05<00:00,  2.41it/s]
Avg Train Loss: 10.908339432307653, Avg Train Acc: 0.41043526785714285
100% 2/2 [00:00<00:00, 25.32it/s]
Avg Val Loss: 2.3099409341812134, Avg Val Acc: 0.5130208432674408 (Best: 0.9323508441448212)
=== Epoch: 34 ===
100% 14/14 [00:05<00:00,  2.36it/s]
Avg Train Loss: 11.005626201629639, Avg Train Acc: 0.412109375
100% 2/2 [00:00<00:00, 25.70it/s]
Avg Val Loss: 2.314540386199951, Avg Val Acc: 0.4844232201576233 (Best: 0.9323508441448212)
=== Epoch: 35 ===
100% 14/14 [00:05<00:00,  2.35it/s]
Avg Train Loss: 11.213282040187291, Avg Train Acc: 0.3978794642857143
100% 2/2 [00:00<00:00, 26.46it/s]
Avg Val Loss: 2.3179786801338196, Avg Val Acc: 0.5006751418113708 (Best: 0.9323508441448212)
=== Epoch: 36 ===
100% 14/14 [00:05<00:00,  2.38it/s]
Avg Train Loss: 11.143375941685267, Avg Train Acc: 0.40652901785714285
100% 2/2 [00:00<00:00, 25.24it/s]
Avg Val Loss: 2.3179230093955994, Avg Val Acc: 0.502941757440567 (Best: 0.9323508441448212)
=== Epoch: 37 ===
100% 14/14 [00:05<00:00,  2.40it/s]
Avg Train Loss: 11.1726165499006, Avg Train Acc: 0.39732142857142855
100% 2/2 [00:00<00:00, 24.80it/s]
Avg Val Loss: 2.3023059964179993, Avg Val Acc: 0.508801132440567 (Best: 0.9323508441448212)
=== Epoch: 38 ===
100% 14/14 [00:05<00:00,  2.39it/s]
Avg Train Loss: 11.035890034266881, Avg Train Acc: 0.40736607142857145
100% 2/2 [00:00<00:00, 25.53it/s]
Avg Val Loss: 2.29864764213562, Avg Val Acc: 0.4844232201576233 (Best: 0.9323508441448212)
=== Epoch: 39 ===
100% 14/14 [00:05<00:00,  2.35it/s]
Avg Train Loss: 11.192726475851876, Avg Train Acc: 0.41183035714285715
100% 2/2 [00:00<00:00, 23.90it/s]
Avg Val Loss: 2.292343258857727, Avg Val Acc: 0.49872201681137085 (Best: 0.9323508441448212)
=== Epoch: 40 ===
100% 14/14 [00:05<00:00,  2.38it/s]
Avg Train Loss: 10.982707296098981, Avg Train Acc: 0.3998325892857143
100% 2/2 [00:00<00:00, 24.80it/s]
Avg Val Loss: 2.294963300228119, Avg Val Acc: 0.5172405540943146 (Best: 0.9323508441448212)
=== Epoch: 41 ===
100% 14/14 [00:05<00:00,  2.37it/s]
Avg Train Loss: 11.179624693734306, Avg Train Acc: 0.40792410714285715
100% 2/2 [00:00<00:00, 25.25it/s]
Avg Val Loss: 2.3058244585990906, Avg Val Acc: 0.48668980598449707 (Best: 0.9323508441448212)
=== Epoch: 42 ===
100% 14/14 [00:05<00:00,  2.38it/s]
Avg Train Loss: 10.838383402143206, Avg Train Acc: 0.40262276785714285
100% 2/2 [00:00<00:00, 25.40it/s]
Avg Val Loss: 2.295424699783325, Avg Val Acc: 0.49872201681137085 (Best: 0.9323508441448212)
=== Epoch: 43 ===
100% 14/14 [00:05<00:00,  2.39it/s]
Avg Train Loss: 11.013619150434222, Avg Train Acc: 0.40931919642857145
100% 2/2 [00:00<00:00, 25.79it/s]
Avg Val Loss: 2.308383047580719, Avg Val Acc: 0.48668980598449707 (Best: 0.9323508441448212)
=== Epoch: 44 ===
100% 14/14 [00:05<00:00,  2.39it/s]
Compute NCM
Avg Train Loss: 11.25245462145124, Avg Train Acc: 0.4087611607142857
100% 2/2 [00:00<00:00, 24.59it/s]
Avg Val Loss: 2.286570727825165, Avg Val Acc: 0.504894882440567 (Best: 0.9323508441448212)
torch.Size([80, 64])
Testing with last model..
100% 16/16 [00:01<00:00,  8.66it/s]
100% 16/16 [00:01<00:00,  9.07it/s]
100% 16/16 [00:01<00:00,  8.90it/s]
100% 16/16 [00:01<00:00,  8.91it/s]
100% 16/16 [00:01<00:00,  8.74it/s]
100% 16/16 [00:01<00:00,  8.93it/s]
100% 16/16 [00:01<00:00,  8.82it/s]
100% 16/16 [00:01<00:00,  8.72it/s]
100% 16/16 [00:01<00:00,  8.82it/s]
100% 16/16 [00:01<00:00,  8.60it/s]
Test Acc: 0.1558007810730487
Test Acc: [[0.1836], [0.1699], [0.1543], [0.1582], [0.1406], [0.1855], [0.1543], [0.1113], [0.1602], [0.166], [0.1504], [0.1602], [0.1289], [0.1797], [0.1523], [0.1312]]
0 Parameter containing:
tensor([[1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]], device='cuda:0',
       requires_grad=True) Parameter containing:
tensor([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0.]], device='cuda:0', requires_grad=True)
Incremental num : 4
=== Epoch: 0 ===
100% 14/14 [00:07<00:00,  1.90it/s]
Avg Train Loss: 12.062357425689697, Avg Train Acc: 0.36244419642857145
100% 2/2 [00:00<00:00, 25.29it/s]
Avg Val Loss: 2.8621751070022583, Avg Val Acc: 0.3972925543785095 (Best: 0.9323508441448212)
=== Epoch: 1 ===
100% 14/14 [00:07<00:00,  1.93it/s]
Avg Train Loss: 12.00700739451817, Avg Train Acc: 0.34347098214285715
100% 2/2 [00:00<00:00, 24.15it/s]
Avg Val Loss: 2.8352303504943848, Avg Val Acc: 0.4031519293785095 (Best: 0.9323508441448212)
=== Epoch: 2 ===
100% 14/14 [00:07<00:00,  1.94it/s]
Avg Train Loss: 11.881156172071185, Avg Train Acc: 0.34654017857142855
100% 2/2 [00:00<00:00, 21.50it/s]
Avg Val Loss: 2.829527974128723, Avg Val Acc: 0.3972925543785095 (Best: 0.9323508441448212)
=== Epoch: 3 ===
100% 14/14 [00:07<00:00,  1.93it/s]
Avg Train Loss: 11.99628598349435, Avg Train Acc: 0.34068080357142855
100% 2/2 [00:00<00:00, 24.77it/s]
Avg Val Loss: 2.8258368968963623, Avg Val Acc: 0.40694594383239746 (Best: 0.9323508441448212)
=== Epoch: 4 ===
100% 14/14 [00:07<00:00,  1.95it/s]
Avg Train Loss: 11.984234128679548, Avg Train Acc: 0.3470982142857143
100% 2/2 [00:00<00:00, 25.26it/s]
Avg Val Loss: 2.8422889709472656, Avg Val Acc: 0.38775143027305603 (Best: 0.9323508441448212)
=== Epoch: 5 ===
100% 14/14 [00:07<00:00,  1.96it/s]
Avg Train Loss: 12.012925011771065, Avg Train Acc: 0.34877232142857145
100% 2/2 [00:00<00:00, 25.13it/s]
Avg Val Loss: 2.8369961977005005, Avg Val Acc: 0.40889906883239746 (Best: 0.9323508441448212)
=== Epoch: 6 ===
100% 14/14 [00:07<00:00,  1.95it/s]
Avg Train Loss: 11.964477743421282, Avg Train Acc: 0.35435267857142855
100% 2/2 [00:00<00:00, 23.52it/s]
Avg Val Loss: 2.8124799728393555, Avg Val Acc: 0.4051050543785095 (Best: 0.9323508441448212)
=== Epoch: 7 ===
100% 14/14 [00:07<00:00,  1.96it/s]
Avg Train Loss: 12.027768816266741, Avg Train Acc: 0.3451450892857143
100% 2/2 [00:00<00:00, 25.24it/s]
Avg Val Loss: 2.8388233184814453, Avg Val Acc: 0.39349856972694397 (Best: 0.9323508441448212)
=== Epoch: 8 ===
100% 14/14 [00:07<00:00,  1.93it/s]
Avg Train Loss: 11.954653194972447, Avg Train Acc: 0.34458705357142855
100% 2/2 [00:00<00:00, 25.64it/s]
Avg Val Loss: 2.8239529132843018, Avg Val Acc: 0.39545169472694397 (Best: 0.9323508441448212)
=== Epoch: 9 ===
100% 14/14 [00:07<00:00,  1.96it/s]
Avg Train Loss: 11.97086763381958, Avg Train Acc: 0.3588169642857143
100% 2/2 [00:00<00:00, 24.83it/s]
Avg Val Loss: 2.821296811103821, Avg Val Acc: 0.4070581793785095 (Best: 0.9323508441448212)
=== Epoch: 10 ===
100% 14/14 [00:07<00:00,  1.96it/s]
Avg Train Loss: 11.933470044817243, Avg Train Acc: 0.35825892857142855
100% 2/2 [00:00<00:00, 24.72it/s]
Avg Val Loss: 2.7758454084396362, Avg Val Acc: 0.420505553483963 (Best: 0.9323508441448212)
=== Epoch: 11 ===
100% 14/14 [00:07<00:00,  1.93it/s]
Avg Train Loss: 11.945152759552002, Avg Train Acc: 0.34681919642857145
100% 2/2 [00:00<00:00, 25.37it/s]
Avg Val Loss: 2.832383871078491, Avg Val Acc: 0.40694594383239746 (Best: 0.9323508441448212)
=== Epoch: 12 ===
100% 14/14 [00:07<00:00,  1.94it/s]
Avg Train Loss: 11.838290010179792, Avg Train Acc: 0.36021205357142855
100% 2/2 [00:00<00:00, 24.41it/s]
Avg Val Loss: 2.806596517562866, Avg Val Acc: 0.4031519293785095 (Best: 0.9323508441448212)
=== Epoch: 13 ===
100% 14/14 [00:07<00:00,  1.93it/s]
Avg Train Loss: 11.999757494245257, Avg Train Acc: 0.34654017857142855
100% 2/2 [00:00<00:00, 22.92it/s]
Avg Val Loss: 2.7914483547210693, Avg Val Acc: 0.420505553483963 (Best: 0.9323508441448212)
=== Epoch: 14 ===
100% 14/14 [00:07<00:00,  1.95it/s]
Avg Train Loss: 11.81550019127982, Avg Train Acc: 0.35658482142857145
100% 2/2 [00:00<00:00, 24.35it/s]
Avg Val Loss: 2.7748180627822876, Avg Val Acc: 0.418552428483963 (Best: 0.9323508441448212)
=== Epoch: 15 ===
100% 14/14 [00:07<00:00,  1.93it/s]
Avg Train Loss: 11.88092293058123, Avg Train Acc: 0.35323660714285715
100% 2/2 [00:00<00:00, 24.86it/s]
Avg Val Loss: 2.793848156929016, Avg Val Acc: 0.40889906883239746 (Best: 0.9323508441448212)
=== Epoch: 16 ===
100% 14/14 [00:07<00:00,  1.97it/s]
Avg Train Loss: 11.857398441859655, Avg Train Acc: 0.35825892857142855
100% 2/2 [00:00<00:00, 24.22it/s]
Avg Val Loss: 2.7968363761901855, Avg Val Acc: 0.4090113043785095 (Best: 0.9323508441448212)
=== Epoch: 17 ===
100% 14/14 [00:07<00:00,  1.93it/s]
Avg Train Loss: 11.799308504377093, Avg Train Acc: 0.36049107142857145
100% 2/2 [00:00<00:00, 25.48it/s]
Avg Val Loss: 2.788309931755066, Avg Val Acc: 0.420505553483963 (Best: 0.9323508441448212)
=== Epoch: 18 ===
100% 14/14 [00:07<00:00,  1.96it/s]
Avg Train Loss: 11.76152787889753, Avg Train Acc: 0.36746651785714285
100% 2/2 [00:00<00:00, 25.24it/s]
Avg Val Loss: 2.802281379699707, Avg Val Acc: 0.40889906883239746 (Best: 0.9323508441448212)
=== Epoch: 19 ===
100% 14/14 [00:07<00:00,  1.95it/s]
Avg Train Loss: 11.798087188175746, Avg Train Acc: 0.36886160714285715
100% 2/2 [00:00<00:00, 24.70it/s]
Avg Val Loss: 2.784279942512512, Avg Val Acc: 0.416599303483963 (Best: 0.9323508441448212)
=== Epoch: 20 ===
100% 14/14 [00:07<00:00,  1.95it/s]
Avg Train Loss: 11.883034229278564, Avg Train Acc: 0.35072544642857145
100% 2/2 [00:00<00:00, 24.55it/s]
Avg Val Loss: 2.7920141220092773, Avg Val Acc: 0.41280531883239746 (Best: 0.9323508441448212)
=== Epoch: 21 ===
100% 14/14 [00:07<00:00,  1.95it/s]
Avg Train Loss: 11.889687197549003, Avg Train Acc: 0.37220982142857145
100% 2/2 [00:00<00:00, 21.61it/s]
Avg Val Loss: 2.79478120803833, Avg Val Acc: 0.4051050543785095 (Best: 0.9323508441448212)
=== Epoch: 22 ===
100% 14/14 [00:07<00:00,  1.94it/s]
Avg Train Loss: 12.07835238320487, Avg Train Acc: 0.34737723214285715
100% 2/2 [00:00<00:00, 25.06it/s]
Avg Val Loss: 2.782732367515564, Avg Val Acc: 0.41475844383239746 (Best: 0.9323508441448212)
=== Epoch: 23 ===
100% 14/14 [00:07<00:00,  1.96it/s]
Avg Train Loss: 11.964010511125837, Avg Train Acc: 0.36244419642857145
100% 2/2 [00:00<00:00, 25.35it/s]
Avg Val Loss: 2.7954081296920776, Avg Val Acc: 0.416599303483963 (Best: 0.9323508441448212)
=== Epoch: 24 ===
100% 14/14 [00:07<00:00,  1.96it/s]
Avg Train Loss: 11.831800869532994, Avg Train Acc: 0.35128348214285715
100% 2/2 [00:00<00:00, 25.05it/s]
Avg Val Loss: 2.8007442951202393, Avg Val Acc: 0.416599303483963 (Best: 0.9323508441448212)
=== Epoch: 25 ===
100% 14/14 [00:07<00:00,  1.93it/s]
Avg Train Loss: 11.843748841966901, Avg Train Acc: 0.3529575892857143
100% 2/2 [00:00<00:00, 25.55it/s]
Avg Val Loss: 2.7701971530914307, Avg Val Acc: 0.42452406883239746 (Best: 0.9323508441448212)
=== Epoch: 26 ===
100% 14/14 [00:07<00:00,  1.93it/s]
Avg Train Loss: 11.813561167035784, Avg Train Acc: 0.37193080357142855
100% 2/2 [00:00<00:00, 25.09it/s]
Avg Val Loss: 2.7905685901641846, Avg Val Acc: 0.4109644293785095 (Best: 0.9323508441448212)
=== Epoch: 27 ===
100% 14/14 [00:07<00:00,  1.95it/s]
Avg Train Loss: 11.929860932486397, Avg Train Acc: 0.35574776785714285
100% 2/2 [00:00<00:00, 23.50it/s]
Avg Val Loss: 2.7862361669540405, Avg Val Acc: 0.41671156883239746 (Best: 0.9323508441448212)
=== Epoch: 28 ===
100% 14/14 [00:07<00:00,  1.97it/s]
Avg Train Loss: 11.697471959250313, Avg Train Acc: 0.35965401785714285
100% 2/2 [00:00<00:00, 25.56it/s]
Avg Val Loss: 2.775209903717041, Avg Val Acc: 0.424411803483963 (Best: 0.9323508441448212)
=== Epoch: 29 ===
100% 14/14 [00:07<00:00,  1.96it/s]
Avg Train Loss: 11.698578425816127, Avg Train Acc: 0.36690848214285715
100% 2/2 [00:00<00:00, 26.44it/s]
Avg Val Loss: 2.7687714099884033, Avg Val Acc: 0.424411803483963 (Best: 0.9323508441448212)
=== Epoch: 30 ===
100% 14/14 [00:07<00:00,  1.95it/s]
Avg Train Loss: 12.032965115138463, Avg Train Acc: 0.3515625
100% 2/2 [00:00<00:00, 24.56it/s]
Avg Val Loss: 2.7649269104003906, Avg Val Acc: 0.434177428483963 (Best: 0.9323508441448212)
=== Epoch: 31 ===
100% 14/14 [00:07<00:00,  1.95it/s]
Avg Train Loss: 11.733111245291573, Avg Train Acc: 0.35770089285714285
100% 2/2 [00:00<00:00, 25.42it/s]
Avg Val Loss: 2.7870445251464844, Avg Val Acc: 0.4148706793785095 (Best: 0.9323508441448212)
=== Epoch: 32 ===
100% 14/14 [00:07<00:00,  1.95it/s]
Avg Train Loss: 11.775884219578334, Avg Train Acc: 0.36439732142857145
100% 2/2 [00:00<00:00, 22.52it/s]
Avg Val Loss: 2.8083434104919434, Avg Val Acc: 0.4090113043785095 (Best: 0.9323508441448212)
=== Epoch: 33 ===
100% 14/14 [00:07<00:00,  1.93it/s]
Avg Train Loss: 11.97296837397984, Avg Train Acc: 0.36635044642857145
100% 2/2 [00:00<00:00, 21.96it/s]
Avg Val Loss: 2.716650128364563, Avg Val Acc: 0.43601831793785095 (Best: 0.9323508441448212)
=== Epoch: 34 ===
100% 14/14 [00:07<00:00,  1.93it/s]
Avg Train Loss: 11.985232625688825, Avg Train Acc: 0.35825892857142855
100% 2/2 [00:00<00:00, 25.01it/s]
Avg Val Loss: 2.7545405626296997, Avg Val Acc: 0.43015894293785095 (Best: 0.9323508441448212)
=== Epoch: 35 ===
100% 14/14 [00:07<00:00,  1.96it/s]
Avg Train Loss: 11.630691800798688, Avg Train Acc: 0.3666294642857143
100% 2/2 [00:00<00:00, 24.80it/s]
Avg Val Loss: 2.7682063579559326, Avg Val Acc: 0.42820581793785095 (Best: 0.9323508441448212)
=== Epoch: 36 ===
100% 14/14 [00:07<00:00,  1.93it/s]
Avg Train Loss: 11.808323451450892, Avg Train Acc: 0.35825892857142855
100% 2/2 [00:00<00:00, 24.43it/s]
Avg Val Loss: 2.7798269987106323, Avg Val Acc: 0.41280531883239746 (Best: 0.9323508441448212)
=== Epoch: 37 ===
100% 14/14 [00:07<00:00,  1.96it/s]
Avg Train Loss: 11.792647089276995, Avg Train Acc: 0.35630580357142855
100% 2/2 [00:00<00:00, 25.21it/s]
Avg Val Loss: 2.7530555725097656, Avg Val Acc: 0.4339529573917389 (Best: 0.9323508441448212)
=== Epoch: 38 ===
100% 14/14 [00:07<00:00,  1.94it/s]
Avg Train Loss: 11.851961544581822, Avg Train Acc: 0.35630580357142855
100% 2/2 [00:00<00:00, 23.66it/s]
Avg Val Loss: 2.7639394998550415, Avg Val Acc: 0.4398123323917389 (Best: 0.9323508441448212)
=== Epoch: 39 ===
100% 14/14 [00:07<00:00,  1.94it/s]
Compute NCM
Avg Train Loss: 11.73704903466361, Avg Train Acc: 0.3696986607142857
100% 2/2 [00:00<00:00, 26.31it/s]
Avg Val Loss: 2.756787419319153, Avg Val Acc: 0.436130553483963 (Best: 0.9323508441448212)
torch.Size([100, 64])
Testing with last model..
100% 20/20 [00:02<00:00,  9.10it/s]
100% 20/20 [00:02<00:00,  8.96it/s]
100% 20/20 [00:02<00:00,  8.84it/s]
100% 20/20 [00:02<00:00,  8.91it/s]
100% 20/20 [00:02<00:00,  8.89it/s]
100% 20/20 [00:02<00:00,  8.48it/s]
100% 20/20 [00:02<00:00,  8.69it/s]
100% 20/20 [00:02<00:00,  8.88it/s]
100% 20/20 [00:02<00:00,  8.63it/s]
100% 20/20 [00:02<00:00,  8.71it/s]
Test Acc: 0.13816348802298306
Test Acc: [[0.1348], [0.1465], [0.125], [0.1387], [0.127], [0.1211], [0.1465], [0.1738], [0.1445], [0.1367], [0.1328], [0.1445], [0.1426], [0.1445], [0.1387], [0.1289], [0.1309], [0.1348], [0.1191], [0.1618]]
0 Parameter containing:
tensor([[1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]], device='cuda:0',
       requires_grad=True) Parameter containing:
tensor([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0.]], device='cuda:0', requires_grad=True)
----------train finished----------